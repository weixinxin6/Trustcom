These O
pipes O
represent O
the O
server O
side O
for O
child O
instances O
, O
and O
also O
the O
point O
to O
connect O
to O
for O
hooks O
Babar B-malware.drop
installs O
to O
spy O
on O
several O
system O
APIs O
. O

Meaning O

If O
the O
network O
input O
does O
not O
arrive O
, O
the O
queries O
each O
of O
the O
command O
handlers O
for O
any O
packets O
they O
may O
have O
queued O
( O
by O
calling O
each O
command O
handler O
's O
ReadWaitingData O
function O
) O
and O
transmits O
the O
packets O
the O
handlers O
have O
generated O
. O

Doherty O
, O
and O
E O
. O

Below O
screen O
shot O
shows O
the O
response O
given O
to O
the O
malware O
. O

facebook O

However O
, O
by O
all O
appearances O
, O
the O
attackers O
noticed O
the O
unwanted O
addition O
to O
their O
malware O
and O
got O
rid O
of O
the O
infection O
. O

How O
is O
this O
different O
from O
any O
other O
targeted O
attack O
? O

getNameList O

They O
are O
sometimes O
portrayed O
as O
wild O
and O
reckless O
, O
but O
as O
seen O
under O
our O
visibility O
, O
the O
group O
can O
be O
pragmatic O
, O
measured O
, O
and O
agile O
. O

In O
the O
case O
of O
this O
post O
, O
it O
appears O
that O
at O
least O
two O
different O
attackers O
were O
involved O
in O
compromising O
and O
placing O
malicious O
code O
on O
Pro-Democratic O
websites O
in O
Hong O
Kong O
. O

1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42 B-hash

Figure O
13 O
Content O
of O
the O
data O
package O

Among O
the O
most-downloaded O
malicious O
fi O
les O
, O
we O
found O
variants O
of O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
used O
in O
Iron O
Tiger O
APT O
operation O
. O

Figure O
24 O
. O

We O
decided O
to O
have O
an O
even O
closer O
look O
at O
Agent.BTZ B-malware.backdoor
and O
ComRAT B-malware.backdoor
and O
therefore O
analyzed O
the O
evolution O
of O
this O
RAT B-malware.backdoor
, O
covering O
seven O
years O
of O
development O
. O

Internal O
Filename O
: O
libcef.dll O

: O
+966 O
13 O
341 O
9915 O
, O
Ext O
. O

The O
COZY O
BEAR O
intrusion O
relied O
primarily O
on O
the O
SeaDaddy B-malware.backdoor
implant O
developed O
in O
Python O
and O
compiled O
with O
py2exe O
and O
another O
Powershell O
backdoor O
with O
persistence O
accomplished O
via O
Windows O
Management O
Instrumentation O
( O
WMI O
) O
system O
, O
which O
allowed O
the O
adversary O
to O
launch O
malicious O
code O
automatically O
after O
a O
specified O
period O
of O
system O
uptime O
or O
on O
a O
specific O
schedule O
. O

Siilarly O
, O
the O
IP O
address O
( O
68.96.31.136 B-ip.unknown
) O
was O
another O
C2 O
node O
reported O
by O
Dell O
SecureWorks O
as O
hosting O
the O
HTran O
proxy O
infrastructure O
. O

Some O
of O
these O
are O
probably O
also O
related O
to O
this O
case O
, O
but O
as O
we O
have O
no O
evidence O
linking O
the O
cases O
, O
these O
malwares O
have O
not O
been O
included O
in O
this O
paper O
. O

The O
amount O
of O
Convertible O
Currency O
is O
then O
manipulated O
in O
the O
message O
by O
changing O
it O
to O
the O
arbitrary O
value O
( O

Operator O
Routed O
to O
Country O

Win32/TrojanDropper O
. O

Later O
v4 O
SPLM B-malware.backdoor
injected O
individual O
keylogger O
, O
filestealer O
, O
and O
remoteshell O
modules O
into O
memory O
space O
. O

Compiled O
Time O
Stamp O
: O
2018-01-29 O
09:36:41 O
( O
Jan O
. O

The O
malware O
enumerates O
all O
processes O
, O
and O
if O
a O
process O
has O
the O
module O
liboradb.dll O
loaded O
in O
it O
, O
it O
will O
patch O
2 O
bytes O
in O
its O
memory O
at O
a O
specific O
offset O
. O

According O
to O
Insikt O
Group O
's O
source O
, O
during O
the O
2009 O
Green O
Revolution O
, O
Gerdab.ir B-url.unknown
emerged O
as O
the O
IRGC O
's O
domestic O
hacking O
group O
tasked O
with O
targeting O
opposition O
news O
websites O
and O
individuals O
considered O
immoral O
by O
the O
regime O
. O

The O
function O
' O
ZwQuerySystemInformation O
' O
is O
also O
hooked O
by O
the O
malware O
, O
a O
technique O
frequently O
used O
to O
allow O
process O
hiding O
: O

The O
command O
processing O
function O
starts O
by O
substituting O
the O
main O
module O
name O
and O
path O
in O
the O
hosting O
process O
PEB O
, O
with O
the O
one O
of O
the O
default O
internet O
browser O
. O

( O
2013 O
) O
. O

The O
following O
is O
a O
preliminary O
Python O
script O
that O
implements O
the O
protocol O
used O
by O
the O
malware O
and O
allows O
you O
to O
interact O
with O
it O
: O
9. O
import O
sys O
10. O
import O
socket O
11. O
import O
select O
14.def O
decode O
( O
x O
) O
: O
15. O
return O
' O
' O
.join O
( O
[ O
chr O
( O
( O
ord O
( O
i O
) O
*0xd9 O
) O
& O
0xff O
) O
for O
i O
in O
x O
] O
) O
18.def O
encode O
( O
x O
) O
: O
19. O
return O
' O
' O
.join O
( O
[ O
chr O
( O
( O
ord O
( O
i O
) O
*0x93 O
) O
& O
0xff O
) O
for O
i O
in O
x O
] O
) O
22.def O
main O
( O
) O
: O
23. O
s O
= O
socket.socket O
( O
socket.AF_INET O
, O
socket.SOCK_STREAM O
) O
24 O
. O

This O
JavaScript O
file O
is O
called O
from O
other O
parts O
of O
the O
website O
and O
effectively O
nests O
the O
loading O
of O
additional O
JavaScript O
written O
and O
interpeted O
as O
: O

We O
describe O
them O
below O
. O

Attacks O
often O
play O
on O
curiosity O
or O
ideology O
to O
encourage O
users O
to O
enter O
passwords O
or O
click O
on O
enticing O
files O
, O
or O
exploit O
fears O
of O
hacking O
and O
surveillance O
with O
fake O
security O
tools O
. O

It O
instantiates O
several O
suspended O
browser O
processes O
and O
then O
replaces O
the O
loaded O
executable O
memory O
with O
the O
code O
contained O
in O
the O
embedded O
resource O
previously O
mentioned O
. O

This O
captured O
packet O
shows O
sample O
backdoor O
commands B-malware.backdoor
and O
replies O
: O

During O
our O
analysis O
, O
we O
collected O
a O
copy O
of O
the O
RATANKBA B-malware.backdoor
malware O
's O
Lazarus O
Remote O
Controller O
tool O
. O

Below O
screen O
shot O
shows O
the O
URL O
extracted O
from O
the O
C2 O
response O
. O

The O
main O
module O
downloads O
the O
various O
data-stealing O
plugins O
assigned O
to O
each O
victim O
, O
and O
executes O
them O
. O

Although O
Trend O
Micro O
uses O
reasonable O
efforts O
to O
include O
accurate O
and O
up-to-date O
information O
herein O
, O
Trend O
Micro O
makes O
no O
warranties O
or O
representations O
of O
any O
kind O
as O
to O
its O
accuracy O
, O
currency O
, O
or O
completeness O
. O

Menu O

The O
phishing O
emails O
try O
to O
trick O
the O
users O
into O
thinking O
the O
emails O
are O
legitimate O
by O
attaching O
the O
RAT B-malware.infosteal
with O
the O
some O
of O
the O
following O
names O
: O
Payment B-malware.infosteal
Invoice.jar I-malware.infosteal
, O
Payment B-malware.infosteal
details.jar I-malware.infosteal
, O
POR#94586.zip/POR#94586.jar B-malware.infosteal
, O
INV#94586.zip/INV#94586.jar B-malware.infosteal
, O
Invitation.jar B-malware.infosteal
, O
reports-pdf.jar B-malware.infosteal
, O
US$25k.jar B-malware.infosteal
, O
and O
DBC_BANK_IMG_23456_156.jar B-malware.infosteal
, O
and O
lremit_Transfer_Error_Page.jar B-malware.infosteal
. O

00 O
01 O
00 O
00 O
00 O
ff O
ff O
ff O
ff O
01 O
00 O
00 O
00 O
00 O
00 O
00 O
................ O
00 O
0c O
02 O
00 O
00 O
00 O
45 O
53 O
68 O
61 O
64 O
6f O
77 O
54 O
65 O
63 O
...... O
EShadowTec O
68 O
20 O
52 O
61 O
74 O
2c O
20 O
56 O
65 O
72 O
73 O
69 O
6f O
6e O
3d O
31 O
h O
Rat O
, O
Version=1 O
2e O
30 O
2e O
30 O
2e O
30 O
2c O
20 O
43 O
75 O
6c O
74 O
75 O
72 O
65 O
3d O
.0.0.0 O
, O
Culture= O
6e O
65 O
75 O
74 O
72 O
61 O
6c O
2c O
20 O
50 O
75 O
62 O
6c O
69 O
63 O
4b O
neutral O
, O
PublicK O
65 O
79 O
54 O
6f O
6b O
65 O
6e O
3d O
6e O
75 O
6c O
6c O
05 O
01 O
00 O
00 O
eyToken=null O
.... O
00 O
13 O
53 O
68 O
61 O
64 O
6f O
77 O
54 O
65 O
63 O
68 O
5f O
52 O
61 O
74 O
..ShadowTech_Rat B-malware.infosteal
2e O
44 O
61 O
74 O
61 O
03 O
00 O
00 O
00 O
04 O
64 O
61 O
74 O
61 O
05 O
69 O
. O

This O
signals O
just O
how O
long O
ago O
the O
Poseidon B-malware.infosteal
threat O
actor O
was O
already O
working O
on O
its O
offensive O
framework O
. O

The O
unpacked O
executable O
takes O
several O
command O
line O
arguments O
: O
: O
list O
service O
names O
, O
available O
for O
its O
own O
registration O
: O
open O
specified O
event O
: O
set O
specified O
event O

16.03.2015 O
: O
The O
Andromeda/Gamarue O
botnet B-malware.ransom
is O
on O
the O
rise O
again O

All O
rights O
reserved O
. O

This O
C2 O
domain O
was O
associated O
with O
two O
IP O
addresses O
. O

Motivation O
- O
Based O
on O
the O
nature O
of O
the O
attack O
, O
the O
proprietary O
information O
that O
the O
attackers O
were O
after O
and O
the O
high-profile O
personnel O
who O
were O
targeted O
, O
Cybereason O
concluded O
the O
main O
motivation O
behind O
the O
attack O
was O
cyber O
espionage O
. O

**patched O
include.preload.js O
injects O
two O
malicious O
scripts O
from O
the O
attacker O
's O
Pastebin O
account O
. O

Web O
. O

Figure O
1 O
: O
RTF O
PCAP O
The O
XLSM O
attachments O
contained O
multiple O
worksheets O
with O
content O
that O
reflected O
the O
attachment O
name O
. O

Detected O
as O
W2KM_DLOADR.UHAOEEN O
240b7d2825183226af634d3801713b0e0f409eb3e1e48e1d36c96d2b03d8836b O
ENTERPRISE O
SMALL O
BUSINESS O
HOME O

Hacquebord O
Feike O
. O

Table O
1 O
lists O
the O
current O
detection O
and O
blocking O
capabilities O
by O
product O
. O

In O
addition O
to O
the O
fact O
that O
the O
emails O
share O
no O
attributes O
, O
the O
malicious O
attachments O
are O
also O
unrelated O
. O

Did O
the O
attackers O
use O
any O
interesting/advanced O
technologies O
? O

When O
our O
government O
clients O
come O
under O
threat O
, O
Arcanum O
Global O
's O
embedded O
specialists O
and O
capabilities O
support O
them O
with O
a O
full O
suite O
of O
response O
options O
, O
including O
( O
in O
consonance O
with O
applicable O
laws O
and O
regulations O
) O
an O
array O
of O
countermeasures O
as O
well O
as O
both O
in-kind O
and O
asymmetric O
responses O
. O

The O
second O
is O
the O
full O
URL O
– O

PCC_FILE O
: O
:ProcessPacket O
member O
function O
, O
much O
like O
PCC_CMD O
: O
:ProcessPacket O
, O
is O
little O
more O
than O
a O
stub O
function O
that O
passes O
only O
a O
copy O
of O
the O
payload O
data O
( O
pkt O
) O
to O

176.56.238.177 B-ip.unknown
, O
belonging O
to O
AS198203 O
ASN-ROUTELABEL O
RouteLabel O
V.O.F. O
in O
the O
Netherlands O
. O

To O
learn O
more O
, O
read O
our O
Security O
101 O
: O
Business O
Process O
Compromise O
. O

Most O
importantly O
, O
the O
attacker O
forgot O
to O
cover O
his O
trails O
, O
enabling O
us O
to O
learn O
his O
identity O
. O

April O
24 O
, O
2018 O
| O
by O
Edson O
Sierra O
, O
Gerardo O
Iglesias O

The O
dll B-malware.backdoor
that O
connect O
to O
' O
marina-info.net B-url.unknown
' O
may O
be O
the O
last O
stage-malware B-malware.backdoor
that O
is O
triggered O
only O
when O
particular O
conditions O
occur O
, O
for O
example O
when O
the O
malware O
infects O
a O
system O
with O
an O
IP O
address O
belonging O
to O
specific O
ranges O
. O

Actors O
with O
a O
nexus O
to O
Russia O
regularly O
monitor O
social O
media O
sites O
in O
order O
to O
better O
understand O
or O
formulate O
operations O
against O
their O
targets O
. O

The O
capability O
to O
terminate O
a O
process O
. O

Group O
a6135a6a6346a460792ce2da285778b1 B-hash
ABRIL O
CmetaS3 O

We O
noticed O
that O
several O
security O
companies O
and O
enthusiasts O
had O
unwittingly O
reported O
on O
fragments O
of O
Poseidon B-malware.infosteal
's O
campaigns O
over O
the O
years O
. O

Examination O
of O
the O
executable O
from O
that O
blog O
's O
demo O
code O
shows O
that O
the O
WriteInputPoint O
function O
calls O
with O
byte O
indices O
0x110 O
and O
0x114 O
set O
pressure O
and O
temperature O
values O
, O
respectively O
: O
IRONGATE B-malware.backdoor
: O
WriteInputPoint O
( O
0x110 O
, O
0 O
, O
0x7763 O
) O
WriteInputPoint O
( O
0x114 O
, O
0 O
, O
0x7763 O
) O
Equivalent O
pseudo O
code O
from O
Biogas.exe O
: O
S7ProSim.WriteInputPoint O
( O
0x110 O
, O
0 O
, O
( O
short O
) O
this.Pressure.Value O
) O
S7ProSim.WriteInputPoint O
( O
0x114 O
, O
0 O
, O
( O
short O
) O
this.Temperature.Value O
) O
We O
have O
been O
unable O
to O
determine O
the O
significance O
of O
the O
hardcoded O
value O
0x7763 O
, O
which O
is O
passed O
in O
both O
instances O
of O
the O
write O
function O
. O

REFERENCE O

This O
has O
been O
an O
ongoing O
trend O
in O
malware O
development O
that O
we O
and O
others O
have O
observed O
several O
times O
in O
past O
. O

Furthermore O
, O
the O
CLSID O
was O
stored O
in O
plain O
text O
within O
the O
sample O
. O

The O
pop-up O
does O
make O
it O
appear O
as O
if O
the O
file O
is O
an O
update O
to O
Java O
. O

As O
noted O
in O
the O
JPCERT O
report O
, O
Cylance O
also O
found O
that O
in O
most O
cases O
of O
successful O
infection O
, O
one O
of O
the O
earliest O
modules O
downloaded O
onto O
the O
system O
added O
an O
additional O
layer O
of O
AES O
communication O
to O
the O
traffic O
. O

With O
all O
of O
this O
information O
in O
mind O
, O
we O
assume O
with O
high O
confidence O
that O
the O
malware O
author O
works O
out O
of O
India O
. O

The O
campaign O
attempted O
to O
discredit O
and O
demonize O
the O
main O
Iranian O
opposition O
party O
, O
the O
People O
's O
Mojahedin O
Organization O
of O
Iran/Mojahedin-e O
Khalq O
( O
PMOI/MEK O
) O
. O

We O
do O
suspect O
large O
portions O
of O
the O
product O
enumeration O
to O
be O
based O
on O
the O
exact O
same O
source O
code O
as O
the O
module O
Bunny B-malware.unknown
used O
. O

If O
any O
of O
those O
names O
are O
found O
and O
the O
browser O
is O
one O
of O
the O
following O
, O
the O
Trojan O
will O
terminate O
that O
browser O
. O

Getpass.exe O
52a8557c8cdd5d925453383934cb10a85b117522b95c6d28ca097632ac8bc10d B-hash
event.dll O
6c3224dbf6bbabe058b0ab46233c9d35c970aa83e8c4bdffb85d78e31159d489 B-hash
mail.exe O
2f76c9242d5ad2b1f941fb47c94c80c1ce647df4d2d37ca2351864286b0bb3d8 B-hash

Examination O
of O
the O
file O
names O
and O
the O
Safeengine O
executable O
protector O
suggest O
that O
the O
malware O
was O
made O
in O
China O
. O

It O
then O
adds O
1000 O
to O
EBX O
, O
yielding O
887 O
. O

Given O
the O
estimated O
development O
timeframe O
and O
the O
promotional O
period O
for O
the O
benign O
30.apk B-malware.backdoor
application O
, O
the O
program O
was O
likely O
available O
online O
for O
distribution O
after O
late O
April O
2013 O
. O

When O
the O
file O
is O
opened O
, O
it O
drops O
HIGHTIDE B-malware.backdoor
in O
the O
form O
of O
an O
executable O
file O
onto O
the O
infected O
system O
. O

CVE-2018-8174 B-malware.unknown
is O
a O
remote O
code O
execution O
vulnerability O
of O
Windows O
VBScript O
engine O
. O

The O
BAT O
fi O
le O
is O
saved O
in O
the O
% O
TEMP O
% O
folder O
as O
' O
win32shell.bat O
' O
. O

Hypothesis O
2 O
: O
Tranchulas O
developed O
and O
sold O
the O
malicious O
binaries O
to O
an O
unidentified O
customer O
, O
where O
they O
were O
later O
operationalized O
by O
an O
unidentified O
entity O
. O

The O
following O
is O
a O
screenshot O
of O
the O
email O
: O

We O
have O
provided O
an O
updated O
version O
of O
those O
conclusions O
, O
a O
layout O
of O
the O
tactics O
that O
they O
generally O
employ O
, O
as O
well O
as O
observations O
of O
apparent O
tactical O
shifts O
. O

The O
attacker O
can O
reprogram O
the O
SIS O
logic O
to O
cause O
it O
to O
trip O
and O
shutdown O
a O
process O
that O
is O
, O
in O
actuality O
, O
in O
a O
safe O
state O
. O

These O
facts O
significantly O
challenge O
the O
existing O
' O
official O
' O
history O
of O
Stuxnet B-malware.backdoor
. O

test.php O
: O
< O
? O
php O
@ O
eval O
( O
$ O
_POST O
[ O
' O
password O
' O
] O
) O
; O
? O

Data O
: O
( O
full O
path O
to O
the O
backdoor O
) O
SYSTEM\CurrentControlSet\Services\ O
RaS O
? O
? O

The O
thread O
KeyloggerThread O
is O
spawned O
and O
is O
responsible O
for O
doing O
keylogging O
on O
the O
target O
workstation O
. O

This O
log O
contained O
information O
for O
the O
control O
server O
thlsystems.for rst.cz O
, O
which O
showed O
an O
IP O
address O
from O
South O
Korea O
connecting O
to O
the O
speci c O
URL O
paths O
contained O
in O
the O
PowerShell O
implants O
. O

Other O
versions O
tried O
to O
open O
the O
file O
OUTLFLTR.DAT O
. O

These O
attackers O
aggressively O
pursue O
and O
compromise O
chosen O
targets O
in O
order O
to O
steal O
sensitive O
information O
. O

The O
logged O
in O
account O
, O
as O
seen O
from O
the O
journal O
, O
is O
then O
used O
to O
check O
how O
much O
Convertible O
Currency O
amount O
( O

We O
have O
reason O
to O
believe O
CozyDuke B-malware.drop
is O
being O
used O
to O
target O
governmental O
organizations O
and O
entities O
that O
work O
closely O
with O
such O
bodies O
. O

This O
converts O
the O
native O
x86 O
instructions O
of O
the O
malware O
into O
another O
custom O
language O
chosen O
from O
one O
of O
11 O
code O
templates O
. O

Calling O
on O
years O
of O
collective O
experience O
in O
positions O
that O
placed O
their O
analysts O
at O
the O
tip O
of O
the O
cyber-spear O
, O
root9B O
has O
developed O
a O
unique O
approach O
to O
the O
problem O
of O
cyber-defense O
. O

32 O
. O

Interestingly O
the O
backdoor O
will O
also O
load O
the O
legitimate O
file O
resolve O
functions O
and O
pass O
calls O
to O
it O
so O
it O
does O
n't O
break O
audio O
playback O
on O
the O
victim O
system O
. O

It O
communicates O
with O
its O
C2 O
server O
through O
HTTP O
over O
nonstandard O
TCP O
ports O
, O
and O
will O
send O
encoded O
information O
containing O
basic O
system O
information O
back O
, O
including O
hostname O
, O
username O
, O
and O
operating O
system O
within O
the O
content O
of O
the O
POST O
. O

The O
C O
& O
C O
console O
allowed O
attackers O
to O
live O
track O
their O
victims O
. O

Sofacy O
's O
choice O
of O
targets O
has O
historically O
been O
an O
interesting O
mixture O
that O
has O
fueled O
an O
ongoing O
debate O
over O
whether O
the O
group O
is O
criminal O
in O
nature O
, O
or O
actually O
an O
agent O
of O
a O
nation-state O
. O

During O
the O
course O
of O
our O
investigation O
, O
JPCERT O
published O
this O
analysis O
of O
one O
of O
the O
group O
's O
backdoors O
. O

The O
table O
below O
lists O
all O
of O
Koadic B-malware.unknown
's O
functions O
: O
{ O
Variable O
} O
.user O
User-related O
functions O
{ O
Variable O
} O
.user.isElevated O
Check O
Privilege O
{ O
Variable O
} O
.user.OS O
Get O
OS O
Version O
{ O
Variable O
} O
.user.DC O
Get O
DCName O
from O
Registry O
{ O
Variable O
} O
.user.Arch O
Get O
Architecture O
{ O
Variable O
} O
.user.info O
Get O
User O
Information O
{ O
Variable O
} O
.work O
Main O
Routine O
functions O
{ O
Variable O
} O
.work.report O
Reports O
to O
server O
{ O
Variable O
} O
.work.error O
Returns O
error O
{ O
Variable O
} O
.work.make_url O
Alters/Modifies O
URL O
( O
C O
& O
C O
) O
{ O
Variable O
} O
.work.get O
Get O
the O
return O
of O
POST O
Header O
{ O
Variable O
} O
.work.fork O
Creates O
rundll32.exe O
process O
{ O
Variable O
} O
.http O
HTTP O
Connection O
functions O
{ O
Variable O
} O
.http.create O
Creates O
initial O
HTTP O
objects O
{ O
Variable O
} O
.http.post O
POST O
header O
{ O
Variable O
} O
.http.addHeaders O
Adds O
HTTP O
Headers O
{ O
Variable O
} O
.http.get O
GET O
Header O
{ O
Variable O
} O
.http.upload O
Uploads O
binaries/data O
{ O
Variable O
} O
.http.bin2str O
String O
manipulation O
{ O
Variable O
} O
.http.downloadEx O
Downloads O
response O
{ O
Variable O
} O
.http.download O
Additional O
download O
function O
{ O
Variable O
} O
.process O
Process-related O
functions O
{ O
Variable O
} O
.process.currentPID O
Get O
Current O
Process O
ID O
{ O
Variable O
} O
.process.list O
Enumerates O
Process O
{ O
Variable O
} O
.process.kill O
Terminates O
Process O
{ O
Variable O
} O
.registry O
Registry-related O
functions O
{ O
Variable O
} O
.registry.HKCR O
Set O
HKEY_CLASSES_ROOT O
{ O
Variable O
} O
.registry.HKCU O
Set O
HKEY_CURRENT_USER O
{ O
Variable O
} O
.registry.HKLM O
Set O
HKEY_LOCAL_MACHINE O
{ O
Variable O
} O
.registry.STRING O
Set O
String O
Value O
{ O
Variable O
} O
.registry.BINARY O
Set O
Binary O
Value O
{ O
Variable O
} O
.registry.DWORD O
Set O
DWORD O
Value O
{ O
Variable O
} O
.registry.QWORD O
Set O
QWORD O
Value O
{ O
Variable O
} O
.registry.write O
Write/Add O
Registry O
{ O
Variable O
} O
.registry.provider O
Create O
Registry O
Handle O
{ O
Variable O
} O
.registry.destroy O
Deletes O
Registry O
Key O
{ O
Variable O
} O
.registry.read O
Get/Read O
Registry O
Entries O
{ O
Variable O
} O
.WMI O
WMI-related O
functions O
{ O
Variable O
} O
.WMI.createProcess O
Creates O
specified O
process O
{ O
Variable O
} O
.shell O
File/Process O
Execution O
functions O
{ O
Variable O
} O
.shell.run O
Run O
commands O
{ O
Variable O
} O
.shell.exec O
Executes O
process O
{ O
Variable O
} O
.file O
File-related O
functions O
{ O
Variable O
} O
.file.getPath O
Get O
specified O
file O
path O
{ O
Variable O
} O
.file.readText O
Reads O
specified O
text O
file O
{ O
Variable O
} O
.file.get32BitFolder O
Get O
System O
Folder O
( O
32/64-bit O
) O
{ O
Variable O
} O
.file.writol O
Writes O
on O
specified O
file O
{ O
Variable O
} O
.file.deleteFile O
Deletes O
specified O
file O
{ O
Variable O
} O
.file.readBinary O
Reads O
specified O
binary O
file O
. O

It O
will O
then O
ensure O
that O
only O
one O
instance O
of O
the O
program O
runs O
at O
a O
given O
moment O
by O
checking O
for O
the O
presence O
of O
a O
particular O
mutex O
on O
the O
system O
. O

We O
decided O
to O
inspect O
two O
different O
datasets O
: O
our O
incoming O
sample O
feeds O
/ O
malware O
zoo O
, O
and O
the O
telemetry O
associated O
with O
our O
Advanced O
Malware O
Protection O
( O
AMP O
) O
solutions O
. O

File O
Name O
: O
INV#94586.jar B-malware.infosteal
File O
Size O
: O
43885 O
bytes O
MD5 O
: O
06c2760060d41533b36572ae3c1ba2df B-hash
SHA1 O
: O
0350f53a821933e05bf82508b1e458c83d37b7c8 B-hash

Once O
fully O
unpacked O
in O
memory O
, O
it O
appears O
to O
be O
an O
x86 O
variant O
of O
the O
fdsvc.dll B-malware.backdoor
backdoor O
described O
in O
our O
February O
blogpost O
' O
Lazarus B-malware.unknown
' I-malware.unknown
False I-malware.unknown
Flag I-malware.unknown
Malware I-malware.unknown
' O
. O

Just O
kidding O
. O

2009 O
14.07 O
. O

Parser O
: O
:inByte O
method O
When O
scrambling O
one O
byte O
, O
the O
scrambler O
first O
determines O
if O
the O
byte O
value O
is O
odd O
or O
even O
. O

After O
the O
file O
is O
saved O
, O
the O
code O
deletes O
the O
temporary O
table O
. O

Record O
# O
0 O
Length O
: O
243 O
bytes O
: O

The O
malware O
attempts O
to O
locate O
the O
configuration O
and O
password O
store O
files O
for O
a O
variety O
browsers O
and O
chat O
clients O
as O
seen O
below O
: O
We O
observed O
the O
creation O
of O
the O
file O
' O
t111o00000000.dat O
' O
in O
the O
data O
harvesting O
directory O
, O
as O
shown O
in O
the O
filesystem O
timeline O
below O
: O

Thanks O
to O
the O
logs O
located O
on O
the O
MDM B-malware.infosteal
servers O
and O
the O
malware O
's O
command O
and O
control O
( O
C2 O
) O
server O
, O
we O
were O
able O
to O
determine O
that O
the O
malware O
has O
been O
in O
use O
since O
August O
2015 O
. O

Other O
resources O
include O
: O

In O
July O
2015 O
security O
company O
Cyphort O
reported O
the O
compromise O
of O
a O
news O
portal O
and O
a O
banking O
site O
– O
rbc.ua O
and O
unicredit.ua O
. O

In O
the O
below O
screen O
shot O
the O
URL O
( O
hxxp://c2xyup.com/update.exe B-url.unknown
) O
is O
not O
the O
actual O
URL O
used O
by O
the O
malware O
for O
updating O
, O
this O
is O
a O
test O
URL O
used O
to O
determine O
the O
functionality O
, O
so O
this O
URL O
should O
not O
used O
as O
an O
indicator O
. O

The O
fact O
that O
the O
Ethiopian O
version O
of O
FinSpy B-malware.backdoor
uses O
images O
of O
opposition O
members O
as O
bait O
suggests O
it O
may O
be O
used O
for O
politically O
influenced O
surveillance O
activities O
, O
rather O
than O
strictly O
law O
enforcement O
purposes O
. O

To O
be O
continued O
... O
Meow O
. O

Once O
the O
data O
is O
decrypted O
with O
two O
RC4 O
rounds O
, O
the O
dropper O
checks O
the O
decrypted O
data O
contains O
a O
valid O
4-byte O
signature O
: O
0xBC0F1DAD O
. O

( O
and O
publicly O
available O
RATs B-malware.backdoor
such O
as O
PoisonIvy O
) O
to O
maintain O
access O
to O
victim O
networks O
. O

The O
company O
's O
registered O
IP O
ranges O
sit O
under O
AS12212 O
with O
the O
following O
prefixes O
ranged O
198.55.48.0 B-ip.unknown
– O
198.55.61.255 B-ip.unknown
, O
198.55.63.0 B-ip.unknown
– O
198.55.63.255 B-ip.unknown
and O
207.176.216.0 B-ip.unknown
– O
207.176.219.255 B-ip.unknown
. O

We O
'll O
then O
start O
poking O
around O
looking O
for O
routines O
that O
might O
implement O
the O
phone O
home O
protocol O
. O

CrowdStrike O
identified O
this O
X-Agent B-malware.infosteal
variant O
within O
a O
legitimate O
Android O
application O
named O
30.apk B-malware.backdoor
. O

Wed O
Jun O
13 O
07:31:32 O
2007 O
UTC O
Ch O
1.0 O
Wed O
Jun O
13 O
07:31:32 O
2007 O
UTC O
Ch O
1.0 O
Wed O
Jun O
13 O
07:31:32 O
2007 O
UTC O
Ch O
1.0 O
Tue O
Jun O
19 O
12:41:21 O
2007 O
UTC O
Ch O
1.0 O
Tue O
Jun O
26 O
08:46:11 O
2007 O
UTC O
Ch O
1.1 O
Ch O
1.1 O
Tue O
Jun O
26 O
08:46:11 O
2007 O
UTC O
Ch O
1.2wcc O
Tue O
Jul O
24 O
12:57:37 O
2007 O
UTC O
Ch O
1.2wcc O
Tue O
Jul O
24 O
12:57:37 O
2007 O
UTC O
Ch O
1.2wcc O
Tue O
Jul O
24 O
12:57:37 O
2007 O
UTC O
Thu O
Jul O
26 O
07:20:17 O
2007 O
UTC O
Ch O
1.2 O
Mon O
Dec O
3 O
14:15:58 O
2007 O
UTC O
Ch O
1.3 O
Ch O
1.4 O
Tue O
Dec O
11 O
17:36:03 O
2007 O
UTC O
Tue O
Dec O
11 O
17:36:03 O
2007 O
UTC O
Ch O
1.4 O
Tue O
Dec O
11 O
17:36:03 O
2007 O
UTC O
Ch O
1.4 O
Ch O
1.5 O
Thu O
Mar O
27 O
14:58:15 O
2008 O
UTC O
Thu O
Mar O
27 O
14:58:15 O
2008 O
UTC O
Ch O
1.5 O
Thu O
Mar O
27 O
14:58:15 O
2008 O
UTC O
Ch O
1.5 O
Ch O
1.5 O
Thu O
Mar O
27 O
14:58:15 O
2008 O
UTC O
Mon O
May O
5 O
11:27:48 O
2008 O
UTC O
Mon O
May O
12 O
11:52:31 O
2008 O
UTC O
Thu O
May O
22 O
10:24:55 O
2008 O
UTC O
5ef72904221aa4090a262a24714054f0 B-hash
Thu O
Nov O
6 O
13:21:45 O
2008 O
UTC O
Ch O
2.05 O
331eca9c7d9fd9cbe7cd192af09880a3 B-hash
Thu O
Nov O
6 O
13:21:45 O
2008 O
UTC O
Ch O
2.05 O
db1156b072d58acdac1aeab9af2160a2 B-hash
Mon O
Dec O
29 O
11:37:17 O
2008 O
UTC O
Ch O
2.07 O
74dbea70bfb15db31bb9f757ed4bb1a0 B-hash
Mon O
Dec O
29 O
11:37:17 O
2008 O
UTC O
Ch O
2.07 O
eb928bca5675722c7e9e2b09eec1158a B-hash
Mon O
Sep O
14 O
13:22:57 O
2009 O
UTC O
Ch O
2.11 O
162f415abad9708aa61db8e03bcf2f3c B-hash
Mon O
Sep O
14 O
15:28:07 O
2009 O
UTC O
Ch O
2.11 O
448524fd62dec1151c75b55b86587784 B-hash
Tue O
Sep O
29 O
10:28:40 O
2009 O
UTC O
Ch O
2.12 O
29bb70a40689e9e665d15716519bacfd B-hash
Mon O
Dec O
7 O
14:25:12 O
2009 O
UTC O
Ch O
2.13 O
38d6719d6a266c6cefb8626c57378927 B-hash
Ch O
2.13 O
Mon O
Dec O
7 O
14:27:53 O
2009 O
UTC O
02eda1effde92bdf8462abcf40c4f776 B-hash
Ch O
2.14.1 O
Wed O
Feb O
17 O
15:14:20 O
2010 O
UTC O
5121ce1f96d74076df1c39748e019f42 B-hash
Ch O
3.00 O
Tue O
Jan O
31 O
16:12:25 O
2012 O
UTC O
28dc1ca683d6a14d0d1794a68c477604 B-hash
Tue O
Feb O
14 O
10:28:06 O
2012 O
UTC O
40bd7846553550f38e458b8493824cb4 B-hash
Ch O
3.00 O
Wed O
Apr O
4 O
16:23:44 O
2012 O
UTC O
Ch O
3.02 O
ba0c777317461ed57a85ffae277044dc B-hash
b86137fa5a232c614ec5405be4d13b37 B-hash
Ch O
3.10 O
Tue O
Dec O
18 O
08:22:43 O
2012 O
UTC O
Fri O
Jun O
28 O
12:16:40 O
2013 O
UTC O
7872c1d88fe21d8a85f160a6666c76e8 B-hash
Ch O
3.20 O
83a48760e92bf30961b4a943d3095b0a B-hash
Ch O
3.20 O
Fri O
Jun O
28 O
12:16:58 O
2013 O
UTC O
Mon O
Jun O
24 O
10:51:01 O
2013 O
UTC O
Ch O
3.20 O
3d65c18d09f47547f85c631ebeeda482 B-hash
Thu O
Feb O
6 O
12:37:44 O
2014 O
UTC O
Ch O
3.25 O
ec7e3cfaeaac0401316d66e964be684e B-hash
b407b6e5b4046da226d6e189a67f62ca B-hash
Ch O
3.26 O
Thu O
Jan O
3 O
18:03:46 O
2013 O
UTC O

The O
dropper O
iterates O
through O
each O
entry O
in O
scxrt2.ini O
, O
looking O
for O
paths O
named O
move-to-operational O
or O
move-to-operational.lnk O
. O

A O
200.63.46.23 B-ip.unknown
18 O
weddingdressestoday.com B-url.unknown
. O

< O
% O
execute O
request O
( O
chr O
( O
42 O
) O
) O
% O
> O

61075faba222f97d3367866793f0907b B-hash
N/A O
First O
Seen O
10-12 O
02:50:16 O
10-03 O
01:01:31 O
10-03 O
01:01:37 O
10-07 O
08:58:00 O
10-12 O
02:50:15 O
10-12 O
02:50:15 O
10-08 O
03:32:47 O
03-14 O
02:13:01 O
02-16 O
03:25:00 O
Compile O
Time O
10-01 O
15:37:31 O
10-01 O
11:34:07 O
02-20 O
11:09:30 O
01-05 O
01:11:33 O
02-20 O
11:09:30 O
09-21 O
09:27:43 O
03-06 O
17:32:58 O
02-10 O
15:03:30 O
File O
# O
1 O
is O
the O
ZIP O
file O
containing O
samples O
# O
2-6 O
inside O
. O

Both O
of O
the O
above O
open O
a O
document O
as O
well O
as O
another O
executable O
( O
written O
in O
C++ O
) O
when O
they O
are O
double O
clicked O
. O

Additional O
reporting O
on O
this O
activity O
and O
another O
going O
back O
to O
August O
2014 O
was O
also O
recently O
shared O
on O
ThreatConnect O
. O

We O
would O
like O
to O
thank O
the O
security O
researchers O
and O
organizations O
who O
shared O
information O
and O
provided O
feedback O
, O
which O
have O
been O
crucial O
for O
this O
research O
. O

It O
is O
interesting O
that O
this O
particular O
group O
has O
for O
years O
now O
deployed O
backdoor O
and O
downloader O
code O
in O
the O
form O
of O
.hta O
files O
. O

All O
rights O
reserved O
. O

Download O
page O
, O
winrar[.]it B-url.normal

The O
computing O
infrastructure O
in O
a O
typical O
Enterprise O
is O
more O
vulnerable O
to O
attack O
than O
ever O
before O
. O

SHA-1 O
SHA-256 O
File O
Size O
Icon O
687464d6c668b59f85b0e02012945fe5 B-hash
b3086b4d99288d50585d4c07a3fdd0970a9843fc B-hash
e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6 B-hash
1233 O
KB O

' O
La O
Russie O
soupçonnée O
d'être O
responsable O
d'un O
piratage O
informatique O
contre O
l'OSCE O
. O
' O

This O
is O
an O
example O
of O
' O
not O
knowing O
what O
they O
are O
looking O
for O
until O
they O
fi O
nd O
it O
' O
. O

The O
Dropbox O
user O
that O
registered O
the O
account O
has O
the O
following O
details O
: O
Name O
: O
P***** O
Email O
: O
P********@mail.ru O
The O
data-stealing O
plugins O
store O
all O
their O
output O
in O
: O
% O
USERPROFILE O
% O
\AppData\Roaming\Media O
Before O
being O
sent O
to O
Dropbox O
by O
the O
main O
module O
, O
the O
files O
are O
encrypted O
with O
Blowfish O
. O

The O
links O
between O
the O
forums O
and O
contractors O
may O
illustrate O
that O
the O
trust O
communities O
begin O
with O
the O
Iranian O
security O
forums O
. O

Two O
samples O
of O
the O
malware O
payload O
were O
uploaded O
by O
different O
sources O
in O
2014 O
, O
but O
none O
of O
the O
antivirus O
vendors O
featured O
on O
VirusTotal O
flagged O
them O
as O
malicious O
. O

Depending O
on O
its O
privileges O
, O
the O
malware O
drops O
the O
files O
in O
% O
ProgramFiles O
% O
or O
% O
appdata O
% O
. O

This O
time O
the O
attacker O
again O
used O
a O
financially-themed O
domain O
name O
: O
On O
the O
day O
of O
the O
Diskcoder.C O
outbreak O
, O
the O
A-record O
of O
this O
domain O
was O
changed O
to O
10.0.0.1 O
The O
TeleBots O
group O
continues O
to O
evolve O
in O
order O
to O
conduct O
disruptive O
attacks O
against O
Ukraine O
. O

Once O
the O
sector O
of O
the O
backup O
VBR O
is O
known O
, O
EnCase O
was O
started O
and O
the O
image O
of O
the O
infected O
system O
was O
loaded O
. O

In O
spite O
of O
these O
investments O
, O
however O
, O
the O
Philippines O
is O
still O
among O
the O
most O
prone O
countries O
to O
be O
targeted O
by O
these O
sorts O
of O
APT O
attacks O
. O

Figure O
8 O
– O
Fake O
CHKDSK O
message O
displayed O
by O
Diskcoder.C O
. O

Once O
unpacked O
it O
, O
we O
have O
discovered O
the O
same O
payload O
with O
also O
the O
same O
hash O
of O
the O
first O
sample O
The O
third O
and O
the O
fourth O
ones O
are O
the O
identical O
too O
, O
also O
in O
this O
the O
difference O
is O
that O
the O
fourth O
one O
is O
packed O
using O
the O
UPX O
tool O
. O

Crimea O
lacks O
electricity O
after O
physical O
attack O
News O
story O
associating O
ArtOS O
project O
, O
a O
joint O
endeavor O
with O
the O
Noosphere O
Engineering O
School O
Forums O
discussing O
the O
app O
and O
claiming O
to O
be O
associated O
with O
the O
developers O
users O
are O
called O
out O
as O
fraudulent O
some O
users O
claim O
copy O
apps O
are O
distributing O
malware O

The O
area O
that O
will O
contain O
the O
critical O
information O
is O
known O
as O
the O
Bios O
Parameter O
Block O
( O
BPB O
) O
. O

Password O
is O
roscomnadzor O
' O

Outlook O
This O
late O
2017 O
campaign O
is O
a O
continuation O
of O
North O
Korea O
's O
interest O
in O
cryptocurrency O
, O
which O
we O
now O
know O
encompasses O
a O
broad O
range O
of O
activities O
including O
mining O
, O
ransomware O
, O
and O
outright O
theft O
. O

Recent O
activity O
of O
the O
group O
against O
US O
organizations O
was O
discussed O
in O
a O
US-CERT O
advisory O
, O
which O
linked O
the O
actor O
to O
the O
Russian O
government O
, O
as O
well O
as O
an O
advisory O
by O
the O
UK O
National O
Cyber O
Security O
Centre O
. O

We O
first O
identified O
IRONGATE B-malware.backdoor
when O
investigating O
droppers O
compiled O
with O
PyInstaller O
— O
an O
approach O
used O
by O
numerous O
malicious O
actors O
. O

It O
also O
checks O
if O
certain O
processes O
related O
to O
certain O
security O
products O
are O
running O
on O
the O
affected O
system O
. O

This O
is O
shown O
in O
the O
figure O
below O
. O

File O
MD5 O
hashes O
: O

Telltale O
signs O
of O
social O
engineering O
include O
' O
too-good-to-be-true O
' O
offers O
and O
messages O
that O
lack O
context O
. O

How O
did O
you O
become O
aware O
of O
this O
threat O
? O

Add O
task O
Delete O
task O
Stop O
task O
Modify O
task O
or O
configuration O
Upload O
data O
Download O
data O
The O
following O
chapter O
, O
CozyDuke B-malware.drop
Tasks O
, O
provides O
further O
information O
on O
the O
tasks O
CozyDuke B-malware.drop
has O
been O
observed O
executing O
. O

Upon O
successful O
exploitation O
, O
the O
malicious O
document O
file O
drops O
two O
files O
in O
the O
% O
Temp O
% O
directory O
. O

발견 O
시기 O
공격 O
대상 O
공격 O
방식 O
악성 O
행위 O
2015년 O
7월 O
자산관리 O
솔루션 O
해당 O
업체의 O
디지털 O
인증서 O
유출해 O
서명을 O
악성코드 O
악용 O
2015년 O
11월 O
ADEX O
참가 O
업체 O
매크로 O
이용한 O
스피어피싱 O
보안 O
업체의 O
디지털 O
인증서 O
유출해 O
2016년 O
2월 O
보안 O
업체 O
보안 O
프로그램 O
취약점 O
악성코드에 O
서명 O
악용 O
2015년 O
11월부터 O
공격 O
시도 O
추정 O
2016년 O
2월 O
DRM O
제품 O
가장 O
방위산업체 O
, O
해양 O
, O
2016년 O
4월 O
ICT O
서비스 O
제공 O
중앙관리 O
솔루션 O
B O
취약점 O
2016년 O
6월 O
방위산업 O
관련 O
대기업 O
2016년 O
8월 O
군사 O
관련 O
기관 O
중앙관리 O
시스템 O
A O
취약점 O
항공기 O
설계도 O
등 O
기밀 O
자료 O
유출 O
백신 O
프로그램 O
관리 O
시스템 O
취약점 O
군사 O
정보 O
유출 O
2016년 O
10월 O
도박 O
게임 O
사용자 O
각종 O
유틸리티 O
설치 O
파일 O
도박성 O
게임 O
패 O
훔쳐보기 O
2017년 O
1월 O
도박 O
게임 O
사용자 O
PC방 O
관리 O
시스템 O
취약점 O
도박성 O
게임 O
패 O
훔쳐보기 O
2017년 O
3월 O
ATM O
제조 O
업체 O
및 O
백신 O
프로그램 O
관리 O
ATM O
기기 O
시스템 O
취약점 O
신용카드 O
정보 O
유출 O
후 O
해외에서 O
카드 O
복제 O
( O
복제카드 O
사용자 O
검거 O
) O
2016년 O
11월부터 O
공격 O
전개 O
추정 O
2017년 O
3월 O
지급 O
결제 O
대행 O
소프트웨어 O
위장 O
( O
혹은 O
변조 O
) O
악성코드 O
추가 O
다운로드 O
2017년 O
4월 O
에너지 O
연구소 O
최소 O
2차례 O
공격 O
시도 O
2017년 O
5월 O
리포트 O
A O
액티브 O
X O
취약점 O
금융 O
노조 O
홈페이지 O
통해 O
악성코드 O
감염 O
2017년 O
6월 O
2017년 O
10월 O
여행사 O
A O
중앙관리 O
솔루션 O
B O
취약점 O
, O
스피어피싱 O
( O
매크로 O
) O
리포트 O
A O
취약점 O
, O
개인 O
정보 O
유출 O
중앙관리 O
솔루션 O
B O
취약점 O
2017년 O
9월부터 O
공격 O
시작 O
추정 O
2017년 O
12월 O
여행사 O
B O
2017년 O
12월 O
ERP O
제품 O
A O
업데이트 O
여행사 O
A O
공격에 O
사용된 O
악성코드와 O
유사 O
업데이트 O
관련 O
파일 O
변조해 O
악성코드 O
추가 O
다운로드 O
특정 O
가상화폐 O
거래소를 O
통해 O
다운 O
2017년 O
12월 O
가상화폐 O
사용자 O
원격지원 O
A O
설치 O
파일 O
로드 O
시 O
악성코드 O
포함된 O
파일 O
다 O
2018년 O
2월 O
가상화폐 O
사용자 O
매크로 O
이용한 O
메일 O
국회 O
의원실 O
사칭 O
2018년 O
4월 O
ERP O
제품 O
B O
액티브X O
취약점 O
[ O
표 O
1 O
] O
안다리엘 O
그룹 O
주요 O
공격 O
사례 O

Below O
screen O
shot O
shows O
a O
network O
communication O
pattern O
indicating O
a O
document O
named O
' O
secret.docx O
' O
was O
opened O
with O
Microsoft O
Word O
. O

Then O
it O
goes O
on O
to O
load O
the O
DLL O
using O
Windows O
regsvr32.exe O
. O

The O
failure O
occurred O
during O
the O
time O
period O
when O
TRITON O
was O
used O
. O

Their O
evolving O
and O
modified O
SPLM/CHOPSTICK/XAgent B-malware.backdoor
code O
is O
a O
longstanding O
part O
of O
Sofacy O
activity O
, O
however O
much O
of O
it O
is O
changing O
. O

Although O
the O
MenuPass O
Group O
used O
mostly O
publicly O
available O
RATs O
, O
they O
were O
successful O
in O
penetrating O
a O
number O
of O
high O
value O
targets O
, O
so O
it O
is O
entirely O
possible O
this O
is O
indeed O
a O
continuation O
of O
past O
activity O
. O

Infection O
Chain O
for O
the O
current O
ChessMaster O
campaign O

An O
individual O
at O
the O
prime O
minister O
's O
office O
at O
the O
Palestinian O
Authority O
( O
both O
his O
Gmail O
account O
and O
an O
account O
under O
pmo.pna.ps O
) O
. O

which O
has O
resolved O
to O
69.80.107.129 B-ip.unknown
since O
we O
started O
examining O
the O
case O
. O

NBTScan O
: O
A O
free O
tool O
for O
scanning O
IP O
networks O
for O
NetBIOS O
name O
information O
. O

DroidJack B-malware.backdoor
malware O
. O

Figure O
10 O
shows O
the O
date O
of O
the O
file O
after O
the O
Web B-malware.ransom
shell O
modifies O
the O
time O
stamp O
. O

This O
technique O
of O
UAC O
bypass O
is O
mentioned O
in O
the O
blog O
' O
Fileless B-malware.unknown
' O
UAC O
Bypass O
Using O
eventvwr.exe O
and O
Registry O
Hijacking O
Normally O
when O
eventvwr.exe O
process O
( O
which O
is O
running O
as O
high O
integrity O
process O
) O
is O
invoked O
, O
it O
starts O
mmc.exe O
which O
opens O
eventvwr.msc O
causing O
the O
Event O
Viewer O
to O
be O
displayed O
. O

Specifically O
, O
the O
malware O
had O
an O
embedded O
Mimikatz O
DLL O
that O
it O
used O
to O
extract O
Windows O
account O
credentials O
from O
the O
memory O
of O
a O
compromised O
PC O
. O

clients O
and O
their O
associates O
, O
on O
the O
same O
dates O
. O

directory O
and O
loads O
it O
as O
a O
service O
. O

To O
date O
, O
nobody O
has O
been O
able O
to O
find O
any O
significant O
code O
sharing O
between O
ExPetr/Petya O
and O
older O
malware O
. O

tor.doc O
passwords O
paypal O
logins O
. O

4 O
. O

internationsplanet[.]com O
Figure O
11 O
: O
Table O
of O
atomic O
indicators O
Figure O
12 O
: O
Timeline O
of O
various O
dates O
associated O
with O
the O
involved O
indicators O
While O
this O
attack O
leveraged O
a O
zero-day O
exploit O
, O
individual O
attacker O
actions O
do O
not O
happen O
in O
isolation O
. O

@ O
@ O
00 O
dir O
5 O
@ O
@ O
d81596a9 O
getres O

HEX O
compiler O
version O
Decoded O
compiler O
version O
009D766F B-hash
009B766F B-hash
00AB766F B-hash
00010000 B-hash
00937809 B-hash
00AA766F B-hash
009E766F B-hash
VC O
2010 O
( O
build O
30319 O
) O
VC O
2010 O
( O
build O
30319 O
) O
VC O
2010 O
( O
build O
30319 O
) O
VC O
2008 O
( O
build O
30729 O
) O
VC O
2010 O
( O
build O
30319 O
) O
VC O
2010 O
( O
build O
30319 O
) O

Hostname O
Samsung.ddns.me B-url.unknown
Wininit.myq-see.com B-url.unknown
Winmeif.myq-see.com B-url.unknown
Collge.myq-see.com B-url.unknown
Sara2011.no-ip.biz B-url.unknown
First O
Seen O

The O
compromised O
eye-watch[.]in B-url.unknown
domain O
has O
been O
associated O
with O
other O
malicious O
activity O
in O
recent O
months O
. O

( O
63 O
) O
( O
21 O
) O
Threat O
Round O
Up O
for O
April O
20-27 O
GravityRAT B-malware.drop
- O
The O
Two-Year O
Evolution O
Of O
An O
APT O
Targ O
... O
Vulnerability O
Spotlight O
: O
Hyland O
Perceptive O
Documen O
... O
Cryptomining O
Campaign O
Returns O
Coal O
and O
Not O
Diamond O
... O
Beers O
with O
Talos O
EP27 O
: O
Smart O
Install O
, O
Vuln O
Process O
... O
Vulnerability O
Spotlight O
: O
Multiple O
Issues O
in O
Foxit O
... O

SHA512 O
6568f1f054c56716506ea2acdfb60919cc55f3da4ef05dee88925b6ccb835ad471e7d0d3e61befca B-hash
8b7d320c08ee7ba96322c127329c6f94bfb288eeb9c6a0c5 B-hash

A O
TrendLabs O
Report O

jmidebs O

The O
exploit O
for O
this O
vulnerability O
was O
leaked O
in O
a O
Hacking O
Team O
dump O
. O

If O
so O
, O
it O
spawns O
the O
service O
watchdog O
thread O
. O

Customer O
Stories O
Blogs O

We O
believe O
the O
attacks O
are O
launched O
by O
an O
APT O
Group O
we O
track O
under O
the O
codename O
' O
ScarCruft B-malware.infosteal
' O
. O

We O
have O
observed O
actors O
amending O
the O
ScanBox B-malware.infosteal
framework O
to O
evade O
existing O
public O
signatures O
, O
detailed O
below O
. O

Pastebin O
Account O
: O

FireEye O
is O
a O
registered O
trademark O
of O
FireEye O
, O
Inc O
. O

At O
this O
time O
, O
we O
are O
reaching O
out O
to O
victims O
of O
active O
infections O
to O
offer O
remediation O
assistance O
, O
IOCs O
, O
and O
our O
full O
intelligence O
report O
to O
help O
them O
counteract O
this O
threat O
. O

Even O
with O
a O
minimal O
static O
footprint O
, O
upon O
document O
load O
, O
the O
remote O
Flash O
object O
will O
be O
retrieved O
and O
executed O
within O
the O
context O
of O
Microsoft O
Office O
. O

It O
has O
almost O
no O
code O
associated O
with O
it O
other O
than O
standard O
iOS O
app O
runtime O
code O
. O

JRat B-malware.backdoor
Controller O
on O
Windows O

But O
, O
when O
the O
UTF-8 O
based O
filename O
is O
displayed O
in O
ANSI O
, O
the O
name O
is O
displayed O
as O
' O
gpj.1bajaR.exe B-malware.infosteal
' O
. O

After O
the O
encrypted O
timestamp O
values O
, O
the O
file O
contains O
a O
number O
of O
records O
encrypted O
with O
AES O
, O
delimited O
by O
EAE9E8FF O
. O

We O
were O
able O
to O
retain O
a O
copy O
of O
an O
email O
used O
to O
target O
an O
Israeli O
ambassador O
in O
a O
large O
eastern O
European O
country O
. O

< O
static O
version O
string O
> O
== O

OSTMORTEM O

Most O
notably O
, O
Russian O
attempts O
to O
influence O
Ukrainian-EU O
relations O
resulted O
in O
the O
large-scale O
, O
Maidan O
protest O
movement O
, O
eventually O
resulting O
in O
the O
ouster O
of O
then-president O
Victor O
YANUKOVYCH O
, O
the O
invasion O
and O
annexation O
of O
the O
Crimean O
Peninsula O
by O
Russia O
, O
and O
the O
protracted O
armed O
conflict O
in O
eastern O
Ukraine O
. O

This O
low O
confidence O
but O
persistent O
hunch O
is O
what O
motivates O
us O
to O
ask O
about O
the O
origin O
of O
ExPetr/Petya O
. O

2016 O
5:19 O
AM O
. O

File O
Reputation O
– O
Tune O
Anti-Virus O
file O
reputation O
systems O
to O
the O
most O
aggressive O
setting O
possible O
; O
some O
products O
can O
limit O
execution O
to O
only O
the O
highest O
reputation O
files O
, O
stopping O
a O
wide O
range O
of O
untrustworthy O
code O
from O
gaining O
control O
. O

In O
addition O
, O
we O
expose O
the O
identity O
of O
an O
individual O
who O
is O
behind O
the O
DustySky B-malware.drop
campaign O
. O

In O
comparison O
, O
the O
Groundbait O
attackers O
registered O
and O
paid O
for O
their O
own O
malicious O
domains O
and O
IP O
addressees O
. O

This O
initial O
version O
of O
ANEL B-malware.backdoor
had O
a O
hardcoded O
version O
labeled O
' O
5.0.0 O
beta1 O
' O
that O
contained O
incomplete O
code O
. O

OceanLotus O
Group O
( O
which O
also O
goes O
by O
the O
names O
APT-C-00 O
, O
SeaLotus O
and O
APT32 O
) O
, O
which O
was O
first O
documented O
by O
Qihoo O
360 O
's O
SkyEye O
Labs O
in O
2015 O
and O
further O
researched O
by O
other O
security O
companies O
, O
including O
FireEye O
's O
report O
. O

If O
the O
installed O
product O
matches O
a O
name O
on O
the O
list O
, O
the O
dropper O
will O
immediately O
exit O
. O

Mimikatz B-malware.unknown
– O
PowerShell O
and O
Binary O
versions O
, O
with O
multiple O
layers O
of O
obfuscation O
. O

안다리엘 O
그룹은 O
한국에서 O
많이 O
사용되는 O
중앙관리 O
솔루션을 O
이용한 O
다수의 O
공격을 O
전개한 O
바 O
있다 O
. O

3/12 O

The O
server O
variant O
appears O
to O
have O
a O
modular O
design O
allowing O
an O
attacker O
to O
compile O
only O
the O
components O
that O
are O
necessary O
for O
any O
given O
operation O
. O

After O
gaining O
access O
to O
the O
server O
, O
the O
attackers O
installed O
the O
tools O
they O
needed O
at O
different O
times O
. O

However O
, O
archived O
versions O
of O
some O
pages O
can O
be O
found O
: O

First O
Seen O
: O

Only O
one O
post O
was O
published O
, O
with O
text O
in O
English O
and O
Hebrew O
. O

Checks O
for O
the O
presence O
of O
security O
tools O
( O
detailed O
in O
the O
Appendix O
) O
and O
if O
any O
of O
these O
security O
tools O
are O
discovered O
, O
then O
the O
system O
will O
be O
shut O
down O
, O
as O
shown O
in O
Figure O
14 O
. O

Trojan.MSIL.Musik O

This O
threat O
analysis O
will O
help O
to O
inform O
organizations O
and O
support O
their O
decision O
making O
on O
how O
to O
better O
contain O
or O
mitigate O
the O
threat O
through O
monitoring O
or O
blocking O
. O

Receiving O
next O
commands O
from O
the O
C O
& O
C O
The O
following O
cmd O
commands O
sent O
from O
the O
C O
& O
C O
are O
then O
passed O
to O
the O
worker O
thread O
and O
written O
to O
cache.txt O
. O

In O
particular O
, O
the O
group O
redirected O
visitors O
from O
software O
aggregation O
and O
sharing O
site O
tamindir[.]com B-url.unknown
to O
their O
attacker-controlled O
site O
at O
true-crypt[.]com B-url.unknown
. O

When O
uncompressed O
, O
these O
archives O
typically O
contain O
the O
malicious B-malware.backdoor
payload O
itself O
, O
which O
the O
user O
may O
then O
run O
directly O
. O

Executive O
Perspective O
Blog O
Threat O
Research O
Blog O
Products O
and O
Services O
Blog O

We O
believe O
this O
malicious O
software O
has O
been O
developed O
by O
the O
Animal O
Farm O
espionage O
group O
, O
who O
also O
created O
the O
infamous O
Casper B-malware.unknown
, O

It O
then O
enumerates O
the O
library O
's O
EAT O
to O
find O
exported O
function O
names O
by O
checking O
each O
function O
name O
for O
the O
character O
and O
the O
specific O
offset O
. O

Send O
link O
mirroring O
structure O
of O
legitimate O
organization O
's O
site O
that O
is O
designed O
to O
expire O
once O
users O
clickit O
. O

The O
sample O
communicates O
with O
a O
command O
& O
control O
server O
in O
Vietnam O
, O
and O
exfiltrates O
text O
messages O
to O
a O
Vietnamese O
telephone O
number O
. O

They O
could O
very O
likely O
be O
the O
threat O
actors O
themselves O
, O
testing O
to O
see O
if O
their O
malware O
is O
detected O
by O
the O
AV O
companies O
. O

First O
Seen O
: O

The O
key O
is O
named O
' O
MSSecurity O
' O
and O
executes O
the O
exact O
same O
command O
line O
as O
the O
infector O
, O
every O
time O
the O
system O
boots O
- O
' O
' O
regsvr32.exe O
' O
/s O
/n O
/i O
' O
% O
APPDATA O
% O
\ O
% O
DLLNAME O
% O
' O
' O
. O

Exploitation O
of O
CVE-2017-11882 O

2 O

This O
assessment O
is O
based O
on O
a O
number O
of O
factors O
, O
but O
chief O
among O
them O
is O
the O
likelihood O
that O
a O
military O
member O
would O
only O
trust O
and O
use O
an O
application O
designed O
to O
calculate O
something O
as O
critical O
as O
targeting O
data O
if O
it O
was O
developed O
and O
promoted O
by O
a O
member O
of O
their O
own O
forces O
. O

First O
we O
prepared O
a O
virtual O
machine O
environment O
, O
because O
we O
can O
possibly O
run O
malicious O
routines O
from O
the O
sample O
. O

One O
of O
them O
attracted O
our O
attention O
because O
it O
implements O
a O
bypass O
for O
security O
solutions O
we O
have O
never O
seen O
before O
. O

RECONNAISSANCE O

Please O
run O
freshclam O
to O
ensure O
you O
stay O
updated O
with O
the O
latest O
coverage O
. O

Figure O
7 O
: O

Threat O
Connect O
Threat O
Intelligence O
Platform O
Why O
Threat O
Intelligence O
is O
Important O
How O
to O
Develop O
Threat O
Intelligence O
Community O
Collaboration O
Case O
Study O
Capabilities O
Integrations O
ThreatConnectTM O
API O
ThreatConnectTM O
Cloud O
Cloud O
Security O
Upgrade O
Communities O
Private O
Communities O
Moderated O
Common O
Community O
Moderated O
Subscriber O
Communities O
Intelligence O
Research O
Team O
Data O
Privacy O
Diamond O
Model O
of O
Intrusion O
Analysis O
Threat O
Inference O
Engine O
Collaborative O
Intelligence O
In O
The O
News O
Press O
Releases O
Blog O
Leadership O
Careers O
Contact O
Us O
News O
& O
Events O
Methodology O
About O
Login O
Home O
News O

Many O
others O
have O
also O
contributed O
to O
research O
on O
Syrian O
malware O
, O
from O
Telecomix O
to O
a O
range O
of O
security O
companies O
. O

The O
virtual O
terminal O
looks O
familiar O
( O
Figure O
22 O
) O
, O
but O
uses O
Linux O
commands O
instead O
of O
Windows O
because O
they O
are O
ultimately O
interpreted O
by O
the O
underlying O
operating O
system O
. O

01 O
– O
Index O
size O
, O
1 O
. O

This O
malicious O
document O
shared O
by O
Brian O
triggered O
this O
investigation O
and O
helped O
me O
in O
identifying O
the O
related O
Emails O
and O
related O
documents O
associated O
with O
this O
cyber O
attack O
. O

Forensic O
tool-marks O
in O
the O
CRC O
algorithm O
can O
be O
traced O
to O
Chinese O
origin O
. O

A O
partial O
list O
of O
fi O
les O
and O
the O
number O
of O
hits O
can O
be O
seen O
in O
the O
image O
below O
: O
Another O
interesting O
aspect O
is O
that O
attackers O
often O
reset O
the O
download O
counters O
along O
with O
the O
IP O
Logs O
that O
keep O
a O
record O
of O
the O
targeted O
victims O
of O
different O
campaigns O
. O

The O
DarkComet B-malware.backdoor
sample O
upon O
which O
we O
will O
primarily O
focus O
on O
today O
is O
462,848 O
bytes O
in O
size O
and O
has O
an O
MD5 O
hash O
of O

' O
-- O
-C O
' O
in O
case O
' O
Logout O
' O
( O
close O
) O
event O
occurred O
, O
or O
' O
-- O
-N O
' O
if O
neither O
of O
the O
events O
occurred O
, O
e.g. O
: O

Deceptive O
Man-in-the-Middle O

In O
recent O
days O
, O
various O
malware O
samples O
have O
been O
uploaded O
to O
malware O
repositories O
which O
appear O
to O
originate O
from O
the O
intrusion O
. O

The O
check O
for O
access O
rights O
effectively O
checks O
to O
see O
if O
the O
server O
variant O
process O
is O
running O
under O
the O
NT O
Authority O
. O

thread O
begins O
by O
establishing O
the O
set O
of O
internal O
command O
handlers O
available O
to O
the O
server O
variant O
. O

There O
are O
several O
modules O
designed O
to O
gather O
personal O
information O
about O
the O
victim O
, O
including O
contacts O
, O
photos O
, O
call O
logs O
, O
SMS O
, O
as O
well O
as O
information O
about O
the O
mobile O
device O
, O
such O
as O
geolocation O
, O
Android O
version O
, O
device O
model O
, O
network O
operator O
, O
and O
phone O
numbers O
. O

Implication O
: O
Financial O
losses O
due O
to O
process O
downtime O
and O
complex O
plant O
start O
up O
procedure O
after O
the O
shutdown O
. O

Jan O
26th O
2003 O

The O
highlighted O
bytes O
represent O
the O
scrambled O
computer O
info O
Figure O
22 O
. O

At O
this O
point O
, O
the O
actual O
process O
of O
decryption O
is O
performed O
. O

Afterward O
, O
the O
keep-alive O
packets O
between O
the O
victim O
and O
controller O
maintained O
the O
connection O
, O
which O
allowed O
me O
to O
test O
the O
functionality O
of O
with O
the O
custom O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
controller O
. O

The O
payload O
of O
each O
destined O
packet O
contains O
the O
following O
header O
: O

After O
authenticating O
, O
the O
malware O
sends O
e-mails O
to O
another O
specified O
e-mail O
address O
, O
and O
reads O
e-mails O
from O
the O
inbox O
. O

Additionally O
, O
the O
configuration O
is O
stored O
embedded O
in O
the O
binary O
, O
not O
as O
a O
separate O
XML O
file O
in O
the O
manner O
of O
newer O
CozyDuke B-malware.drop
versions O
. O

T O
his O
router O
uses O
version O
6.34 O
. O

The O
RunAtLoad O
key O
will O
command O
launchd O
to O
run O
the O
daemon O
when O
the O
operating O
system O
starts O
up O
, O
while O
the O
KeepAlive O
key O
will O
command O
launchd O
to O
let O
the O
process O
run O
indefinitely O
. O

The O
US O
government O
reports O
that O
Bankshot O
is O
used O
by O
Hidden B-malware.unknown
Cobra I-malware.unknown
to O
target O
multiple O
industries O
including O
financial O
organizations O
. O

Figure O
2 O

systemd O
Vulnerability O
Leads O
to O
Denial O
of O
Service O
on O
Linux O
qkG B-malware.ransom
Filecoder I-malware.ransom
: O
Self-Replicating O
, O
Document-Encrypting O
Ransomware O
Mitigating O
CVE-2017-5689 O
, O
an O
Intel O
Management O
Engine O
Vulnerability O
A O
Closer O
Look O
at O
North O
Korea O
's O
Internet O
From O
Cybercrime O
to O
Cyberpropaganda O

PTL.AYM O
is O
in O
fact O
another O
binary O
file O
; O
specifically O
, O
it O
is O
a O
DLL O
file O
with O
the O
following O
properties O
: O

The O
entrypoint O
function O
varies O
, O
but O
is O
always O
specified O
in O
the O
dropper O
configuration O
. O

This O
APT O
attack O
was O
analyzed O
and O
attributed O
upon O
the O
detection O
and O
we O
now O
confirmed O
its O
association O
with O
the O
APT-C-06 O
Group O
. O

The O
email O
was O
sent O
from O
the O
IP O
address O
43.249.39.152 B-ip.unknown
, O
in O
Singapore O
, O
on O
December O
28 O
at O
23:34 O
. O

Specifically O
, O
according O
to O
the O
author O
, O
the O
' O
server O
' O
component O
is O
the O
malware O
that O
resides O
on O
victim O
endpoints O
that O
connect O
to O
the O
' O
client O
' O
, O
which O
is O
operated O
by O
the O
attacker O
from O
one O
or O
more O
remote O
command-and-control O
( O
CnC O
) O
systems O
. O

Some O
victims O
of O
Operation B-malware.ransom
Manul I-malware.ransom
have O
expressed O
a O
desire O
to O
preserve O
their O
anonymity O
, O
which O
we O
respect O
. O

Among O
these O
tools O
are O
two O
backdoors O
that O
exploited O
DLL O
sideloading O
attack O
in O
Microsoft O
, O
Google O
and O
Kaspersky O
applications O
. O

926235FCF7B91442A405B5760A0729EB B-hash
helpme.no-ip.biz B-url.cncsvr

This O
comes O
at O
a O
time O
when O
the O
demand O
for O
services O
is O
stronger O
than O
ever O
and O
increasing O
daily O
. O

2 O
Jan O
. O

2BCDC5091C446E8B6888D802A3589E09 B-hash
loading.myftp.org B-url.cncsvr
US O

One O
of O
the O
common O
malware O
samples O
used O
over O
the O
course O
of O
Operation B-malware.ransom
Manul I-malware.ransom
is O
known O
as O
JRat B-malware.backdoor
or O
Jacksbot O
. O

The O
number O
originates O
from O
India O
and O
uses O
the O
' O
Vodafone O
India O
' O
network O
with O
roaming O
capability O
disabled O
. O

ACTIONABLE O
INTELLIGENCE O

Moreover O
, O
these O
APT B-malware.unknown
campaigns O
were O
not O
limited O
to O
western O
countries O
. O

The O
original O
project O
was O
built O
as O
a O
command O
line O
utility O
with O
the O
target O
process O
identifier O
provided O
as O
an O
argument O
. O

Unknown O
0x89CF98B1 O
rndismpc O
' O
Action O
' O
' O
rndismpc O
' O
Stuxnet.a O
0xAE240682 O
MRxCls O
' O
Data O
' O
' O
MRxClsDvX O
' O
Stuxnet.b/.c O
0xAE240682 O
MRxCls O
' O
Data O
' O
' O
MRxClsDvX O
' O
Unknown O
0xAE240682 O
rtniczw O
' O
Config O
' O
' O
RealTekDev291 O
' O
Unknown O
0xAE240682 O
jmidebs O
Duqu O
Duqu B-malware.infosteal
0xAE240682 O
0x20F546D3 O
' O
IDE O
' O
{ O
3093983-109232-29291 O
} O
' O
FILTER O
' O
{ O
3093AAZ3-1092-2929-'FILTER O
' O
{ O
624409B3-4CEF-41c0-8B81-7634279A41E5 O
} O
9391 O
} O

Here O
are O
a O
few O
things O
you O
can O
do O
to O
avoid O
being O
manipulated O
like O
this O
into O
downloading O
spyware O
: O

At O
the O
bottom O
was O
a O
link O
saying O
' O
Here O
For O
Watch O
It O
! O

The O
campaign O
against O
Ablyazov O
's O
associates O
used O
the O
same O
malware O
as O
we O
found O
in O
Operation B-malware.ransom
Manul I-malware.ransom
, O
and O
sometimes O
used O
the O
exact O
same O
emails O
as O
the O
emails O
sent O
to O
EFF O
's O
Respublika O

German O
Bundestag O
& O
Political O
Parties O
JUNE O
2015 O
Germany O
's O
Federal O
Office O
for O
Security O
in O
Information O
Technology O
( O
BSI O
) O
announced O
that O
APT28 B-malware.infosteal
was O
likely O
responsible O
for O
the O
spear O
phishing O
emails O
sent O
to O
members O
of O
several O
German O
political O
parties O
. O

Most O
and O
major O
American O
top O
Gartner O
Antivirus O
companies O
did O
not O
detect O
it O
! O
! O

Malware O
then O
reads O
the O
c2 O
response O
and O
from O
the O
C2 O
response O
it O
extracts O
two O
things O
a O
) O
filename O
and O
b O
) O
the O
command O
string O
that O
will O
trigger O
the O
download O
functionality O
. O

By O
limiting O
their O
use O
of O
malware O
, O
groups O
such O
as O
Chafer O
hope O
to O
be O
less O
conspicuous O
on O
a O
victim O
's O
network O
and O
, O
if O
discovered O
, O
make O
their O
attack O
more O
di cult O
to O
attribute O
. O

The O
developer O
crafted O
Office O
Word O
and O
Excel O
documents O
to O
see O
the O
detection O
in O
VirusTotal O
. O

TRITON B-malware.infosteal
is O
also O
designed O
to O
communicate O
using O
the O
proprietary O
TriStation O
protocol O
which O
is O
not O
publicly O
documented O
suggesting O
the O
adversary O
independently O
reverse O
engineered O
this O
protocol O
. O

Contact O
information O
: O
BM-2cVcZL1xfve1yGGKwEBgG1ge6xJ5PYGfGw@bitmessage.ch O
reserve O
: O
BM-2cT4U1vBdjfqKDeWMEXgCWs9SfnMK1GLTF@bitmessage.ch O

In O
a O
recent O
wave O
, O
a O
bit.ly O
link O
( O
https://bitly[.]com/1YRoIPX) O
was O
used O
instead O
of O
a O
direct O
link O
to O
the O
malware O
( O
bit.ly O
is O
a O
legitimate O
URL O
shortening O
service O
) O
. O

While O
our O
work O
highlights O
the O
human O
rights O
ramifications O
of O
the O
mis-use O
of O
this O
technology O
, O
it O
is O
clear O
that O
there O
are O
broader O
concerns O
. O

This O
differs O
from O
sample O
to O
sample O
. O

Once O
the O
script O
runs O
, O
it O
passes O
the O
decoded O
script O
from O
the O
image O
 le O
to O
the O
Windows O
command O
line O
in O
a O
variable O
$ O
x O
, O
which O
uses O
cmd.exe O
to O
execute O
the O
obfuscated O
script O
and O
run O
it O
via O
PowerShell O
. O

This O
can O
also O
be O
used O
to O
monitor O
deletes O
, O
with O
an O
alert O
configured O
to O
fire O
on O
excessive O
deletes O
in O
a O
row O
; O
• O
Windows O
Security O
Event O
logs O
should O
be O
monitored O
to O
capture O
Scheduled O
Task O
creation O
events O
– O
Event O
ID O
4698 O
; O
• O
Registry O
Auditing O
should O
be O
enabled O
and O
monitored O
to O
capture O
any O
additions O
to O

A O
200.63.46.23 B-ip.unknown
5 O
www.dexterseason.com B-url.unknown
. O

The O
real O
application O
is O
created O
by O
keineantwort.de O
and O
we O
have O
verified O
it O
from O
their O
main O
website O
: O
Going O
back O
to O
( O
AndroidManifest.xml O
) O
file O
, O
the O
malware O
register O
itself O
as O
receiver O
of O
almost O
all O
intents O
and O
request O
almost O
all O
permissions O
available O
in O
Android O
system O
! O

A O
sample O
phishing O
email O
is O
shown O
in O
Figure O
15 O
. O

If O
' O
dwBuildNumber O
' O
is O
equal O
to O
2 O
( O
V O
ER_ O
PLATFORM_WIN32_NT O
) O
and O
' O
dwMajorVersion O
' O
is O
less O
than O
6 O
( O
prior O
to O
Windows O
Vista O
) O
it O
adds O
following O
entry O
for O
persistence O
: O

The O
module O
transmits O
the O
collected O
information O
in O
the O
body O
of O
the O
POST O
request O
and O
gets O
new O
commands O
from O
the O
server O
's O
response O
. O

According O
to O
Insikt O
Group O
's O
source O
, O
the O
Iranian O
government O
authorized O
denial-of-service O
attacks O
on O
America O
's O
largest O
financial O
services O
companies O
as O
an O
immediate O
response O
to O
the O
sanctions O
in O
a O
campaign O
dubbed O
Operation O
Ababil O
. O

Parallel O
and O
Previous O
Research O

At O
this O
point O
, O
the O
ZxShell B-malware.backdoor
library O
is O
no O
longer O
linked O
in O
the O
module O
list O
of O
the O
host O
process O
. O

SCR/EXE O
files O
- O
used O
in O
spearphishing/social O
engineering O
: O

' O
를 O
보내 O
정상 O
서버 O
여부를 O
확인한다 O
. O

GET O
/login O
? O
wd=hvJZkcIvKKupNRlsqI0aN6jZDTYPz6ZS9Q-H5bCXiER37jqqCDzS3wIUulYOjyKHcDomZCD72mAc4fSCoHhJJ1UQliBkraMepzS5J3UUFUH-nofoOgVM02UlCs4LJANIuZH90vM5KH_Ih59DdVRbgQ== O
HTTP/1.1 O
User-Agent O
: O
Mozilla/4.0 O
( O
compatible O
; O
MSIE O
7.0 O
; O
Windows O
NT O
5.1 O
; O
Trident/4.0 O
; O
.NET O
CLR O
2.0.50727 O
; O
.NET O
CLR O
3.0.4506.2152 O
; O
.NET O
CLR O
3.5.30729 O
; O
.NET O
CLR O
1.1.4322 O
) O
Host O
: O
www.microsoftservices.proxydns.com B-url.unknown
Cache-Control O
: O
no-cache O

The O
new O
process O
is O
easier O
to O
be O
neglected O
due O
to O
the O
host O
firewall O
. O

Advanced O
Malware O
Protection O
( O
AMP O
) O
is O
ideally O
suited O
to O
detect O
the O
sophisticated O
malware O
used O
by O
this O
threat O
actor O
. O

This O
module O
has O
been O
written O
in O
c O
and O
includes O
several O
specifi O
c O
methods O
and O
encodings O
that O
provide O
forensic O
track-ability O
. O

58F74545D47F5DA1ECF3093F412D7D9544A33D36430AB1AF709D835A5 O
9184611 O

It O
could O
be O
that O
the O
hacker O
decided O
to O
block O
the O
connection O
after O
seeing O
the O
result O
of O
these O
commands O
. O

15jXmdeh15nXnQ== O
15HXmdeY15fXldeg15nXnQ== O
15DXkdeY15fXlA== O
157XqdeqJyfXpA== O

11 O

We O
were O
unable O
to O
determine O
whether O
this O
DLL O
was O
created O
specifically O
by O
the O
malware O
author O
, O
or O
if O
it O
was O
from O
another O
source O
, O
such O
as O
example O
code O
or O
a O
particular O
custom O
ICS O
implementation O
. O

It O
does O
this O
by O
first O
parsing O
files O
in O
the O
IE O
History O
folder O
. O

Web O
. O

3 O
Ghostrat은 B-malware.backdoor
중앙관리 O
솔루션 O
A의 O
취약점을 O
이용하여 O
파일 O
배포 O
기능을 O
통해 O
감염을 O
시도하는 O
악성코드로 O
, O
대기업 O
해킹에 O
이용된 O
GhostRat B-malware.backdoor
악성코드에 O
의해 O
유출된 O
문서는 O
약 O
4만여건으로 O
확인되었다 O
. O

Accenture O
, O
the O
Accenture O
logo O
, O
iDefense O
and O
other O
trademarks O
, O
service O
marks O
, O
and O
designs O
are O
registered O
or O
unregistered O
trademarks O
of O
Accenture O
and O
its O
subsidiaries O
in O
the O
United O
States O
and O
in O
foreign O
countries O
. O

https://elsa-jp.jp. B-url.unknown

Irrespective O
of O
the O
threats O
sophistication O
or O
motivation O
, O
South O
Asian O
cyber O
threats O
are O
likely O
emulating O
behaviors O
of O
larger O
regional O
powers O
to O
strategically O
influence O
national O
, O
organizational O
or O
individual O
objectives O
. O

I O
thought O
it O
was O
interesting O
the O
backdoor O
used O
a O
secondary O
backup O
backdoor O
in O
addition O
to O
its O
primary O
payload O
. O

A O
patched O
version O
of O
the O
popular O
Adblock O
Plus O
chrome O
extension O
is O
used O
to O
inject O
both O
the O
in-browser O
crypto-mining O
module O
( O
based O
on O
CryptoNoter O
) O
and O
the O
in-browser O
payment O
hijacking O
module O
. O

The O
group O
demonstrates O
malleability O
and O
innovation O
in O
maintaining O
and O
producing O
familiar O
SPLM B-malware.backdoor
functionality O
, O
but O
the O
pragmatic O
and O
systematic O
approach O
towards O
producing O
undetected O
or O
difficult-to-detect O
malware O
continues O
. O

Enforce O
secure O
network O
authentication O
where O
possible O
. O

Nevertheless O
the O
certificate O
is O
useful O
for O
us O
, O
as O
it O
can O
be O
used O
to O
find O
related O
cases O
. O

ServiceDll O
and O
ServiceDllUnloadOnStop O
are O
needed O
for O
services O
that O
run O
in O
a O
shared O
process O
. O

This O
sample O
however O
is O
associated O
with O
the O
same O
C2 O
servers O
used O
by O
Operation B-malware.ransom
Manul I-malware.ransom
. O

Indicators O
of O
compromise O
( O
IoC O
) O

The O
Christian O
Science O
Monitor O
. O

STRINGTABLE O
LANGUAGE O
LANG_CHINESE O
, O
0x2 O
103 O
, O
' O
NewCT2 B-malware.backdoor
' O
106 O
, O
' O
Hello O
World O
! O
' O

Dynamic O
DNS O
is O
a O
key O
feature O
of O
the O
operation O
, O
with O
many O
known O
C O
& O
C O
servers O
operating O
from O
domains O
registered O
through O
Peng O
Yong O
's O
3322.org O
service O
. O

, O
supposedly O
a O
female O
student O
, O
engaged O
in O
an O
online O
romance O
with O
a O
target O
whose O
handle O
was O
, O
describing O
himself O
as O
living O
in O
South O
Asia O
working O
in O
garments O
manufacturing O
and O
wholesaling O
. O

Any O
C O
& O
C O
communications O
will O
involve O
encrypted O
tra c O
to O
a O
known O
website O
, O
meaning O
it O
is O
less O
likely O
to O
raise O
 ags O
on O
targeted O
networks O
. O

2 O
Jan O
. O

Targeted O
Attack O
Campaigns O
Profiling O

The O
threat O
group O
also O
reportedly O
targeted O
the O
German O
parliament O
and O
German O
Chancellor O
Angela O
Merkel O
's O
Christian O
Democratic O
Union O
party O
. O

Exhibit O
1 O
: O
Dropper O
Document O

Some O
of O
the O
payload O
names O
include O
: O

Considering O
the O
relationship O
between O
this O
attack O
and O
Cobalt O
Strike O
platform O
, O
we O
name O
it O
as O
APT-TOCS B-malware.infosteal
( O
TOCS O
refers O
to O
Threat O
on O
Cobalt O
Strike O
. O
) O

客户端技术 O
( O
1 O
) O

It O
could O
be O
a O
security O
mechanism O
implemented O
by O
the O
attackers O
to O
make O
hard O
the O
investigation O
of O
security O
firms O
. O

In O
order O
to O
infect O
the O
users O
associated O
with O
Mazagon O
Dock O
Shipbuilders O
Limited O
( O
MDL O
) O
, O
the O
attackers O
distributed O
spear-phishing O
emails O
containing O
malicious O
excel O
file O
which O
when O
opened O
drops O
a O
malware O
capable O
of O
spying O
on O
infected O
systems O
. O

However O
, O
public O
attribution O
of O
these O
activities O
to O
RIS O
is O
supported O
by O
technical O
indicators O
from O
the O
U.S. O
Intelligence O
Community O
, O
DHS O
, O
FBI O
, O
the O
private O
sector O
, O
and O
other O
entities O
. O

Файл O
создан O
в O
более O
новой O
версии O
программы O
Микрософт O
Office O
. O

- O
DrWeb O
Even O
the O
identifying O
information O
that O
the O
backdoor O
seeks O
from O
a O
system O
is O
not O
decrypted O
until O
runtime O
. O

Similar O
Targets O
were O
observed O
where O
the O
threat O
actors O
utilized O
this O
backdoor O
. O

While O
detection O
is O
done O
quickly O
, O
attribution O
for O
these O
campaigns O
is O
often O
an O
open O
and O
hard O
problem O
to O
solve O
. O

Note O
that O
the O
Indian O
attack O
does O
not O
make O
use O
of O
this O
middle-stage O
dropper O
, O
but O
directly O
installs O
and O
launches O
the O
Windows O
service O
instead O
. O

ProductVersion O
: O
5 O
, O
1 O
, O
2600 O
, O
0 O
Child O
Type O
: O
VarFileInfo O
Translation O
: O
1033/1200 O

Let O
's O
start O
reversing O
by O
loading O
a O
process O
memory O
dump O
of O
the O
running O
bot O
in O
IDA O
Pro O
. O

OfficeScan O
's O
Vulnerability O
Protection O
shields O
endpoints O
from O
identified O
and O
unknown O
vulnerability O
exploits O
even O
before O
patches O
are O
deployed O
. O

Thu O
Aug O
06 O
05:34:53 O
2015 O
Mon O
Mar O
01 O
10:28:24 O
2010 O
Thu O
Aug O
06 O
04:47:17 O
2015 O
Wed O
Apr O
22 O
04:58:34 O
2015 O
Mon O
Sep O
07 O
01:54:17 O
2015 O
Wed O
Apr O
22 O
04:58:34 O
2015 O
Trojan.CryptRedol O
None O
Trojan.CryptRedol O
. O

As O
the O
Mabna O
Institute O
indictments O
highlight O
, O
despite O
the O
lifting O
of O
sanctions O
and O
an O
appetite O
to O
re-engage O
with O
the O
international O
community O
, O
Iran O
has O
continued O
a O
subversive O
and O
aggressive O
global O
cyber O
operations O
campaign O
. O

Due O
to O
LuckyMouse O
's O
ongoing O
waterholing O
of O
government O
websites O
and O
the O
corresponding O
dates O
, O
we O
suspect O
that O
one O
of O
the O
aims O
of O
this O
campaign O
is O
to O
access O
web O
pages O
via O
the O
data O
center O
and O
inject O
JavaScripts O
into O
them O
. O

Below O
are O
details O
on O
each O
of O
the O
malware O
files O
. O

The O
actor O
was O
linked O
to O
a O
destructive O
operation O
, O
which O
used O
NewsBeef B-malware.infosteal
and O
StoneDrill B-malware.backdoor
malware O
families O
. O

This O
brings O
us O
to O
the O
next O
' O
hide O
in O
plain O
sight O
' O
tactic O
we O
noticed O
. O

Note O
that O
the O
apparent O
sender O
has O
an O
e-mail O
address O
that O
indicates O
that O
it O
was O
being O
sent O
by O
' O
Melissa O
Chan O
, O
' O
who O
is O
a O
real O
correspondent O
for O
Aljazeera O
English O
. O

Even O
though O
the O
macro O
is O
password O
protected O
, O
It O
is O
possible O
to O
extract O
macro O
code O
using O
analysis O
tools O
like O
oletools O
. O

Once O
APT28 B-malware.backdoor
and O
APT29 B-malware.backdoor
have O
access O
to O
victims O
, O
both O
groups O
exfiltrate O
and O
analyze O
information O
to O
gain O
intelligence O
value O
. O

Since O
then O
, O
several O
examples O
of O
malware O
created O
by O
Animal O
Farm O
have O
been O
found O
and O
publicly O
documented O
, O
in O
particular O
: O
Casper B-malware.unknown
, O
a O
stealthy O
first­stage O
implant O
, O
documented O
by O
ESET O
in O
last O
March O

Software-enforced O
DEP O
can O
help O
prevent O
malicious O
code O
from O
taking O
advantage O
of O
exception-handling O
mechanisms O
in O
Windows O
. O

PCCCMDPacketHeader O
and O
any O
optional O
payload O
data O
. O

Employing O
anti-debugging O
and O
anti-sandboxing O
techniques O
Runtime O
API O
Address O
resolver O
Covert O
DLL O
injection O
of O
the O
RAT B-malware.backdoor
library O
Persistence O
file O
on O
disk O

We O
continued O
to O
chase O
that O
hunch O
during O
the O
frenetic O
early O
analysis O
phase O
and O
shared O
this O
gut O
feeling O
of O
a O
similarity O
between O
ExPetr O
and O
BlackEnergy O
with O
our O
friends O
at O
Palo O
Alto O
Networks O
. O

Attached O
is O
the O
proof O
of O
transfer O
Iremit O
Transfer O
Error O
Page O
With O
warm O
regards O
Branch O
Manager O
Head O
Office O
BDBL O
Building O
( O
8th O
- O
10th O
& O
16th O
- O
19th O
Floor O
) O
8 O
, O
Rajuk O
Avenue O
G.P.O O
Box O
– O
2229 O
Dhaka-1000 O
Bangladesh O
Telephone O
: O
95603820 O
Fax O
: O
880-2-95602085 O
880-2-716344 O
Swift O
: O
IFIC O
BD O
DH O
E-mail O
: O
swift@ificbankbd.com O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-The O
information O
transmitted O
, O
including O
any O
content O
in O
this O
communication O
is O
confidential O
, O
is O
intended O
only O
for O
the O
use O
of O
the O
intended O
recipient O
and O
is O
the O
property O
of O
The O
Western O
Union O
Company O
or O
its O
affiliates O
and O
subsidiaries O
. O

This O
link O
was O
made O
through O
finding O
several O
overlapping O
IP O
addresses O
used O
by O
Mutter B-malware.backdoor
and O
Beebus B-malware.backdoor
such O
as O
the O
following O
. O

RemoteShell O
: O
Used O
to O
execute O
remote O
commands O
received O
from O
the O
attacker O
on O
the O
infected O
machine O
. O

ZxFunction001 O

AYRUNSC.exe O
is O
a O
legitimate O
and O
digitally O
signed O
binary O
created O
by O
ESTsoft O
Corp O
. O

Among O
its O
technical O
innovations O
, O
there O
is O
a O
custom O
file O
system O
to O
execute O
commands O
in O
a O
stealthy O
fashion O
, O
and O
a O
complex O
task­ O
scheduling O
module O
working O
in O
a O
similar O
way O
to O
the O
' O
cron O
' O
Unix O
command O
. O

with O
the O
key O
. O

• O
Registry O
key O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ O
SystemInformation O
, O
value O
names O
: O
SystemManufacturer O
, O
SystemProductName O
. O

XAttacker O
: O
Copy O
of O
XAttacker O
PHP O
remote O
file O
upload O
script O
. O

Four O
such O
installers O
were O
identified O
; O
files O
with O
the O
MD5 O
hash O
of O
: O
0392fb51816dd9583f9cb206a2cf02d9 B-hash
, O
( O
original O
name O
) O
e6d9fce2c6e766b0899ac2e1691b8097 B-hash
, O
( O
original O
name O
) O
e013691e702778fa6dbc35b15555c3c2 B-hash
, O
( O
original O
name O
) O
9d299d3a074f2809985e0317b9c461eb B-hash
, O
( O
original O
name O
) O
These O
are O
all O
self-extracting O
archives O
( O
WinRAR O
SFX O
RAR O
and O
SFX O
ZIP O
) O
, O
which O
again O
contain O
lure O
documents O
and O
a O
malicious O
Python O
installer O
. O

Check O
OS O
version O
: O
. O

For O
some O
Anti-Virus O
software O
this O
even O
appears O
to O
be O
version O
dependent O
. O

While O
investigating O
thlsystems.for rst.cz O
we O
discovered O
that O
the O
webpage O
belongs O
to O
a O
legitimate O
entity O
, O
suggesting O
this O
is O
a O
compromised O
server O
being O
used O
as O
both O
an O
encrypted O
backchannel O
for O
the O
attacker O
and O
the O
distribution O
of O
implants O
. O

Crowdstrike O
presents O
' O
Mo O
' O
Shells O
Mo O
' O
Problems O
' O
- O
A O
four O
part O
series O
featuring O
two O
unique O
web O
shells B-malware.backdoor
used O
by O
a O
Chinese O
threat O
group O
we O
call O
Deep O
Panda O
. O

This O
small O
, O
text-based O
payload O
can O
be O
delivered O
using O
any O
of O
the O
following O
mechanisms O
: O
• O
WebDAV O
file O
upload O
• O
JBoss O
jmx-console O
or O
Apache O
Tomcat O
management O
pages O
( O
For O
more O
details O
on O
this O
attack O
vector O
, O
read O
FireEye O
consultant O
Tony O
Lee O
's O
explanation O
) O
• O
Remote O
exploit O
with O
a O
file O
drop O
• O
Lateral O
propagation O
from O
other O
access O
After O
examining O
the O
server-side O
payload O
and O
the O
client O
used O
to O
control O
the O
Web B-malware.ransom
shell O
, O
the O
next O
step O
to O
understanding O
China B-malware.backdoor
Chopper I-malware.backdoor
is O
observing O
its O
traffic O
. O

The O
malware O
authors O
also O
possess O
an O
interesting O
understanding O
of O
execution O
policies O
which O
they O
leverage O
to O
manipulate O
their O
victim O
systems O
. O

Why O
do O
you O
call O
it O
Poseidon B-malware.infosteal
's O
Targeted O
Attack O
Boutique O
? O

Unfortunately O
, O
the O
response O
was O
empty O
and O
it O
is O
not O
possible O
to O
assess O
what O
may O
have O
been O
delivered O
. O

We O
compared O
module O
1 O
and O
the O
payload O
generated O
by O
using O
Beacon O
, O
and O
found O
only O
the O
following O
different O
data O
: O
the O
Head O
data O
, O
request O
file O
name O
and O
IP O
address O
. O

FireEye O
has O
over O
1,100 O
customers O
across O
more O
than O
40 O
countries O
, O
including O
over O
100 O
of O
the O
Fortune O
500 O
. O

The O
macro O
then O
decodes O
a O
string O
which O
runs O
PowerShell O
script O
to O
download O
malware O
from O
a O
popular O
university O
site O
located O
in O
Indonesia O
as O
shown O
below O
. O

This O
technique O
exploits O
a O
security O
vulnerability O
found O
in O
legitimate O
software O
, O
which O
allows O
the O
attackers O
to O
load O
a O
fake O
DLL O
and O
execute O
its O
malicious O
code O
. O

Figure O
28 O
: O
Recursive O
search O
through O
Windows O
using O
the O
dir O
command O

Open O
source O
reporting O
indicates O
that O
Ukrainian O
artillery O
forces O
have O
lost O
over O
50 O
% O
of O
their O
weapons O
in O
the O
2 O
years O
of O
conflict O
and O
over O
80 O
% O
of O
D-30 O
howitzers O
, O
the O
highest O
percentage O
of O
loss O
of O
any O
other O
artillery O
pieces O
in O
Ukraine O
's O
arsenal O
. O

1 O
. O

Next O
on O
the O
timeline O
is O
Babar64 B-malware.drop
, O
allegedly O
compiled O
middle O
of O
2011 O
and O
first O
seen O
on O
VirusTotal O
middle O
of O
2012 O
. O

In O
addition O
to O
identifying O
targets O
, O
root9B O
analysts O
also O
discovered O
indicators O
of O
malware O
, O
the O
analysis O
of O
which O
revealed O
several O
zero-day O
threats B-malware.backdoor
and O
their O
corresponding O
' O
hashes O
. O
' O

WADA-commissioned O
report O
documents O
evidence O
of O
Russian O
athletes O
' O
widespread O
doping O
. O

Companies O
attacked O
by O
Energetic O
Bear/Crouching O
Yeti O
are O
geographically O
distributed O
worldwide O
with O
a O
more O
obvious O
concentration O
in O
Europe O
and O
the O
US O
. O

In O
other O
words O
, O
it O
will O
convert O
the O
ASCII O
representations O
( O
0x41 O
, O
0x42 O
, O
... O
, O
0x46 O
) O
of O
the O
upper-case O
letters O
A O
through O
F O

Business O
Continuity O
: O
Are O
we O
able O
to O
sustain O
business O
operations O
without O
access O
to O
certain O
systems O
? O

Last O
Modified O
by O
: O
Windows O
ユーザー O
( O
Windows O
user O
) O

The O
requests O
contain O
minimal O
HTTP O
headers O
since O
the O
PowerShell O
command O
is O
executed O
with O
mostly O
default O
parameters O
. O

The O
sender O
is O
associated O
with O
a O
company O
named O
' O
Combined O
Freight O
( O
PVT O
) O
Limited O
' O
( O
combinedfreight[.]com B-url.unknown
) O
Combined O
Freight O
( O
PVT O
) O
Limited O
is O
freight O
forwarding O
company O
which O
is O
into O
ocean O
& O
air O
freight O
business O
headquartered O
in O
Karachi O
, O
Pakistan O
( O
as O
per O
their O
website O
) O
. O

For O
this O
version O
, O
the O
developer O
modified O
the O
architecture O
of O
the O
malware O
. O

The O
list O
of O
APIs O
to O
hook O
is O
parted O
in O
three O
groups O
: O
Internet O
communication O
File O
creation O
Media O
Any O
set O
of O
hooks O
will O
only O
be O
applied O
to O
a O
defined O
set O
of O
processes O
. O

Written O
by O
Sergei O
Shevchenko O
, O
Hirman O
Muhammad O
bin O
Abu O
Bakar O
, O
and O
James O
Wong O

Many O
pieces O
of O
the O
puzzle O
are O
still O
missing O
though O
: O
how O
the O
attackers O
sent O
the O
fraudulent O
transfers O
; O
how O
the O
malware O
was O
implanted O
; O
and O
crucially O
, O
who O
was O
behind O
this O
. O

DAT O
files O
VSE O
BOP O
Host O
IPS O
Coverage O
is O
provided O
as O
Roarur.dll O
in O
the O
5862 O
DATs O
, O
released O
January O
15 O
. O

Iranian O
cyber O
operations O
are O
administered O
via O
a O
tiered O
approach O
, O
where O
an O
ideologically O
and O
politically O
trusted O
group O
of O
middle O
managers O
translate O
intelligence O
priorities O
into O
segmented O
cyber O
tasks O
which O
are O
then O
bid O
out O
to O
multiple O
contractors O
. O

CozyDuke B-malware.drop
may O
use O
multiple O
techniques O
for O
establishing O
persistence O
; O
the O
following O
is O
one O
technique O
used O
. O

IHU O
was O
named O
in O
sanctions O
by O
the O
U.S. O
Treasury O
' O
for O
providing O
, O
or O
attempting O
to O
provide O
technological O
, O
or O
other O
support O
for O
and O
services O
in O
support O
of O
the O
IRGC O
. O
' O

These O
documents O
contain O
topics O
discussing O
either O
software O
development O
or O
digital O
currencies O
. O

In O
March O
2018 O
, O
we O
provided O
a O
detailed O
analysis O
of O
another O
campaign O
that O
bore O
the O
hallmarks O
of O
MuddyWater O
. O

Delete O
Stop O
Modify O
Upload O
Download O

Figure O
24 O
: O
API O
calls O
to O
retrieve O
handle O
file O
name O
in O
mshta.exe O
process O

Phone O
: O
+1-888-282-08 O
7 O
0 O
Email O
: O
NCCICCustomerService@hq.dhs.gov O

Anonymous O
Poland O
( O
@ O
anpoland O
) O
. O

The O
batch O
file O
contains O
the O
following O
commands O
, O
which O
execute O
PowerShell O
scripts O
( O
marked O
in O
red O
) O
. O

Biogas.exe O

It O
also O
supports O
HTTPS O
and O
the O
usage O
of O
a O
SOCKS5 O
, O
SOCKS4a O
or O
SOCKS4 O
proxy O
. O

During O
the O
initial O
login O
request O
, O
the O
3.6 O
version O
of O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
enumerates O
system O
information O
and O
transmits O
that O
information O
to O
the O
controller O
. O

It O
then O
sends O
another O
event O
to O
inject O
in O
to O
the O
following O
Mac O
system O
processes O
: O
mdworker O
SystemUIServer O
Dock O
loginwindow O
UserEventAgent O

The O
samples O
from O
email O
attachments O
have O
been O
shared O
with O
selected O
individuals O
within O
the O
security O
community O
, O
and O
we O
strongly O
urge O
antivirus O
companies O
and O
security O
researchers O
to O
continue O
where O
we O
have O
left O
off O
. O

However O
, O
a O
coincidence O
seems O
unlikely O
, O
and O
CTU O
researchers O
suspect O
that O
TG-4127 B-malware.infosteal
used O
the O
spearphishing O
emails O
or O
similar O
techniques O
to O
gain O
an O
initial O
foothold O
in O
the O
DNC O
network O
. O

The O
ShellMain O
function O
is O
a O
stub O
that O
relocates O
the O
DLL O
to O
another O
buffer O
and O
spawns O
a O
thread O
that O
starts O
from O

Spearphishing O
and O
.rar O
Attachments O
with O
RTLO O

, O
etc O
) O
. O

During O
that O
proposed O
development O
timeframe O
, O
a O
number O
of O
significant O
events O
unfolded O
between O
Ukraine O
, O
Russia O
, O
and O
the O
international O
community O
. O

The O
exploit O
code O
used O
by O
the O
original O
attackers O
was O
quickly O
improved O
and O
added O
to O
Metasploit O
thus O
greatly O
expanding O
the O
potential O
number O
of O
attackers O
and O
reliability O
of O
code O
. O

Warning O
: O
Many O
of O
these O
websites O
may O
still O
be O
compromised O
and O
present O
a O
risk O
to O
visitors O
. O

Figure O
26 O
. O

Figure O
8 O

SPLM B-malware.backdoor
full O
backdoor O
and O
plugins O
crypto O
and O
strings O
v4 O

This O
page O
used O
to O
offer O
no-ip O
type O
hosting O
and O
was O
widely O
used O
by O
malware O
authors O
. O

This O
indicates O
that O
Bank O
of O
America O
, O
is O
among O
the O
probable O
targets O
. O

An O
international O
organization O
that O
monitors O
human O
rights O
, O
counter-terrorism O
and O
cyberattacks O
on O
critical O
infrastructure O
in O
the O
Ukraine O
. O

At O
this O
point O
, O
we O
can O
guess O
that O
stable_var_41C O
is O
going O
to O
play O
the O
role O
of O
a O
substitution O
table O
for O
decrypting O
the O
source O
buffer O
src_buf_var_4 O
, O
so O
let O
's O
see O
how O
DarkComet B-malware.backdoor
builds O
this O
table O
. O

PLCSIM O
is O
used O
to O
test O
PLC O
program O
functionality O
prior O
to O
in-field O
deployment O
. O

CozyDuke B-malware.drop
main O
component O
820KB O
DLL O
Encrypted O
strings O
Encrypted O
external O
configuration O

Requested O
ransom O
decreased O
from O
0.2 O
BTC O
to O
0.05 O
BTC O
, O
most O
likely O
due O
to O
the O
lack O
of O
payment O
they O
received O
. O

JRat B-malware.backdoor
also O
employs O
anti-virtualization O
features O
to O
detect O
and O
shut O
down O
if O
it O
is O
being O
run O
in O
VirtualBox O
, O
VMware O
, O
or O
other O
virtualization O
software O
. O

This O
Trojan O
is O
in O
the O
same O
malware O
family O
as O
the O
Trojan O
found O
on O
an O
Angolan O
activist O
's O
computer O
at O
the O
Oslo O
Freedom O
Forum O
in O
2013—which O
was O
also O
linked O
to O
Appin O
by O
researchers O
at O
ESET O
and O
Norman O
Security O
. O

Claiming O
to O
support O
' O
fair O
play O
and O
clean O
sport O
, O
' O
Fancy O
Bears O
' O
Hack O
team O
calls O
TUEs O
' O
licenses O
for O
doping O
. O
' O

Once O
unpacked O
it O
drops O
a O
known O
malware O
variant O
, O
which O
has O
been O
seen O
as O
part O
of O
the O
Lazarus O
group O
's O
toolkit O
in O
other O
cases O
over O
the O
past O
year O
. O

We O
are O
willing O
to O
share O
additional O
information O
with O
the O
security O
community O
. O

Generally O
, O
they O
are O
masqueraded O
with O
fake O
Flash O
Player O
, O
Office O
document O
, O
or O
PDF O
document O
icons O
. O

We O
named O
this O
family O
of O
malware O
IRONGATE B-malware.backdoor
. O

Since O
they O
first O
emerged O
back O
in O
2007 O
with O
a O
series O
of O
cyberespionage O
attacks O
against O
the O
South O
Korean O
government O
, O
these O
threat O
actors O
have O
successfully O
managed O
to O
pull O
off O
some O
of O
the O
most O
notable O
and O
devastating O
targeted O
attacks—such O
as O
the O
widely-reported O
2014 O
Sony O
hack O
and O
the O
2016 O
attack O
on O
a O
Bangladeshi O
bank—in O
recent O
history O
. O

Speci cally O
, O
we O
chose O
ten O
APT B-malware.unknown
campaigns O
, O
-- O
some O
of O
which O
were O
already O
covered O
in O
the O
Usenix O
paper O
. O

Hash O

Once O
the O
user O
name O
and O
password O
is O
generated O
, O
malware O
then O
creates O
an O
XML O
file O
( O
SQLITE.xml O
) O
and O
populates O
the O
XML O
file O
with O
the O
generated O
user O
name O
and O
password O
. O

םיברק O
םילמנ O

It O
appears O
the O
attacker O
is O
using O
parts O
of O
a O
domain O
that O
belong O
to O
the O
South O
Korean O
Ministry O
of O
Agriculture O
and O
Forestry O
, O
which O
is O
in O
line O
with O
the O
attached O
document O
name O
in O
the O
email O
, O
but O
this O
domain O
has O
nothing O
to O
do O
with O
this O
government O
agency O
. O

This O
blog O
post O
describes O
another O
attack O
campaign O
where O
attackers O
impersonated O
identity O
of O
Indian O
think O
tank O
IDSA O
( O
Institute O
for O
Defence O
Studies O
and O
Analyses O
) O
and O
sent O
out O
spear-phishing O
emails O
to O
target O
officials O
of O
the O
and O
possibly O
the O
officials O
of O
IDSA O
( O
Institute O
for O
Defence O
Studies O
and O
Analyses O
) O
is O
an O
Indian O
think O
tank O
for O
advanced O
research O
in O
international O
relations O
, O
especially O
strategic O
and O
security O
issues O
, O
and O
also O
trains O
civilian O
and O
military O
officers O
of O
the O
Government O
of O
India O
and O
deals O
with O
objective O
research O
and O
policy O
relating O
to O
all O
aspects O
of O
defense O
and O
National O
security O
. O

- O
> O
| O
nt O
authority\network O
service O
[ O
S O
] O
C O
: O
\Inetpub\wwwroot O
[ O
E O
] O
| O
< O
- O

1 O
) O
Type O
of O
Processor O
2 O
) O
CPU O
Speed O
3 O
) O
Figures O
out O
the O
product O
type O
by O
querying O
the O
\SYSTEM\CurrentControlSet\Control\ProductOptions\ProductType O
registry O
key O
. O

The O
configuration O
information O
is O
encoded O
. O

We O
also O
observed O
clues O
that O
the O
attackers O
are O
interested O
in O
cryptocurrencies O
such O
as O
Bitcoin O
( O
BTC O
) O
and O
Ant O
Share O
( O
NEO O
) O
. O

Routinely O
evaluate O
known O
and O
published O
vulnerabilities O
, O
perform O
software O
updates O
and O
technology O
refreshes O
periodically O
, O
and O
audit O
external-facing O
systems O
for O
known O
Web O
application O
vulnerabilities O
. O

0AA7B256D2DCC8BD3914F895B134B225 B-hash
hint.zapto.org B-url.cncsvr

Incident O
? O

del_task O
Delete O
a O
file O
. O

Registry O
Persistence O
Key O
Registry O
Key O
Value O

Then O
there O
is O
the O
dll O
install O
name O
, O
the O
domain O
, O
and O
the O
port O
. O

The O
values O
are O
then O
decrypted O
using O
the O
system O
library O
It O
also O
steals O
login O
credential O
from O
IE O
autocomplete O
entries O
. O

APT12 O
′ O
s O
targets O
are O
consistent O
with O
larger O
People O
's O
Republic O
of O
China O
( O
PRC O
) O
goals O
. O

The O
optional O
HTTP O
data O
with O
king.jpg O
looks O
like O
a O
beacon O
to O
inform O
the O
control O
server O
that O
the O
malware O
is O
ready O
to O
accept O
new O
commands O
: O
Commands O
received O
from O
the O
control O
server O
are O
encoded O
DWORDs O
After O
decoding O
, O
these O
DWORDs O
should O
be O
in O
the O
range O
123459h O
to O
123490h O
Malware O
checking O
to O
make O
sure O
a O
received O
command O
is O
in O
the O
correct O
range O
. O

XtremeRAT B-malware.backdoor
's O
key O
scheduling O
algorithm O
( O
KSA O
) O
implementation O
contains O
a O
bug O
wherein O
it O
only O
considers O
the O
length O
of O
the O
key O
string O
, O
not O
including O
the O
null O
bytes O
between O
each O
character O
, O
as O
is O
found O
in O
these O
Unicode O
strings O
. O

field O
specifies O
the O
specific O
command O
that O
the O
client O
is O
requesting O
the O
server O
variant O
perform O
. O

1 O
. O

This O
technique O
is O
also O
used O
by O
other O
APTs O
as O
persistence O
mechanisms O
, O
as O
documented O
by O
our O
Mandiant O
colleagues O
. O

As O
demonstrated O
by O
our O
work O
on O
the O
Freegate B-malware.backdoor
malware O
, O
as O
well O
as O
the O
Green O
Simurgh O
case O
, O
these O
vulnerabilities O
are O
exploited O
with O
serious O
consequences O
for O
high-risk O
users O
. O

The O
payload O
pairs O
several O
comma-separated O
lists O
of O
characters O
with O
comma-separated O
lists O
of O
numbers O
. O

SyLog.bin O
( O
SHA1 O
: O
5689448b4b6260ec9c35f129df8b8f2622c66a45 B-hash
, O
encrypted O
backdoor O
) O

Replace O
or O
modify O
services O
so O
that O
all O
user O
credentials O
are O
passed O
through O
an O
encrypted O
channel O
. O

This O
effectively O
means O
that O
the O
malware O
writer O
mistakenly O
coded O
the O
bot O
to O
save O
user O
information O
into O
the O
wrong O
file O
. O

Unloads O
ZxShell B-malware.backdoor
and O
deletes O
all O
of O
the O
active O
components O
. O

The O
dropper O
has O
an O
embedded O
DLL O
that O
is O
decompressed O
to O
the O
windows O
system32 O
directory O
. O

This O
handle O
is O
then O
used O
in O
the O
keyboard O
hook O
procedure O
. O

In O
order O
to O
evade O
forensics O
, O
the O
fi O
le-time O
of O
the O
dropped O
DLL O
will O
be O
modifi O
ed O
to O
match O
that O
of O
an O
existing O
system O
DLL O
( O
user32.dll O
, O
etc O
) O
. O

Audit O
existing O
firewall O
rules O
and O
close O
all O
ports O
that O
are O
not O
explicitly O
needed O
for O
business O
. O

f9a669d22866cd041e2d520c5eb093188962bea8864fdfd0c0abb2b254e9f197 B-hash

You O
might O
ask O
, O
why O
conduct O
Flash B-malware.backdoor
exploitation O
within O
Microsoft O
Office O
? O

It O
also O
collects O
locally-stored O
stolen O
data O
and O
uploads O
it O
to O
Dropbox O
. O

Skilled O
hackers O
with O
substantial O
financial O
resources O
carried O
out O
Operation O
BugDrop O
. O

Since O
our O
last O
post O
there O
have O
been O
several O
alterations O
to O
the O
ScanBox B-malware.infosteal
code O
base O
, O
including O
new O
modules O
, O
changes O
to O
avoid O
signature O
based O
detection O
, O
as O
well O
as O
extra O
techniques O
to O
try O
to O
identify O
whether O
those O
being O
scanned O
are O
real O
machines O
or O
researchers O
. O

This O
DLL O
also O
contains O
the O
basic O
export O
functions O
of O
DllRegisterServer O
and O
DllUnregisterServer O
. O

In O
more O
recent O
activity O
, O
these O
spear-phishing O
attacks O
are O
now O
a O
two-stage O
process O
. O

1 O
. O

The O
traditional O
approach O
relies O
on O
the O
principles O
of O
segregation O
for O
both O
communication O
infrastructures O
and O
control O
strategies O
. O

The O

Kaspersky O
products O
detect O
flash O
exploit O
as O
HEUR:Exploit.SWF.Agent.gen B-malware.infosteal
also O
our O
AEP O
( O
Automatic O
Exploit O
Prevention O
) O
component O
can O
successfully O
detect O
this O
attack O
. O

In O
most O
cases O
that O
we O
have O
observed O
, O
the O
group O
performed O
tasks O
related O
to O
searching O
for O
vulnerabilities O
, O
gaining O
persistence O
on O
various O
hosts O
, O
and O
stealing O
authentication O
data O
. O

case O
' O
u O
' O
: O

Server O
Uranio6 O

An O
attacker O
may O
exploit O
this O
issue O
to O
execute O
remote O
code O
. O

T O
ur O
ke O
y O
T O
ur O
ke O
y O
Gr O
e O
e O
ce O
Gr O
e O
e O
ce O
US O
AUS O
A O

Curiously O
, O
the O
sites O
scanned O
included O
a O
web O
developer O
's O
website O
, O
kashey.ru O
, O
and O
resources O
links O
to O
which O
were O
found O
on O
this O
site O
. O

The O
targets O
almost O
perfectly O
fall O
into O
their O
sphere O
of O
interest O
. O

By O
using O
this O
name O
, O
the O
intention O
was O
to O
disguise O
itself O
as O
the O
Windows O
thumbnail O
cache O
. O

Web O
. O

The O
new O
campaign O
marks O
the O
first O
APT12 O
activity O
publicly O
reported O
since O
Arbor O
Networks O
released O
their O
blog O
' O
Illuminating O
The O
Etumbot B-malware.backdoor
APT O
Backdoor O
. O
' O

One O
example O
of O
the O
conflict O
between O
ideology O
and O
skill O
was O
Mohammad O
Hussein O
Tajik O
, O
a O
former O
cyber O
commander O
within O
the O
IRGC O
. O

Any O
dynamic O
DNS O
domains O
that O
resolve O
to O
non-routable O
IP O
addresses O
, O
like O
127.0.0.1 B-ip.unknown
or O
private O
IP O
addresses O
, O
should O
be O
thoroughly O
investigated O
. O

The O
domain O
download-mgrwin[.]com B-url.cncsvr
which O
shared O
the O
IP O
81.4.125.90 B-ip.unknown
with O
techto-earth[.]com B-url.cncsvr
was O
also O
found O
to O
host O
similar O
malware O
: O
hxxp://download-mgrwin[.]com/southside/download1/stisvc.exe B-url.cncsvr
md5 O
6ec82e9eccb9bee050c9f7f2750d0c7c B-hash
hxxp://download-mgrwin[.]com/southside/download1/sppsvc.exe B-url.cncsvr
md5 O
acfada8e91eda6cca2da66bbb032d924 B-hash
hxxp://download-mgrwin[.]com/eastside/download/sppsvc.exe B-url.cncsvr
md5 O
6dc9eee24f8d5cba1ca3919b87507d86 B-hash
Domain O
registration O
information O
is O
useful O
for O
connecting O
cases O
. O

Country O
Sector/Target O

The O
locations O
of O
Inception B-malware.backdoor
's O
targets O
have O
shifted O
since O
2014 O
, O
but O
the O
group O
continues O
to O
have O
a O
global O
reach O
. O

This O
payload O
DLL O
has O
the O
filename O
and O
is O
named O
after O
IEC O
101 O
( O
aka O

The O
Mevade B-malware.unknown
C O
& O
C O
name O
styles O
as O
well O
as O
some O
other O
technical O
similarities O
indicated O
a O
connection O
to O
RedOctober B-malware.unknown
, O
but O
the O
link O
was O
weak O
. O

Common O
directory O
names O
: O
system O
, O
current O
, O
temporary O
directories O
. O

The O
information O
stealer O
was O
capable O
of O
stealing O
the O
contents O
of O
the O
clipboard O
, O
taking O
screenshots O
, O
recording O
keystrokes O
and O
stealing O
 les O
and O
user O
credentials O
. O

With O
rare O
exceptions O
, O
the O
group O
's O
members O
get O
by O
with O
publicly O
available O
tools O
. O

This O
new O
ransomware O
was O
detected O
by O
ESET O
products O
as O
Win32/Filecoder.NKH O
. O

Our O
analysts O
compared O
sample O
module O
2 O
and O
relevant O
files O
of O
Beacon O
, O
and O
found O
that O
the O
disassembling O
commands O
between O
them O
are O
exactly O
the O
same O
with O
exception O
of O
functionality O
code O
, O
including O
XOR O
encryption O
at O
the O
entry O
, O
downloading O
system O
DLL O
, O
obtaining O
function O
address O
, O
function O
calling O
modes O
and O
so O
on O
. O

XtremeRAT B-malware.backdoor
controller O
connection O
settings O
In O
the O
Figure O
5 O
, O
the O
attacker O
specified O
custom O
CnC O
servers O
and O
ports O
and O
changed O
the O
default O
password O
to O
' O
1411 O
' O
. O

T O
he O
following O
malicious O
php O
files O
were O
found O
in O
different O
directories O
in O
the O
nginx O
folder O
and O
in O
a O
working O
directory O
created O
by O
the O
attackers O
on O
an O
infected O
web O
servers O
: O

Next O
, O
the O
Execute O
( O
) O
function O
will O
execute O
any O
value O
returned O
by O
the O
lookup O
. O

© O
AhnLab O
, O
Inc O
. O

TREND O
MICRO O
LEGAL O
DISCLAIMERThe O
information O
provided O
herein O
is O
for O
general O
information O
and O
educational O
purposes O
only O
. O

Their O
tradecraft O
is O
superb O
, O
operational O
security O
second O
to O
none O
and O
the O
extensive O
usage O
of O
' O
living-off-the-land O
' O
techniques O
enables O
them O
to O
easily O
bypass O
many O
security O
solutions O
they O
encounter O
. O

The O
sample O
we O
analyzed O
is O
99 O
% O
similar O
to O
the O
documented O
Bankshot O
variants O
from O
2017. O
spyware O
on O
victims O
' O
mobile O
devices O
by O
uploading O
maliciou O
... O
https://t.co/Ho6RhSKo5Emcafee_labs O
Operation O
GhostSecret O
used O
multiple O
# O
malware O
implants O
, O
including O
an O
unknown O
impact O
with O
capabilities O
similar O
to O
Ban O
... O
https://t.co/20oXNJnL9LBankshot O
implants O
hosted O
on O
falcancoin.io O
. O

Figure O
10 O
- O
Response O
from O
the O
C2C O

The O
open-source O
cURL O
library O
is O
a O
multiprotocol O
transfer O
library O
used O
primarily O
for O
FTP O
and O
HTTP O
transactions O
. O

The O
banner O
describes O
the O
botnet B-malware.ransom
: O
its O
technical O
features O
the O
available O
commands O
( O
classic O
ones O
, O
such O
as O
visiting O
a O
website O
using O
the O
infected O
bot O
, O
download O
and O
execute O
a O
command O
or O
a O
library O
, O
update O
and O
uninstall O
) O
the O
plugins O
one O
can O
use O
: O
file O
stealer O
, O
ad-clicker O
, O
form O
grabber O
, O
... O
The O
command O
' O
visiting O
a O
website O
' O
using O
the O
infected O
bot O
could O
be O
used O
by O
the O
attackers O
as O
an O
entry O
point O
for O
blackmailing O
the O
infected O
user O
. O

For O
specific O
country O
offices O
and O
contact O
numbers O
, O
please O
visit O
our O
website O
. O

This O
version O
was O
called O
' O
CT O
V2.1 O
' O
by O
the O
author O
, O
which O
may O
indicate O
that O
there O
were O
other O
earlier O
versions O
of O
this O
RAT O
and O
that O
it O
was O
improved O
upon O
incrementally O
. O

This O
is O
significant O
given O
the O
transfers O
are O
believed O
to O
have O
occurred O
in O
the O
two O
days O
prior O
to O
this O
date O
. O

9d8e5ccd4cf543b4b41e4c6a1caae1409076a26ee74c61c148dffd3ce87d7787 B-hash
4e656834a93ce9c3df40fe9a3ee1efcccc728e7ea997dc2526b216b8fd21cbf6 B-hash

Command O
Description O

첨부 O
문서는 O
행사 O
관련 O
내용으로 O
위장하였으며 O
, O
사용자가 O
파일을 O
열어 O
' O
콘텐츠 O
사용'을 O
클릭해 O
매크로 O
기능을 O
활 O
성화하면 O
악성코드가 O
다운로드된다 O
. O

2f8e5f81a8ca94ec36380272e36a22e326aa40a4 B-hash

A O
server O
housed O
at O
each O
participant O
's O
location O
allows O
each O
to O
exchange O
indicators O
with O
the O
NCCIC O
. O

Web O
. O

Dark O
Seoul O
was O
a O
low O
tech O
threat O
which O
managed O
to O
escalate O
into O
a O
high O
impact O
attack O
. O

getProcessList O

We O
code O
named O
the O
vulnerability O
as O
' O
double O
kill O
' O
exploit O
. O

The O
fourth O
one O
executes O
the O
malware O
. O

Initializes O
the O
module O
used O
for O
communicating O
with O
the O
C O
& O
C O
servers O
( O
called O
) O
and O
establishes O
communication O
between O
the O
malware O
and O
the O
C O
& O
C O
servers O
. O

Whenever O
the O
function O
returns O
, O
it O
calls O
fill_memory_with_random_bytes O
function O
for O
every O
local O
variable O
it O
used O
, O
so O
that O
the O
stack O
is O
cleared O
from O
decoded O
strings O
. O

08 O
– O
Sectors O
per O
cluster O
= O
8 O
F8 O
– O
Media O
descriptor O
( O
Not O
necessary O
for O
our O
application O
) O
C0 O
F8 O
F8 O
0D O
00 O
00 O
00 O
00 O
– O
Total O
sectors O
in O
file O
system O
, O
0x00DF8F8C0 O
= O
234420416 O
Sectors O
( O
Add O
on O
the O
sector O
location O
of O
VBR O
for O
actual O
end O
of O
the O
file O
system O
, O
in O
this O
example O
the O
VBR O
is O
at O
sector O
63 O
therefore O
the O
total O
sectors O
in O
the O
file O
system O
are O
234420416 O
+ O
63 O
= O
234420479 O
) O
00 O
00 O
0C O
00 O
00 O
00 O
00 O
00 O
– O
Starting O
cluster O
of O
the O
MFT O
, O
0X000C0000 O
= O
786432 O
Clusters O
. O

The O
succeeding O
users O
and O
chatrooms O
were O
created O
on O
October O
31 O
and O
December O
12 O
the O
latest O
. O

Continuing O
analysis O
solidified O
the O
headquarters O
component O
's O
Command O
and O
Control O
( O
C2 O
) O
scheme O
. O

EBDD6059DA1ABD97E03D37BA001BAD4AA6BCBABD B-hash
B769FE81996CBF7666F916D741373C9C55C71F15 I-hash
E64C2ED72A146271CCEE9EE904360230B69A2C1D I-hash

Steal O
credentials O
from O
Mozilla O
Firefox O
3 O
. O

The O
report O
also O
includes O
the O
findings O
of O
an O
analysis O
of O
several O
webservers O
compromised O
by O
the O
Energetic O
Bear O
group O
during O
2016 O
and O
in O
early O
2017.T O
he O
table O
below O
shows O
the O
distribution O
of O
compromised O
servers O
( O
based O
on O
the O
language O
of O
website O
content O
and/or O
the O
origins O
of O
the O
company O
renting O
the O
server O
at O
the O
time O
of O
compromise O
) O
by O
countries O
, O
attacked O
company O
types O
and O
the O
role O
of O
each O
server O
in O
the O
overall O
attack O
scheme O
. O

The O
main O
new O
feature O
is O
the O
obfuscation O
– O
almost O
all O
strings O
are O
obfuscated O
and O
the O
XML O
pattern O
is O
not O
written O
in O
plain O
text O
anymore O
. O

Control O
with O
caution O
and O
let O
the O
code O
Execute O
function O
ntdll O
! O
ZwContinue O
. O

Rifdoor B-malware.backdoor
변형은 O
2015년 O
서울 O
아덱스 O
( O
SEOUL O
ADEX O
) O
참가 O
업체 O
공격에 O
사용되었으며 O
, O
2016년 O
초 O
보안 O
업체 O
해킹에도 O
사용되었다 O
. O

Fears O
of O
proliferation O

Dropper O
Observables O

Attackers O
are O
starting O
to O
invest O
in O
longterm O
operations O
that O
target O
specific O
processes O
enterprises O
rely O
on O
. O

case O
' O
j O
' O
: O

Figure O
4 O
- O
Installed O
Files O
from O
the O
Cisco O
AnyConnect O
Software O
Install O
Figure O
5 O
- O
Execution O
of O
Cisco O
binary O
vpnui.exe O
( O
MD5 O
: O
68F1419721354EC1f78A71E10B54FCA8 B-hash
) O
The O
attacker O
's O
use O
of O
decoy O
software O
is O
the O
same O
as O
when O
a O
threat O
actor O
will O
decide O
to O
display O
a O
decoy O
PFD O
or O
Office O
Document O
, O
to O
give O
the O
victim O
a O
sense O
that O
everything O
is O
fine O
and O
that O
there O
is O
no O
need O
to O
inform O
the O
IT O
or O
the O
Security O
team O
for O
investigation O
. O

systemd O
Vulnerability O
Leads O
to O
Denial O
of O
Service O
on O
Linux O
qkG O
Filecoder O
: O
Self-Replicating O
, O
Document-Encrypting O
Ransomware O
Mitigating O
CVE-2017-5689 O
, O
an O
Intel O
Management O
Engine O
Vulnerability O
A O
Closer O
Look O
at O
North O
Korea O
's O
Internet O
From O
Cybercrime O
to O
Cyberpropaganda O

And O
much O
of O
the O
malware O
being O
deployed O
by O
Sofacy O
is O
quickly O
changed O
from O
C/C++ O
to O
.Net O
to O
powershell O
. O

However O
, O
the O
fact O
there O
are O
still O
unanswered O
questions O
about O
The O
Fidelis O
XPS O
advanced O
threat O
defense O
system O
has O
been O
updated O
with O
rules O
to O
detect O
various O
the O
components O
of O
the O
malware O
system O
and O
its O
intended O
targeting O
, O
emphasizes O
the O
importance O
of O
employing O
that O
best O
practices O
such O
as O
denying O
use O
of O
removable O
media O
on O
sensitive O
systems O
and O
disabling O
autorun O
! O

The O
pause O
and O
retooling O
by O
APT12 O
was O
covered O
in O
the O
Mandiant O
2014 O
M-Trends O
report O
. O

There O
are O
numerous O
benefits O
of O
leveraging O
a O
zero-day O
exploit O
against O
a O
target O
( O
Figure O
5 O
) O
. O

Unlike O
other O
*.dll.mui O
files O
in O
% O
SYSTEM O
% O
\en-US O
directory O
that O
are O
MZ O
files O
, O
the O
encrypted O
payload O
is O
not O
an O
MZ O
file O
. O

Version O
: O
1.2 O
WIDESTR O

Started O
: O
5523F782 O
QWORD O

Translation O
accuracy O
is O
not O
guaranteed O
nor O
implied O
. O

At O
DNC O
, O
COZY O
BEAR O
intrusion O
has O
been O
identified O
going O
back O
to O
summer O
of O
2015 O
, O
while O
FANCY O
BEAR O
separately O
breached O
the O
network O
in O
April O
2016 O
. O

z1=cmdz2=cd O
/d O
' O
c O
: O
\inetpub\wwwroot\ O
' O
& O
whoami O
& O
echo O
[ O
S O
] O
& O
cd O
& O
echo O
[ O
E O
] O

While O
Patchwork O
may O
be O
more O
straightforward O
with O
its O
predominantly O
malware-based O
attacks O
, O
Confucius O
' O
can O
be O
inferred O
to O
be O
more O
nuanced O
, O
relying O
heavily O
on O
social O
engineering O
. O

The O
U.S. O
Government O
confirms O
that O
two O
different O
RIS O
actors O
participated O
in O
the O
intrusion O
into O
a O
U.S. O
political O
party O
. O

In O
this O
post O
, O
we O
examine O
a O
publicly O
available O
RAT B-malware.backdoor
known O
as O
XtremeRAT B-malware.backdoor
. O

The O
newer O
SPLM B-malware.backdoor
modules O
are O
deployed O
mostly O
to O
Central O
Asian O
based O
targets O
that O
may O
have O
a O
tie O
to O
NATO O
in O
some O
form O
. O

In O
our O
case O
, O
a O
malicious O
VBS O
was O
executed O
, O
which O
installs O
a O
next O
stage O
payload O
stored O
in O
CAB O
file O
: O

Have O
you O
been O
able O
to O
sinkhole O
any O
of O
the O
command O
and O
controls O
? O

SHA256 O
: O

Considering O
how O
many O
features O
China B-malware.backdoor
Chopper I-malware.backdoor
offers O
, O
it O
is O
incredibly O
small—just O
73 O
bytes O
for O
the O
ASPX O
version O
, O
or O
4 O
kilobytes O
on O
disk O
( O
see O
Figure O
14 O
) O
. O

case O
' O
n O
' O
: O

중앙관리 O
솔루션 O
........................................................................................................................................................ O
7 O
4 O
. O

These O
include O
domains O
, O
file O
names O
, O
Java O
package O
names O
, O
and O
Facebook O
activity O
. O

This O
indicates O
that O
the O
implant O
was O
active O
in O
South O
Korea O
and O
targets O
were O
likely O
being O
infected O
. O

또한 O
vs1.vbs B-malware.drop
, O
winrm.vbs B-malware.drop
등의 O
VB O
스 O
크립트 O
파일을 O
생성해 O
악성 O
파일을 O
다운로드한다 O
. O

Further O
investigation O
shows O
that O
the O
same O
registrant O
email O
id O
was O
also O
used O
to O
register O
another O
similar O
domain O

User O
Interaction O
Required O
Description O

Number O
of O
object O
files O
, O
Red O
October O
Office O
plugin O

This O
type O
of O
obfuscation O
is O
used O
by O
those O
that O
have O
' O
strong O
motives O
to O
prevent O
their O
malware O
from O
being O
analyzed O
' O
. O

The O
result O
is O
the O
following O
assembly O
listing O
: O

Contact O
us O
| O
Privacy O
Policy O
| O
Lice O
nse O
Agre O
e O
me O
nt O

During O
investigation O
into O
the O
infrastructure O
used O
by O
Ghost O
Dragon O
, O
an O
anonymous O
FTP O
server O
was O
discovered O
on O
one O
of O
the O
IP O
addresses O
listed O
above O
, O
which O
hosted O
' O
info.winupdate[.]net B-url.cncsvr
| O
122.10.36.94 B-ip.unknown
' O
. O

This O
would O
explain O
the O
inclusion O
of O
the O
.NET O
wrapper O
. O

The O
information O
included O
in O
the O
report O
indicated O
that O
the O
perpetrators O
used O
the O
same O
malware O
, O
overlapping O
infrastructure O
, O
and O
similar O
targets O
as O
APT32 B-malware.infosteal
. O

It O
is O
likely O
that O
targeted O
attacks O
using O
Asruex B-malware.drop
will O
continue O
. O

The O
Darkhotel B-malware.infosteal
APT I-malware.infosteal
continues O
to O
spearphish O
targets O
around O
the O
world O
, O
with O
a O
wider O
geographic O
reach O
than O
its O
previous O
botnet O
buildout O
and O
hotel O
Wi-Fi O
attacks O
. O

The O
Tofu B-malware.backdoor
backdoor O
makes O
extensive O
use O
of O
threading O
to O
perform O
individual O
tasks O
within O
the O
code O
. O

FTPManager O
: O
used O
to O
upload O
file O
to O
the O
server O
using O
credentials O
received O
in O
a O
previous O
command O
from O
the O
C O
& O
C O
server O
. O

The O
attacker O
can O
manipulate O
the O
process O
into O
an O
unsafe O
state O
from O
the O
DCS O
while O
preventing O
the O
SIS O
from O
functioning O
appropriately O
. O

The O
complete O
path O
found O
in O
the O
malware O
presents O
some O
Korean O
strings O
: O
D O
: O
rsh O
UAC_dll O
( O
) O
Releasetest.pdb O
The O
' O
rsh O
' O
word O
, O
by O
all O
appearances O
, O
means O
a O
shortening O
of O
' O
Remote O
Shell O
' O
and O
the O
Korean O
words O
can O
be O
translated O
in O
English O
as O
' O
attack O
' O
and O
' O
completion O
' O
, O
i.e. O
: O
D O
: O
rshATTACKUAC_dll O
( O
COMPLETION O
) O
Releasetest.pdb O
Although O
the O
full O
list O
of O
victims O
remains O
unknown O
, O
we O
managed O
to O
identify O
several O
targets O
of O
this O
campaign O
. O

This O
executable O
is O
a O
data O
stealer O
, O
which O
enumerates O
folders O
and O
harvests O
files O
of O
format O
doc O
, O
xls O
, O
ppt O
, O
pps O
, O
inp O
, O
pdf O
, O
xlsx O
, O
docx O
, O
pptx O
. O

The O
contact O
emails O
and O
contact O
names O
can O
vary O
, O
but O
the O
address O
is O
re-used O
. O

Figure O
8 O
. O

If O
you O
have O
received O
it O
in O
error O
, O
< O
=r O
> O
please O
contact O
us O
immediately O
by O
return O
e-­‐mail O
and O
delete O
it O
from O
your O
system O
. O

roscomnadzor O
Another O
rough O
translation O
from O
Russian O
to O
English O
: O

Detection O
of O
the O
malware O
is O
covered O
in O
detail O
, O
from O
multiple O
aspects O
, O
in O
the O
Detect O
section O
above O
. O

Scheduled O
task O
2 O
: O
Uses O
Javascript O
to O
download O
a O
Cobalt O
Strike O
Beacon O
: O
See O
more O
detailed O
analysis O
of O
the O
malicious O
documents O
in O
our O
Attack O
Life O
Cycle O
section O
. O

3.2 O
FinSpy B-malware.backdoor
Mobile O
in O
Vietnam O

Figure O
1 O
Figure O
2 O
Figure O
3 O
. O

a3d3b0686e7bd13293ad0e63ebec67af B-hash
) O
in O
addition O
to O
..... O
The O
' O
Nflog B-malware.backdoor
' O
implant O
emits O
the O
following O
network O
beacon O
format O
: O

The O
vulnerability O
affects O
the O
latest O
version O
of O
Internet O
Explorer O
and O
applications O
that O
use O
the O
IE O
kernel O
and O
has O
been O
found O
to O
be O
used O
for O
targeted O
APT O
attacks O
. O

The O
high O
number O
of O
payloads O
and O
the O
elaborate O
C2 O
infrastructure O
used O
in O
this O
attack O
can O
be O
indicative O
of O
the O
resources O
that O
the O
attackers O
had O
at O
their O
disposal O
. O

This O
is O
because O
mshta.exe O
does O
n't O
support O
downloading O
URL O
contents O
directly O
to O
an O
arbitrary O
location O
. O

Network O
Detection O
Signatures O

As O
part O
of O
Kaspersky O
Lab O
's O
commitment O
to O
securing O
cyberspace O
for O
everyone O
, O
we O
reached O
out O
and O
notified O
identifiable O
victims O
, O
regardless O
of O
their O
security O
solution O
and O
provided O
them O
with O
indicators O
of O
compromise O
( O
IOCs O
) O
to O
help O
root O
out O
the O
active O
infection O
. O

• O
Based O
on O
our O
source O
's O
conversations O
with O
other O
hackers O
in O
Iran O
, O
there O
are O
over O
50 O
estimated O
contractors O
vying O
for O
Iranian O
government-sponsored O
offensive O
cyber O
projects O
. O

For O
example O
, O
WinRAR O
packs O
and O
encrypts O
files O
with O
strong O
suites O
like O
AES-256 O
, O
and O
TrueCrypt O
encrypts O
full O
hard O
drives O
all O
in O
one O
swoop O
. O

Record O
# O
0 O
Length O
: O
441 O
bytes O
: O

Dino B-malware.backdoor
's O
binary O
is O
statically O
linked O
with O
the O
GnuMP O
library O
, O
which O
is O
used O
to O
manipulate O
big O
numbers O
in O
cryptography O
algorithms O
. O

Outlook B-malware.backdoor
backdoor O
and O
data O
exfiltration O
- O
One O
of O
the O
most O
interesting O
tools O
introduced O
by O
the O
attackers O
was O
the O
Outlook B-malware.backdoor
backdoor O
, O
which O
used O
Outlook O
as O
a O
C2 O
channel O
. O

Hash O
values O
of O
artifacts O
demonstrated O
in O
this O
article O
are O
described O
in O
Appendix B-hash
C. O
Also O
, O
destination O
URLs O
confirmed O
by O
JPCERT/CC O
are O
listed O
in O
Appendix B-url.cncsvr
D I-url.cncsvr
. O

Function O
DecryptCommandBuffer_sub_44C628 O
( O
) O

At O
first O
glance O
, O
it O
seems O
ChessMaster O
's O
evolution O
over O
the O
past O
few O
months O
involves O
subtle O
changes O
. O

When O
visiting O
sites O
and O
downloading O
encryption-enabled O
software O
, O
it O
has O
become O
necessary O
to O
verify O
the O
validity O
of O
the O
distribution O
site O
and O
the O
integrity O
of O
the O
downloaded O
file O
itself O
. O

The O
problem O
with O
publicly O
published O
vulnerabilities O
is O
people O
can O
defend O
against O
them O
. O

The O
use O
of O
the O
X-Agent B-malware.infosteal
implant O
in O
the O
original O
30.apk B-malware.backdoor
application O
appears O
to O
be O
the O
first O
observed O
case O
of O
FANCY O
BEAR O
malware O
developed O
for O
the O
Android O
mobile O
platform O
. O

msseces.exe;msmpeng.exe O
- O
Microsoft O
Security O
Essentials O
and O
Microsoft O
Anti-Malware O
Service O
AVK.exe;AVKTray.exe O
- O
G-Data O
avas.exe O
- O
TrustPort O
AV O
tptray.exe O
- O
Toshiba O
utility O
fsma32.exe;fsorsp.exe O
- O
F-Secure O
econser.exe;escanmon.exe O
- O
Microworld O
Technologies O
eScan O
SrvLoad.exe;PSHost.exe O
- O
Panda O
Software O
egui.exe;ekrn.exe O
- O
ESET O
Smart O
Security O
pctsSvc.exe;pctsGui.exe O
- O
PC O
Tools O
Spyware O
Doctor O
casc.exe;UmxEngine.exe O
- O
CA O
Security O
Center O
cmdagent.exe;cfp.exe O
- O
Comodo O
KVSrvXP.exe;KVMonXP.exe O
- O
Jiangmin O
Antivirus O
nsesvc.exe;CClaw.exe O
- O
Norman O
V3Svc.exe O
- O
Ahnlab O
guardxup O
. O

Figure O
2 O
. O

Victims O
of O
the O
threat O
actor O
's O
attacks O
were O
not O
limited O
to O
industrial O
companies O
. O

This O
function O
will O
either O
bind O
the O
calling O
process O
to O
a O
port O
or O
has O
the O
calling O
process O
connect O
to O
a O
remote O
host O
. O

FireEye O
is O
a O
registered O
trademark O
of O
FireEye O
, O
Inc O
. O

The O
image O
below O
does O
not O
include O
any O
data O
, O
as O
we O
do O
n't O
want O
to O
disclose O
any O
of O
the O
victims O
' O
locations O
, O
but O
shows O
the O
region O
where O
Tempting B-malware.infosteal
Cedar I-malware.infosteal
was O
spread O
the O
most O
: O
Other O
hosts O
with O
this O
common O
name O
are O
easy O
to O
find O
using O
open O
source O
tools O
: O
We O
created O
an O
image O
of O
the O
computer O
infrastructure O
used O
in O
the O
campaign O
: O
It O
is O
always O
difficult O
to O
attribute O
persistent O
threat O
campaigns O
, O
like O
this O
one O
, O
to O
cybercriminals O
. O

Contact O
Us O
: O

8c18852f79f14880ed9bd1d3be2fa48c B-hash
alertmymail[.]com B-url.cncsvr
ddd6b9bef4d37b43484d1a0eab4753c6 B-hash
alertmymail[.]com B-url.cncsvr
99f7cb87a4acbbd2aed2c4e860cd0f5a B-hash
necessaries-documentation[.]com B-url.cncsvr
04af2e8a7a1e934ab2000d701948a657 B-hash
newsfairprocessing[.]com B-url.cncsvr
1f72e19999d56a11cd564d1f7b0652e7 B-hash
2683e1d77b20e7aa75ade640ddb522d6 B-hash
6d6fe7d36e1c43aab534644378d56dfb B-hash
westdelsys[.]com B-url.cncsvr
14a11b125f32a5a5773c23021ac4c1a1 B-hash
manufacturing-minds[.]com B-url.cncsvr
84e2d98e4b3272b953b63d2021735fd3 B-hash
fcccf9cb698297bb686561e7af7dad94 B-hash
servicesprocessing[.]com B-url.cncsvr
f0ef59265610dedab40f8386af79f861 B-hash

As O
always O
, O
attackers O
make O
mistakes O
and O
give O
away O
hints O
about O
what O
providers O
and O
registrars O
they O
prefer O
. O

However O
, O
the O
work O
is O
only O
covering O
small O
aspects O
( O
based O
on O
the O
indicators O
given O
, O
lacking O
full O
context O
) O
and O
not O
an O
exhaustive O
analysis O
, O
and O
hence O
the O
report O
is O
as-is O
, O
not O
giving O
any O
guarantees O
of O
completeness O
or O
claiming O
absolute O
accuracy O
. O

The O
attacks O
can O
be O
dated O
back O
to O
2007 O
and O
are O
still O
very O
active O
. O

A O
176.56.238.177 B-ip.unknown
games-playbox[.]com B-url.cncsvr
. O

Action O

Figure O
6 O
- O
VirusTotal O
score O

Document O
Status O
: O
Last O
Revised O
: O
2014-05-21 O

Launcher O
reloadItSelf O
: O
] O

Sample O
B O
is O
identified O
to O
be O
a O
HTTP O
controlled O
backdoor O
, O
enabling O
the O
attacker O
to O
take O
full O
control O
over O
the O
victim O
computer O
. O

The O
main O
backdoor O
used O
by O
attackers O
was O
the O
open-source O
Tiny B-malware.backdoor
Meterpreter I-malware.backdoor
. O

We O
would O
also O
like O
to O
thank O
our O
friends O
and O
family O
who O
supported O
us O
throughout O
this O
research O
. O

One O
of O
the O
services O
they O
provide O
is O
FinFisher B-malware.infosteal
: O
IT O
Intrusion O
, O
including O
the O
FinSpy B-malware.infosteal
tool O
. O

Given O
Lazarus O
' O
use O
of O
a O
wide O
array O
of O
tools O
and O
techniques O
in O
their O
operations O
, O
it O
's O
reasonable O
to O
assume O
that O
the O
group O
will O
continue O
to O
use O
ever-evolving O
tactics O
in O
their O
malicious O
activities O
. O

I O
got O
a O
letter O
from O
the O
government O
the O
other O
day O
Opened O
it O
and O
read O
it O
It O
said O
they O
were O
suckers O

Ability O
to O
sleep O
for O
a O
given O
number O
of O
seconds O
. O

of O
the O
current O
key O
string O
byte O
. O

Currently O
, O
Iran O
faces O
the O
prospect O
of O
negative O
economic O
impact O
via O
renewed O
sanctions O
. O

hXXp://985.so/bUYjN/A B-url.unknown
( O
HTTP O
404 O
) O
hXXp://985.so/bUYe B-url.unknown
hXXp://58.64.178.77:80/SiteLoader B-url.unknown
hXXp://985.so/b6hW B-url.unknown
hXXp://58.64.178.77/mPlayer B-url.unknown
hXXp://985.so/bUYf B-url.unknown
hXXp://58.64.178.77:80/0wnersh1p B-url.unknown
These O
pages O
load O
scripts O
that O
conduct O
profiling O
of O
the O
system O
for O
various O
software O
, O
plugins O
, O
and O
other O
related O
information O
, O
as O
well O
as O
load O
Java O
exploits O
designed O
to O
install O
malware O
on O
the O
target O
system O
. O

Upon O
adding O
a O
network O
drive O
, O
the O
hook O
calls O
its O
' O
RecordToFile O
' O
file O
stealer O
method O
. O

Backdoors O
exploiting O
DLL O
hijacking O
against O
trusted O
applications O

1 O
. O

The O
analysis O
of O
this O
APT O
proves O
how O
determined O
and O
motivated O
the O
attackers O
were O
. O

Looking O
back O
at O
other O
high O
profile O
cases O
, O
such O
as O
the O
Bangladesh B-malware.unknown
Bank I-malware.unknown
Heist I-malware.unknown
or O
Wannacry B-malware.unknown
, O
there O
were O
few O
facts O
linking O
them O
to O
the O
Lazarus O
group O
. O

Figure O
8 O
. O

The O
RLO O
character O
( O
U+202e O
in O
unicode O
) O
controls O
the O
positioning O
of O
characters O
in O
text O
containing O
characters O
flowing O
from O
right O
to O
left O
, O
such O
as O
Arabic O
or O
Hebrew O
. O

2016 O
. O

The O
attacker O
also O
changed O
the O
default O
process O
mutex O
name O
. O

Ministry O
of O
Unification O

Upon O
receiving O
the O
malicious O
document O
, O
the O
user O
is O
advised O
to O
enable O
macros O
. O

CV.doc O
Complaint O
letter.doc O
License O
Agreement.doc O

T O
HREAT O
S O
CAT O
EGORIES O
T O
AGS O
ENCYCLOPEDIA O
ST O
AT O
IST O
ICS O
DESCRIPT O
IONS O

This O
is O
an O
initial O
request O
that O
the O
backdoor O
would O
send O
out O
on O
port O
443 O
to O
an O
active O
C O
& O
C O
: O
00000000 O
c4 O
4c O
87 O
3f O
11 O
1e O
c4 O
1a O
2c O
a9 O
12 O
1a O
19 O
61 O
82 O
de O
| O
.L O
. O
? O

Implement O
strict O
access O
control O
and O
application O
whitelisting O
on O
any O
server O
or O
workstation O
endpoints O
that O
can O
reach O
the O
SIS O
system O
over O
TCP/IP O
. O

on O
the O
intermediate O
buffer O
and O
a O
global O
string O
to O
produce O
a O
final O
buffer O
; O
3 O
. O

' O
x- O
' O
: O
a O
) O
+ O
Math.floor O
( O
Math.random O
( O
) O
* O
99999 O
) O
\ O
; O
) O
' O
; O
flow O
: O
established O
, O
from_server O
; O
file_data O
; O
content O
: O
' O
return O
( O
( O
! O
a O
) O
? O

In O
case O
of O
Uri O
Terror O
Report.doc O
the O
malicious O
activity O
triggered O
when O
the O
document O
was O
either O
closed O
or O
when O
the O
show O
document O
button O
was O
clicked O
, O
when O
any O
of O
these O
event O
occurs O
a O
malicious O
obfuscated O
function O

Siemens O
Product O
Computer O
Emergency O
Readiness O
Team O
( O
ProductCERT O
) O
confirmed O
that O
IRONGATE B-malware.backdoor
is O
not O
viable O
against O
operational O
Siemens O
control O
systems O
and O
determined O
that O
IRONGATE B-malware.backdoor
does O
not O
exploit O
any O
vulnerabilities O
in O
Siemens O
products O
. O

Example O
Internal O
Beacon O
: O

The O
targets O
are O
companies O
in O
energy O
and O
utilities O
, O
telecommunications O
, O
public O
relations O
, O
media O
, O
financial O
institutions O
, O
governmental O
institutions O
, O
services O
in O
general O
and O
manufacturing O
. O

This O
influence O
campaign O
- O
a O
combination O
of O
network O
compromises O
and O
subsequent O
data O
leaks O
- O
aligns O
closely O
with O
the O
Russian O
military O
's O
publicly O
stated O
intentions O
and O
capabilities O
. O

A O
pro-government O
group O
calling O
itself O
the O
Syrian O
Electronic O
Army O
has O
gained O
visibility O
in O
recent O
months O
with O
high O
profile O
attacks O
against O
news O
organizations O
. O

© O
AhnLab O
, O
Inc O
. O

Log O
lines O
written O
for O
stolen O
data O
from O
browsers O
and O
the O
MSN O
messenger O
are O
built O
by O
the O
format O
string O
' O
% O
s O
% O
c O
% O
s O
| O
% O
s\n O
' O
, O
where O
the O
first O
string O
is O
likely O
participant1 O
of O
a O
conversation O
, O
the O
second O
string O
participant2 O
. O

We O
consider O
it O
likely O
that O
other O
attacks O
have O
been O
modeled O
the O
same O
way O
, O
using O
attachments O
in O
email O
. O

The O
application O
supports O
the O
following O
command-line O
options O
: O
runexe O
1.exe O
/c O
command O
... O
rundll O
1.dll O
, O
DllMain O
When O
attempting O
to O
find O
more O
information O
about O
this O
application O
, O
iDefense O
discovered O
a O
file O
with O
the O
MD5 O
hash O
cfa7954722d4277d26e96edc3289a4ce B-hash
, O
which O
features O
the O
same O
application O
and O
was O
mentioned O
in O
a O
2015 O
report O
titled O
Operation O
Lotus O
Blossom O
by O
the O
Unit42 O
team O
at O
partner O
organization O
Palo O
Alto O
Networks O
. O

They O
apparently O
do O
not O
target O
Israelis O
. O

We O
came O
to O
the O
conclusion O
that O
there O
could O
be O
other O
driver O
files O
similar O
to O
the O
' O
reference O
' O
file O
mrxcls.sys O
, O
which O
are O
not O
among O
known O
variants O
of O
Stuxnet B-malware.backdoor
. O

Both O
backdoors O
were O
dropped O
from O
malicious O
documents O
built O
utilizing O
the O
' O
Tran B-malware.backdoor
Duy I-malware.backdoor
Linh I-malware.backdoor
' O
exploit O
kit O
, O
which O
exploited O
CVE-2012-0158 B-malware.backdoor
. O

For O
a O
list O
of O
services O
, O
visit O
https://www.us-cert.gov/ccubedvp B-url.normal
. O

Carrying O
on O
the O
reverse O
engineering O
of O
the O
malware O
, O
we O
found O
a O
file O
called O
' O
config.json O
' O
which O
is O
a O
base64 O
encoded O
json O
file O
containing O
the O
configuration O
of O
the O
malware O
and O
its O
Command O
and O
Control O
( O
C2 O
) O
. O

GetLogicalDriveStringW O
function O
Creates O
directory O
Deletes O
directory O
Reads O
a O
file O
from O
an O
offset O
Calls O
the O
PE O
Loader O
( O
switch O
to O
HTTPprov O
communication O
) O
[ O
Unknown O
] O
0 O
: O
Query O
a O
value O
from O
the O
registry O
, O
1 O
: O
Drop O
and O
execute O
a O
program O
Sets O
an O
environment O
variable O
Runs O
shellcode O
in O
a O
new O
thread O
Retrieves O
an O
environment O
variable O
Restarts O
itself O
if O
the O
' O
APPL O
' O
environment O
variable O
does O
n't O
exist O

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Service O

Major O
cyber O
attacks O
in O
the O
past O
such O
as O
Ten O
Days O
of O
Rain O
and O
the O
SK O
Communications O
breach O
employed O
far O
more O
advanced O
techniques O
compared O
to O
Dark O
Seoul O
. O

Spearphish O
attachments O
md5 O
: O
5c74db6f755555ea99b51e1c68e796f9 B-hash
c3ae70b3012cc9b5c9ceb060a251715a B-hash
560d68c31980c26d2adab7406b61c651 B-hash
da0717899e3ccc1ba0e8d32774566219 B-hash
d965a5b3548047da27b503029440e77f B-hash
dc0de14d9d36d13a6c8a34b2c583e70a B-hash
39562e410bc3fb5a30aca8162b20bdd0 B-hash
( O
first O
seen O
late O
2014 O
, O
used O
into O
2015 O
) O
e85e0365b6f77cc2e9862f987b152a89 B-hash
( O
first O
seen O
late O
2014 O
, O
used O
into O
2015 O
) O

Once O
exploited O
, O
the O
only O
artifact O
residing O
on O
the O
victim O
's O
system O
would O
be O
the O
initial O
lure O
document O
that O
only O
contains O
a O
URL O
. O

It O
verifi O
es O
if O
an O
instance O
of O
this O
service O
is O
already O
running O
by O
checking O
if O
a O
global O
instance O
variable O
is O
not O
' O
null O
' O
. O

Our O
private O
reports O
subscription O
customers O
receive O
a O
steady O
stream O
of O
YARA O
, O
IOC O
, O
and O
reports O
on O
Sofacy O
, O
our O
most O
reported O
APT O
for O
the O
year O
. O

Email O
. O

ServiceMain O

As O
a O
result O
, O
the O
latter O
maintains O
a O
listing O
of O
all O
files O
in O
all O
the O
folders O
on O
the O
drive O
. O

Size O
Complie O
Time O
Import O
Hash O
6e59861931fa2796ee107dc27bfdd480 B-hash
75264 O
bytes O
2014-08-23 O
08:22:49 O
ead55ef2b18a80c00786c25211981570 B-hash

In O
the O
analysis O
process O
, O
we O
managed O
to O
retrieve O
the O
malware O
payloads O
hosted O
on O
one O
of O
the O
command O
and O
control O
servers O
along O
with O
some O
statistics O
, O
such O
as O
the O
total O
number O
of O
downloads O
and O
logs O
containing O
the O
targeted O
victims O
. O

mainThread O
calls O
the O
function O
of O
the O
server O
variant O
. O

Here O
is O
the O
PDB O
: O

So O
, O
the O
dropper O
creates O
three O
files O
in O

njRAT B-malware.backdoor
is O
a O
Remote O
Access O
Tool O
( O
RAT O
) O
used O
mostly O
by O
the O
actor O
groups O
in O
the O
middle O
east O
. O

Hold-transactions-pdf.jar O
, O
and O
verification-docx.jar O
The O
' O
INV#94586.jar B-malware.infosteal
' O
malware O
beaconed O
to O
' O
192.95.21[.]44 B-malware.infosteal
' O
over O
port O
' O
1511 O
' O
. O

T O
he O
decrypted O
code O
resolves O
the O
necessary O
API O
functions O
, O
decompresses O
the O
embedded O
PE O
file O
with O
RtlCompressBuffer O
( O
) O
using O
LZNT O
1 O
and O
maps O
it O
into O
memory O
. O

jIRCii O
is O
open O
source O
, O
licensed O
under O
the O
artistic O
license O
. O

In O
addition O
, O
the O
names O
of O
those O
modules O
are O
taken O
from O
the O
popular O
sitcom O
, O
' O
The O
Big O
Bang O
Theory O
' O
, O
in O
addition O
to O
actors O
' O
names O
from O
the O
popular O
Turkish O
TV O
series O
' O
Resurrection O
: O
Ertugrul O
' O
( O
Celal O
Al O
, O
Sonmez O
and O
Gokhan O
) O
. O

Variations O
on O
the O
framework O

If O
the O
client O
's O
request O
does O
not O
meet O
the O
appropriate O
authentication O
criteria O
, O
the O
server O
variant O
sends O
: O

Who O
is O
moayy2ad@hotmail.com B-url.normal

Once O
the O
macro O
is O
enabled O
, O
it O
will O
use O
the O
event O
to O
automatically O
execute O
the O
malicious O
routine O
if O
either O
a O
new O
document O
using O
the O
same O
template O
is O
opened O
or O
when O
the O
template O
itself O
is O
opened O
as O
a O
document0 O
. O

Unlike O
the O
infamous O
WannaCryptor B-malware.ransom
malware O
, O
the O
EternalBlue B-malware.unknown
exploit O
is O
used O
by O
Diskcoder.C O
only O
against O
computers O
within O
the O
local O
network O
address O
space O
. O

( O
Note O
: O
we O
believe O
many O
of O
these O
to O
be O
borrowed O
from O
legitimate O
files O
) O
agent_wininet_dl.exe O
• O
amdh264enc32.bin O
• O
amdh264enc32.dll O
• O
amdhcp32.dll O
• O
amdhdl32.dll O
• O
amdmftdecoder_32.dll O
• O
amdmftvideodecoder_32.bin O
• O
amdmftvideodecoder_32.dll O
• O
amdmiracast.dll O
• O
amdocl_as32.exe O
• O
amdocl.bin O
• O
amdocl_ld32.exe O
• O
amd_opencl32.dll O
• O
amdpcom32.bin O
• O
atiadlxx.bin O
• O
atiadlxx.dll O
• O
atiapfxx.exe O
• O
atibtmon.exe O
• O
aticalcl.dll O
• O
aticaldd.dll O
• O
aticalrt.dll O
• O
aticfx32.bin O
• O
aticfx32.dll O
• O
atidemgy.bin O
• O
atidxx32.bin O
• O
atidxx32.dll O
• O
atieclxx.exe O
• O
atiesrxx.exe O
• O
atiglpxx.dll O
• O
atiicdxx.dat O
• O
atikmdag.sys O
• O
atimuixx.dll O
• O
atiodcli.exe O
• O
atiode.exe O
• O
atioglxx.bin O
• O
atisamu32.dll O
• O
atiu9pag.bin O
• O
atiuxpag.dll O
• O
ativce02.dat O
• O
ativvaxy_cik.dat O
• O
ativvaxy_cik_nd.dat O
• O
ativvsva.dat O
• O
ativvsvl.dat O
• O
autorun.dll O
• O
autorun_com.dll O
• O
autorun_curver.dll O
• O
clinfo.exe O
• O
coinst_13.152.dll O
• O
observers.dll O
• O
ovdecode.dll O
• O
wininetp.dll O

As O
an O
additional O
control O
measure O
, O
the O
program O
was O
only O
activated O
for O
use O
after O
the O
developer O
was O
contacted O
and O
issued O
a O
code O
to O
the O
individual O
downloading O
the O
application O
. O

DIGITAL O
DNA O
SEQUENCE O
FOR O
AURORA B-malware.infosteal
MALWARE O

File-based O
protection O

The O
JavaScript O
based O
attack O
vector O
associated O
with O
Operation B-malware.infosteal
Aurora I-malware.infosteal
was O
published O
in O
the O
public O
domain O
in O
early O
January O
2010 O
. O

Whereas O
previous O
attacks O
have O
been O
attributed O
and O
analyzed O
only O
after O
they O
have O
run O
their O
course O
, O
this O
was O
the O
first O
and O
only O
known O
Sofacy B-malware.backdoor
attack O
to O
be O
discovered O
, O
identified O
, O
and O
reported O
– O
all O
before O
it O
could O
even O
begin O
! O

3baaf1a873304d2d607dbedf47d3e2b4 B-hash
3195202066f026de3abfe2f966c9b304 B-hash
4839370628678f0afe3e6875af010839 B-hash
173c1528dc6364c44e887a6c9bd3e07c B-hash
191d2da5da0e37a3bb3cbca830a405ff B-hash
5eef25dc875cfcb441b993f7de8c9805 B-hash
b20c5db37bda0db8eb1af8fc6e51e703 B-hash
face9e96058d8fe9750d26dd1dd35876 B-hash
9f7faf77b1a2918ddf6b1ef344ae199d B-hash
d0af6b8bdc4766d1393722d2e67a657b B-hash
45448a53ec3db51818f57396be41f34f B-hash
80cba157c1cd8ea205007ce7b64e0c2a B-hash
f68fa3d8886ef77e623e5d94e7db7e6c B-hash
4a1ac739cd2ca21ad656eaade01a3182 B-hash
4ea3958f941de606a1ffc527eec6963f B-hash
637e0c6d18b4238ca3f85bcaec191291 B-hash
b3caca978b75badffd965a88e08246b0 B-hash
dbedadc1663abff34ea4bdc3a4e03f70 B-hash
3ae894917b1d8e4833688571a0573de4 B-hash
8a85bd84c4d779bf62ff257d1d5ab88b O
d94f7a8e6b5d7fc239690a7e65ec1778 B-hash
f1389f2151dc35f05901aba4e5e473c7 B-hash
96280f3f9fd8bdbe60a23fa621b85ab6 B-hash
f25c6f40340fcde742018012ea9451e0 O
122c523a383034a5baef2362cad53d57 B-hash
2173bbaea113e0c01722ff8bc2950b28 B-hash
2a0b18fa0887bb014a344dc336ccdc8c O
ffad0446f46d985660ce1337c9d5eaa2 B-hash
81b484d3c5c347dc94e611bae3a636a3 B-hash
ab73b1395938c48d62b7eeb5c9f3409d B-hash
69930320259ea525844d910a58285e15 B-hash

This O
report O
documents O
the O
first O
ever O
operation O
to O
use O
threat O
intelligence O
and O
adversary O
tactics O
to O
discover O
and O
reveal O
the O
prepositioning O
of O
Sofacy B-malware.backdoor
zero-day O
malware O
. O

Decoded O
' O
i O
' O
Value O
: O
Compile O
Time O
: O
Dropper O
Filename O
: O
Dropper O
MD5 O
: O
DLL O
Filename O
: O
Mutex O
: O
C O
& O
C O
Host O
: O
Decoded O
' O
i O
' O
Value O
: O
Compile O
Time O
: O
Dropper O
Filename O
: O
Dropper O
MD5 O
: O
DLL O
Filename O
: O
Mutex O
: O
C O
& O
C O
Host O
: O
Decoded O
' O
i O
' O
Value O
: O
Compile O
Time O
: O
Dropper O
Filename O
: O
Dropper O
MD5 O
: O
DLL O
Filename O
: O
Mutex O
: O
C O
& O
C O
Host O
: O
Decoded O
' O
i O
' O
Value O
: O
Compile O
Time O
: O
Dropper O
Filename O
: O
Dropper O
MD5 O
: O
DLL O
Filename O
: O
Mutex O
: O
C O
& O
C O
Host O
: O
Decoded O
' O
i O
' O
Value O
: O
Compile O
Time O
: O
Dropper O
Filename O
: O

In O
addition O
to O
using O
compromised O
servers O
to O
scan O
numerous O
resources O
, O
other O
attacker O
activity O
was O
also O
identified O
. O

Here O
's O
a O
list O
for O
some O
ZxShell B-malware.backdoor
functions O
for O
sample O
SHA256 O
: O
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c B-hash
: O

' O
Pending O
' O
, O
only O
if O
the O
command O
string O
matches O
with O
string O
' O
Pending O
' O
the O
download O
functionality O
is O
triggered O
. O

These O
accounts O
were O
used O
to O
advertise O
fake O
' O
blockchain O
exploit O
tool O
' O
, O
which O
infects O
the O
victim O
's O
machine O
with O
Cobalt O
Strike O
, O
using O
a O
similar O
VBScript O
to O
the O
one O
found O
by O
Malwrologist O
( O
ps5.sct O
) O
. O

http://apple-iclods.org/close/?itwm=LO6iN-PjpD0U8AVlLo_Hk3X9FSgAF B-url.cncsvr
& O
xzxI4=9_qwCS03APJT O
HTTP/1.1 O
Host O
: O
apple B-url.cncsvr
-iclods.org I-url.cncsvr
Pragma O
: O
no O
-cache O
Connection O
: O
keep O
-alive O
Accept O
: O
*/* O

To O
capture O
video O
, O
EvilGrab B-malware.drop
creates O
a O
capture O
window O
with O
the O
class O
name O
of O
ESET O
. O

This O
campaign O
is O
not O
the O
first O
sign O
of O
life O
from O
these O
actors O
after O
we O
published O
our O
report O
– O
there O
have O
been O
several O
smaller O
initiatives O
during O
the O
autumn O
of O
2013 O
. O

The O
Darkhotel B-malware.infosteal
APT I-malware.infosteal
will O
relentlessly O
spearphish O
specific O
targets O
in O
order O
to O
successfully O
compromise O
systems O
. O

whenever O
the O
malware O
made O
a O
C2 O
connection O
. O

case O
' O
p O
' O
: O

$ O
writelogs O
= O
false O
; O
//true O
to O
create O
logs O
file O
in O
logs O
directory O
$ O
version O
= O
3 O
; O
$ O
get_varname_user O
= O
' O
user O
' O
; O
$ O
get_varname_id O
= O
' O
id O
' O
; O
$ O
get_varname_seq O
= O
' O
seq O
' O
; O
$ O
storefile O
= O
' O
storage/file O
' O
; O
$ O
ext O
= O
' O
.kv O
' O
; O
$ O
maxsize O
= O
1024*1024*2 O
; O
//0 O
= O
unlimited O
size O
if O
we O
choose O
predifined O
files O
$ O
UOK_V3 O
= O
0x7345d346 O
; O
function O
disableCache O
( O
) O
{ O
$ O
expires O
= O
0 O
; O
$ O
gm_expires O
= O
gmdate O
( O
'D O
, O
dMYH O
: O
i O
: O
s O
' O
, O
time O
( O
) O
+ O
$ O
expires O
) O
; O
header O
( O
' O
Cache-control O
: O
private O
, O
max-age= O
$ O
expires O
, O
pre-check= O
$ O
expires O
' O
) O
; O
header O
( O
' O
Expires O
: O
$ O
gm_expires O
GMT O
' O
) O
; O
header O
( O
' O
Last-Modified O
: O
' O
. O

Specifically O
we O
found O
that O
the O
malware O
utilized O
the O
following O
techniques O
: O
Different O
types O
of O
XOR O
techniques O
to O
obfuscate O
components O
and O
its O
contained O
strings O
The O
use O
of O
trusted O
security O
software O
as O
a O
decoy O
during O
initial O
infection O
Sandbox O
detection O
A O
mangled O
MZ O
header O
to O
deceive O
security O
products O
String O
Stacking O
obfuscation O
with O
Unicode O
Strings O
More O
than O
one O
layer O
of O
obfuscation O
for O
its O
command O
and O
control O
traffic O
Un-Install O
functionality O
A7BD555866AE1C161F78630A638850E7 B-hash
Initial O
Launcher/Dropper O
2F7E5F91BE1F5BE2B2F4FDA0910A4C16 B-hash
4F4BF27B738FF8F2A89D1BC487B054A8 B-hash
75D3D1F23628122A64A2F1B7EF33F5CF B-hash
68F1419721354EC1f78A71E10B54FCA8 B-hash
Decoy O
Installer O
for O
Cisco O
AnyConnect O
Mobility O
Client O
RAT B-malware.backdoor
Installer O
Executable O
( O
EXE O
) O
Executable O
( O
EXE O
) O
Executable O
( O
EXE O
) O
RAT B-malware.backdoor
Implant/Payload O
Cisco O
AnyConnect O
Mobility O
Client O
OLE O
Control O
Library O
( O
DLL O
) O
Valid O
Signed O
Executable O
( O
EXE O
) O
The O
initial O
launcher/dropper O
writes O
two O
executable O
files O
to O
the O
hard O
drive O
, O
the O
RAT B-malware.backdoor
Installer O
( O
MD5 O
: O
4F4BF27B738FF8F2A89D1BC487B054A8 B-hash
) O
and O
the O
Cisco O
AnyConnect O
decoy O
( O
MD5 O
: O
2F7E5F91BE1F5BE2B2F4FDA0910A4C16 B-hash
) O
. O

Hardware O
information O
. O

We O
retrieved O
the O
original O
functions O
names O
as O
plaintext O
strings O
by O
using O
a O
simple O
Python O
script O
. O

The O
analysts O
of O
Antiy O
thought O
that O
the O
attacker O
might O
know O
several O
remote O
injection O
methods O
of O
script O
downloading O
privilege O
, O
such O
as O
directly O
making O
the O
scrip O
be O
executed O
on O
the O
host O
by O
using O
security O
vulnerabilities O
. O

It O
is O
not O
surprising O
that O
attackers O
use O
vulnerabilities O
that O
are O
older O
, O
because O
, O
unfortunately O
, O
many O
computers O
are O
likely O
to O
be O
still O
out O
of O
date O
and O
so O
the O
attack O
works O
. O

This O
archive O
contains O
the O
CozyDuke B-malware.drop
components O
that O
the O
dropper O
will O
later O
install O
on O
the O
victim O
system O
. O

A O
hired O
actor O
may O
also O
explain O
the O
generic O
and O
uninspired O
nature O
of O
the O
phishing O
, O
which O
often O
took O
the O
form O
of O
an O
email O
purporting O
to O
contain O
an O
invoice O
or O
a O
legal O
document O
with O
an O
attachment O
containing O
a O
blurry O
image O
. O

The O
file O
descriptions O
and O
other O
properties O
of O
the O
malware O
look O
convincingly O
legitimate O
at O
first O
glance O
. O

Operation O
Molerats O

mrayesh.blogspot[.]com B-url.normal
The O
blog O
was O
created O
by O
mo'ayyad O
on O
Blogger O
, O
who O
is O
also O
using O
the O
name O
mo'ayy O
. O

The O
backdoor O
expects O
a O
command O
line O
parameter O
that O
specifies O
remote O
C O
& O
C O
address O
and O
port O
number O
. O

The O
shellcode O
exists O
as O
a O
Unicode O
escaped O
variable O
( O
sc O
) O
in O
the O
malicious O
JavaScript O
listed O
below O
. O

Syria O
's O
opposition O
has O
faced O
persistent O
targeting O
by O
Pro-Government O
Electronic O
Actors O
( O
PGEAs O
) O
throughout O
the O
Syrian O
civil O
war O
. O

The O
second O
Babar64 B-malware.drop
binary O
comes O
with O
its O
own O
set O
of O
C O
& O
C O
servers O
: O
http://www.alexpetro.com/images/training/courses/bb212/index.php B-url.cncsvr
http://www.etehadyie.ir/images/public/bb212/index.php B-url.cncsvr
The O
first O
one O
is O
the O
legitimate O
website O
of O
AlexPetro O
Technical O
Services O
, O
a O
company O
operating O
in O
the O
oil O
and O
gas O
industry O
in O
Kairo O
, O
Egypt O
. O

When O
VPN-Pro.exe B-malware.drop
is O
run O
, O
the O
victim O
is O
shown O
the O
Freegate B-malware.infosteal
end-user O
license O
agreement O
( O
EULA O
) O
dialogue O
box O
. O

In O
an O
August O
2012 O
response O
to O
a O
letter O
from O
UK-based O
NGO O
Privacy O
International O
, O
the O
UK O
Government O
revealed O
that O
at O
some O
unspecified O
time O
in O
the O
past O
, O
it O
had O
examined O
a O
version O
of O
FinSpy B-malware.backdoor
, O
and O
communicated O
to O
Gamma O
that O
a O
license O
would O
be O
required O
to O
export O
that O
version O
outside O
of O
the O
EU O
. O

Based O
on O
additional O
corroboration O
, O
we O
assess O
high O
confidence O
in O
this O
information O
. O

When O
you O
start O
the O
controller O
, O
you O
need O
to O
set O
the O
port O
you O
want O
to O
listen O
on O
and O
if O
you O
've O
set O
a O
password O
, O
add O
it O
here O
. O

برقعلا O
ليعامسإ O
ديرف O
يدايقلا O
تومل O
ةيقيقحلا O
ةصقلا O

As O
such O
, O
we O
propose O
two O
simple O
steps O
that O
Freegate B-malware.infosteal
could O
take O
to O
help O
mitigate O
the O
current O
and O
similar O
future O
threats O
. O

Our O
initial O
finding O
focused O
on O
' O
로그인 O
오류 O
.hwp O
' O
or O
' O
Korean O
Day O
' O
lure O
, O
but O
once O
we O
created O
a O
signature O
for O
the O
particular O
implementation O
of O
the O
PostScript O
, O
we O
found O
three O
additional O
lure O
documents O
in O
a O
public O
malware O
repository O
tied O
together O
by O
the O
use O
of O
this O
exploit O
: O
two O
CVs O
and O
a O
cryptocurrency O
exchange-themed O
lure O
. O

This O
actor O
is O
probably O
not O
the O
most O
advanced O
actor O
we O
've O
seen O
. O

Analyzed O
file O
( O
others O
are O
similar O
) O
: O

Figure O
16 O
. O

Learn O
how O
to O
protect O
Enterprises O
, O
Small O
Businesses O
, O
and O
Home O
Users O
from O
ransomware O
: O
Tags O
: O
Confucius O
CVE-2015-1641 B-malware.unknown
CVE-2017-11882 B-malware.backdoor
Patchwork O
Romance O
Scam O
Home O
and O
Home O
Office O
For O
Business O
Security O
Intelligence O
About O
Trend O
Micro O
Asia O
Pacific O
Region O
( O
APAC O
) O
: O
Australia O
/ O
New O
Zealand O
, O
中国 O
, O
日本 O
, O
대한민국 O
, O
台灣 O

It O
also O
serves O
as O
the O
loader O
of O
the O
main O
backdoor O
. O

The O
following O
items O
are O
gathered O
from O
the O
infected O
system O
: O
OS O
name O
OS O
version O
OS O
architecture O
AV O
installed O
List O
of O
banking O
software O
installed O
IP O
address O
Directory O
where O
malware O
is O
being O
executed O
from O
The O
information O
is O
sent O
to O
hxxp://108.61.188.171/put.php B-url.unknown
( O
Figure O
20 O
) O
. O

20 O
Sept O
. O

Commands O
used O
in O
uploading O
and O
downloading O
file O
Figure O
30 O
. O

It O
is O
no O
more O
complicated O
than O
any O
other O
malware O
we O
observe O
on O
a O
daily O
basis O
. O

2016년 O
4월에는 O
방위산업체 O
, O
해양 O
서비스 O
업체 O
, O
ICT O
기업 O
등이 O
중앙관리 O
솔루션 O
B의 O
취약점을 O
이용한 O
악성 O
코드 O
Ghostrat에 B-malware.backdoor
감염되었다 O
. O

It O
follows O
Stuxnet O
which O
was O
used O
against O
Iran O
in O
2010 O
and O
Industroyer O
which O
we O
believe O
was O
deployed O
by O
Sandworm O
Team O
against O
Ukraine O
in O
2016 O
. O

[ O
표 O
1 O
] O
은 O
안다리엘 O
그룹의 O
주요 O
공격 O
사례를 O
정리한 O
것이다 O
. O

The O
evidence O
is O
consistent O
with O
links O
to O
Appin O
, O
but O
remains O
inconclusive O
. O

Based O
on O
engines O
, O
sandboxes O
and O
background O
systems O
, O
Antiy O
Labs O
will O
continue O
to O
provide O
traffic-based O
anti-APT O
solutions O
for O
enterprises O
. O

Technical O
Details O

The O
key O
is O
embedded O
in O
the O
header O
of O
the O
packet O
, O
and O
is O
easily O
recovered O
. O

Each O
IRONGATE B-malware.drop
dropper O
currently O
identified O
deploys O
the O
same O
.NET O
payload O
, O
scada.exe B-malware.unknown
. O

Further O
analysis O
showed O
that O
the O
Iron O
cybercrime O
group O
used O
two O
main O
functions O
from O
HackingTeam O
's O
source O
in O
both O
IronStealer B-malware.infosteal
and O
Iron B-malware.ransom
ransomware O
. O

In O
particular O
, O
we O
identified O
advanced O
methods O
consistent O
with O
nation-state O
level O
capabilities O
including O
deliberate O
targeting O
and O
' O
access O
management O
' O
tradecraft O
– O
both O
groups O
were O
constantly O
going O
back O
into O
the O
environment O
to O
change O
out O
their O
implants O
, O
modify O
persistent O
methods O
, O
move O
to O
new O
Command O
& O
Control O
channels O
and O
perform O
other O
tasks O
to O
try O
to O
stay O
ahead O
of O
being O
detected O
. O

In O
our O
2014 O
report O
, O
we O
identified O
APT28 B-malware.infosteal
as O
a O
suspected O
Russian O
government-sponsored O
espionage O
actor O
. O

/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/ B-url.normal
By O
Kurt O
Baumgartner O
Kurt O
Baumgartner O
Principal O
Security O
Researcher O
, O
GReAT O
The O
StrongPity O
APT O
is O
a O
technically O
capable O
group O
operating O
under O
the O
radar O
for O
several O
years O
. O

The O
First O
to O
Write O
the O
Payload O
File O
and O
Then O
the O
Second O
to O
Correct O
the O
First O
to O
Bytes O
to O
MZ O
. O

We O
surmise O
this O
DLL O
simulates O
generation O
of O
IO O
values O
, O
which O
would O
normally O
be O
provided O
by O
an O
S7-based O
controller O
, O
since O
the O
functions O
it O
includes O
appear O
derived O
from O
the O
Siemens O
PLCSIM O
environment O
. O

The O
developers O
could O
be O
using O
a O
proxy O
or O
a O
VPN O
in O
order O
to O
fake O
the O
origin O
of O
the O
submission O
. O

This O
possibility O
suggests O
: O
Intruder O
remote O
access O
to O
the O
' O
master O
' O
system O
Intruder O
local O
access O
to O
the O
' O
master O
' O
system O
An O
exfiltration O
mechanism O
in O
the O
form O
of O
another O
piece O
of O
code O
Further O
analysis O
confirms O
the O
malware O
's O
use O
of O
an O
encrypted O
file O
stored O
on O
the O
system O
whereon O
the O
malware O
is O
executing O
without O
an O
apparent O
means O
of O
automatic O
generation O
. O

This O
complicates O
identifying O
its O
network O
traffic O
, O
as O
the O
header O
bytes O
in O
the O
zlib O
compressed O
data O
section O
no O
longer O
start O
with O
' O
78 O
9C O
' O
, O
as O
shown O
in O
Figure O
5 O
. O

When O
encryption O
is O
complete O
, O
the O
MBR O
code O
displays O
the O
next O
message O
with O
payment O
instructions O
, O
but O
as O
noted O
before O
this O
information O
is O
useless O
. O

We O
have O
been O
studying O
the O
Duqu B-malware.infosteal
Trojan O
for O
two O
months O
now O
, O
exploring O
how O
it O
emerged O
, O
where O
it O
was O
distributed O
and O
how O
it O
operates O
. O

C O
: O
\Users\The O
Invincible\Desktop\gx\gx-current-program\LSASS\obj\Release\LSASS.pdb O

Contribution O
: O

All O
rights O
reserved O
. O

Malicious O
documents O
in O
the O
attack O
. O

Selected O
APIs O
are O
identified O
by O
hashes O
, O
which O
are O
used O
to O
load O
the O
APIs O
dynamically O
at O
runtime O
. O

The O
top O
countries O
with O
StrongPity O
malware O
from O
the O
winrar.it B-url.normal
site O
from O
May O
25th O
through O
the O
first O
few O
days O
of O
June O
are O
Italy O
, O
Belgium O
, O
Algeria O
, O
Cote O
D'Ivoire O
, O
Morroco O
, O
France O
, O
and O
Tunisia O
. O

At O
the O
time O
of O
this O
writing O
malicious O
code O
is O
still O
live O
on O
the O
website O
, O
so O
please O
visit O
with O
care O
until O
the O
website O
is O
clean O
. O

The O
IP O
address O
after O
verifying O
the O
filename O
then O
returns O
the O
executable O
content O
which O
malware O
reads O
directly O
from O
the O
network O
stream O
and O
writes O
to O
the O
disk O
in O
the O
% O
Appdata O
% O
\SQLIte O
directory O
as O
shown O
below O
. O

filename O
is O
based O
on O
static O
analysis O
. O

[ O
High O
Confidence O
] O
- O
The O
DQM O
theory O
presented O
by O
FireEye O
and O
later O
explored O
by O
Symantec O
in O
2014 O
about O
likely O
tool O
and O
exploit O
sharing O
between O
a O
specific O
set O
of O
groups O
continues O
to O
hold O
true O
, O
we O
can O
only O
speculate O
as O
to O
the O
nature O
of O
the O
relationships O
organisationally O
between O
these O
groups O
. O

icon.swf O
( O
214709aa7c5e4e8b60759a175737bb2b O
) O
- O
> O
icon.jpg O
( O
42a837c4433ae6bd7490baec8aeb5091 O
) O
- O
> O
% O
temp%\RealTemp.exe O
( O
61cc019c3141281073181c4ef1f4e524 O
) O
After O
icon.jpg O
is O
downloaded O
by O
the O
flash O
exploit O
, O
it O
is O
decoded O
with O
a O
multibyte O
xor O
key O
0xb369195a02 O
. O

We O
're O
not O
sure O
how O
wound O
up O
in O
the O
chat O
room O
or O
how O
he O
met O
. O

They O
also O
rely O
entirely O
on O
IPs O
( O
rather O
than O
domains O
) O
for O
their O
command-and-control O
infrastructure O
, O
a O
tactic O
likely O
borne O
of O
the O
use O
of O
hacked O
servers O
for O
infrastructure O
. O

This O
malware O
appears O
to O
be O
just O
part O
of O
a O
wider O
attack O
toolkit O
, O
and O
would O
have O
been O
used O
to O
cover O
the O
attackers O
' O
tracks O
as O
they O
sent O
forged O
payment O
instructions O
to O
make O
the O
transfers O
. O

The O
Big B-malware.infosteal
Bang I-malware.infosteal
campaign O
described O
below O
incorporates O
improved O
capabilities O
and O
offensive O
infrastructure O
, O
and O
seems O
to O
be O
even O
more O
targeted O
. O

Visits O
from O
the O
following O
locations O
occurred O
on O
or O
after O
the O
10th O
: O
● O
Germany O
( O
likely O
to O
be O
research O
) O
● O
Ukraine O
( O
likely O
to O
be O
research O
) O
● O
Amazon O
Web O
Services O
, O
multiple O
locations O
( O
likely O
to O
be O
research O
) O
● O
Googlebot O
, O
multiple O
locations O
● O
US O
● O
Russia O
● O
Brazil O
● O
China O
Ireland O
( O
likely O
to O
be O
research O
) O
● O
Finland O
● O
Canada O
● O
Taiwan O
● O
France O
( O
likely O
to O
be O
research O
) O
● O
Czech O
Republic O

We O
will O
keep O
an O
eye O
on O
what O
happens O
in O
this O
space O
. O

It O
also O
abuses O
three O
legitimate O
MS O
Office O
functions O
: O
A O
legitimate O
Microsoft O
Office O
function O
used O
in O
an O
Office O
file O
to O
retrieve O
data O
from O
another O
Office O
file O
An O
Office O
function O
used O
for O
automatic O
and O
user-free O
updates O
for O
embedded O
links O
upon O
opening O
. O

Finally O
, O
perhaps O
the O
strongest O
connection O
comes O
from O
targeting O
. O

reg.exe B-malware.unknown
, O
reg1.exe B-malware.unknown
: O

998F30457BC48A1A6567203E0EC3282E B-hash
powerhost.zapto.org B-url.cncsvr

- O
will O
download O
a O
file O
from O
a O
remote O
URL O
using O
InternetOpen O
and O
InternetReadFile O
# O
sleep O
? O

The O
introduction O
of O
the O
backdoors O
is O
a O
key O
turning O
point O
in O
the O
investigation O
since O
it O
demonstrated O
the O
threat O
actor O
's O
resourcefulness O
and O
skill-set O
. O

A O
200.63.46.23 B-ip.unknown
16 O
trxforcekitoriginal.com B-url.unknown
. O

13 O
. O

This O
is O
indicative O
of O
the O
adaptive O
, O
counter-intelligence O
techniques O
being O
adopted O
as O
threat O
actors O
become O
aware O
that O
many O
security O
researchers O
use O
these O
services O
to O
gather O
threat O
intelligence O
. O

In O
another O
chat O
room O
called O
' O
Maira O
's O
room O
' O
, O
a O
target O
of O
interest O
disclosed O
he O
was O
a O
government O
officer O
traveling O
back O
from O
a O
northern O
city O
near O
the O
country O
's O
provincial O
capital O
. O

When O
the O
Korean-language O
docx O
icon O
is O
clicked O
, O
it O
launches O
the O
embedded O
HTA O
 le O
Error733.hta O
. O

A O
list O
of O
main O
capabilities O
, O
along O
with O
a O
short O
description O
, O
are O
shown O
below O
in O
Table O
1 O
. O

Key O
, O
$ O
prov.IV O
) O
$ O
ret O
= O
perfCr O
$ O
decr O
$ O
encData O
Catch O
{ O
} O
function O
sWP O
( O
$ O
cN O
, O
$ O
pN O
, O
$ O
aK O
, O
$ O
aI O
) O
if O
( O
$ O
cN O
-eq O
$ O
null O
-or O
$ O
pN O
-eq O
$ O
null O
) O
{ O
return O
$ O
false O
} O
$ O
wp O
= O
( O
[ O
wmiclass O
] O
$ O
cN O
) O
.Properties O
[ O
$ O
pN O
] O
.Value O
$ O
exEn O
= O
[ O
Convert O
] O
: O
:FromBase64String O
( O
$ O
wp O
) O
$ O
exDec O
= O
decrAes O
$ O
exEn O
$ O
aK O
$ O
aI O
$ O
ex O
= O
[ O
Text.Encoding O
] O
: O
:UTF8.GetString O
( O
$ O
exDec O
) O
if O
( O
$ O
ex O
-eq O
$ O
null O
-or O
$ O
ex O
-eq O
' O
) O
{ O
return O
} O
Invoke-Expression O
$ O
ex O
return O
$ O
true O
catch O
{ O
return O
$ O
false O
$ O
aeK O
= O
[ O
byte O
[ O
] O
] O
( O
0xe7 O
, O
0xd6 O
, O
0xbe O
, O
0xa9 O
, O
0xb7 O
, O
0xe6 O
, O
0x55 O
, O
0x3a O
, O
0xee O
, O
0x16 O
, O
0x79 O
, O
0xca O
, O
0x56 O
, O
0x0f O
, O
0xbc O
, O
0x3f O
, O
0x22 O
, O
0xed O
, O
0xff O
, O
0x02 O
, O
0x43 O
, O
0x4c O
, O
0x1b O
, O
0xc0 O
, O
0xe7 O
, O
0x57 O
, O
0xb2 O
, O
0xcb O
, O
0xd8 O
, O
0xce O
, O
0xda O
, O
0x00 O
) O
$ O
aeI O
= O
[ O
byte O
[ O
] O
] O
( O
0xbe O
, O
0x7a O
, O
0x90 O
, O
0xd9 O
, O
0xd5 O
, O
0xf7 O
, O
0xaa O
, O
0x6d O
, O
0xe9 O
, O
0x16 O
, O
0x64 O
, O
0x1d O
, O
0x97 O
, O
0x16 O
, O
0xc0 O
, O
0x67 O
) O
sWP O
' O
Wmi O
' O
' O
Wmi O
' O
$ O
aeK O
$ O
aeI O
| O
Out-Null O
This O
one-line O
powershell O
command O
, O
stored O
only O
in O
WMI O
database O
, O
establishes O
an O
encrypted O
connection O
to O
C2 O
and O
downloads O
additional O
powershell O
modules O
from O
it O
, O
executing O
them O
in O
memory O
. O

The O
backdoor O
interestingly O
contains O
the O
well O
known O
Poison O
Ivy O
RAT O
shellcode O
as O
well O
as O
its O
own O
custom O
backdoor O
. O

This O
campaign O
made O
use O
of O
a O
malware O
family O
identified O
as O
NetTraveler B-malware.infosteal
based O
on O
the O
strings O
found O
in O
the O
malware O
code O
. O

SRCHUI.dll O
adrclients.dll O
KB471623.exe O

THE O
ORIGINAL O
, O
BENIGN O
APPLICATION O
ENABLED O
ARTILLERY O
FORCES O
TO O
MORE O
RAPIDLY O
PROCESS O
TARGETING O
DATA O
FOR O
THE O
D-30 O
HOWITZER O
REDUCING O
TARGETING O
TIME O
FROM O
MINUTES O
DOWN O
TO O
15 O
SECONDS O
. O

This O
fake O
root O
CA O
supposedly O
signed O
the O
malware O
's O
binaries O
, O
which O
will O
make O
them O
look O
legitimate O
. O

The O
THREEBYTE B-malware.backdoor
spear O
phishing O
incident O
( O
while O
not O
yet O
attributed O
) O
shared O
the O
following O
characteristics O
with O
the O
above O
HIGHTIDE B-malware.backdoor
campaign O
attributed O
to O
APT12 O
: O
The O
THREEBYTE B-malware.backdoor
backdoor O
was O
compiled O
two O
days O
after O
the O
HIGHTIDE B-malware.backdoor
backdoors O
. O

When O
examining O
the O
code O
on O
the O
exploit O
kit O
website O
a O
list O
of O
255 O
IP O
address O
strings O
was O
found O
. O

The O
DUBNIUM B-malware.drop
binary O
checks O
for O
the O
running O
environment O
very O
extensively O
. O

Plink O
is O
then O
used O
to O
open O
reverse O
SSH O
sessions O
from O
the O
attacker O
's O
server O
to O
the O
RDP O
port O
on O
the O
victim O
computer O
. O

The O
increased O
threat O
activity O
against O
the O
U.S. O
state O
and O
local O
government O
, O
technology O
, O
advisory O
services O
, O
and O
health O
sectors O
in O
the O
past O
two O
weeks O
is O
of O
great O
concern O
to O
us O
as O
it O
is O
being O
carried O
through O
phishing O
emails O
with O
what O
appears O
to O
be O
a O
tool O
known O
as O
Unrecom B-malware.infosteal
RAT I-malware.infosteal
. O

As O
such O
, O
FireEye O
believes O
this O
to O
be O
a O
common O
theme O
for O
this O
APT O
group O
, O
as O
APT12 O
will O
continue O
to O
evolve O
in O
an O
effort O
to O
avoid O
detection O
and O
continue O
its O
cyber O
operations O
. O

NOVEMBER O
2016 O
The O
OSCE O
confirmed O
that O
it O
had O
suffered O
an O
intrusion O
, O
which O
a O
Western O
intelligence O
service O
attributed O
to O
APT28 B-malware.infosteal
. O

and/or O
its O
affiliates O
. O

SYSTEM\CurrentControlSet\Control\Class\ O
{ O
4D36E967-E325-11CE-BFC1-08002BE10318 O
} O

The O
task O
scheduler O
method O
has O
also O
been O
added O
to O
the O
newest O
version O
of O
the O
RAT O
. O

Apparently O
, O
the O
system O
that O
we O
were O
studying O
had O
been O
infected O
in O
late O
August O
2011 O
. O

We O
went O
through O
our O
logs O
to O
search O
for O
entries O
that O
contained O
hashes O
related O
to O
the O
ten O
APT B-malware.unknown
campaigns O
we O
have O
been O
investigating O
. O

Data O
Source= O
- O
The O
code O
will O
connect O
using O
the O
SqlConnection O
class O
. O

Meanwhile O
, O
the O
Syrian O
opposition O
, O
and O
several O
groups O
working O
closely O
with O
it O
, O
such O
as O
Cyber O
Arabs O
, O
have O
been O
active O
in O
attempting O
to O
identify O
potential O
threats O
and O
warn O
users O
. O

Perhaps O
it O
is O
an O
artefact O
from O
early O
development O
of O
the O
code O
. O

All O
three O
families O
leave O
the O
impression O
of O
being O
developed O
by O
a O
team O
of O
skilled O
software O
developers O
, O
rather O
than O
being O
the O
product O
of O
a O
malware O
author O
operating O
in O
the O
criminal O
underground O
. O

...................................................................................................................................... O
11 O
Infrastructure O
...................................................................................................................................................... O
13 O
Key O
C2 O
and O
delivery O
servers O
....................................................................................................................... O
13 O
Threat O
actor O
and O
Attribution O
.............................................................................................................................. O
15 O
Threat O
actor O
............................................................................................................................................... O
15 O
Who O
is O
moayy2ad@hotmail.com B-url.normal
.............................................................................................................. O
16 O
Contacting O
ClearSky O
........................................................................................................................................ O
22 O
By O
Email O
...................................................................................................................................................... O
22 O
By O
phone O
.................................................................................................................................................... O
23 O
Appendix O
A O
– O
Indicators O
...................................................................................................................................... O
24 O
This O
report O
is O
a O
follow-up O
on O
our O
DustySky B-malware.drop
operation O
report O
from O
January O
2016 O
. O

@ O
@ O
sernum1 O

v6 O
= O
objc_msgSend_ptr O
( O
classRef_MainHandler O
, O
selRef_alloc O
) O
; O
v7 O
= O
objc_msgSend_ptr O
( O
v6 O
, O
( O
const O
char O
* O
) O
selRef_init O
) O
; O
v8 O
= O
objc_retain_ptr O
( O
v5 O
, O
selRef_init O
) O
; O
v9 O
= O
v7 O
; O
v7 O
= O
v8 O
; O
objc_release_ptr O
( O
v9 O
) O
; O
objc_msgSend_ptr O
( O
v7 O
, O
selRef_cycleLoop O
) O
; O

Also O
identified O
during O
this O
analysis O
, O
was O
the O
prepositioning O
of O
a O
domain O
targeting O
the O
financial O
institution O
B-OF-AMERIC.COM B-url.normal
, O
created O
in O
April O
2015 O
. O

Python O
function O
made O
for O
testing O
connection O
to O
Command O
& O
Control O
servers O
. O

Ibid O
. O

The O
campaigns O
included O
attacks O
on O
Punjabi O
separatists O
, O
Norwegian O
telecom O
Telenor O
, O
and O
multiple O
other O
companies O
. O

34 O
. O

2018년 O
5월 O
현재까지 O
안다리엘 O
그룹이 O
한글파일 O
( O
HWP O
) O
을 O
공격에 O
이용한 O
사례는 O
확인되지 O
않았다 O
. O

Indeed O
, O
the O
next O
stages O
of O
the O
attack O
may O
even O
still O
be O
in O
the O
works O
, O
not O
yet O
deployed O
or O
only O
deployed O
to O
selected O
few O
victims O
. O

Conclusion O
: O

This O
is O
the O
official O
history O
of O
Stuxnet B-malware.backdoor
. O

* O
• O
10.51 O
. O

One O
of O
the O
characteristics O
of O
the O
group O
behind O
Poseidon B-malware.infosteal
is O
an O
active O
exploration O
of O
domain­based O
networks O
. O

The O
following O
commands O
and O
their O
descriptions O
, O
listed O
by O
executable O
file O
, O
illustrate O
the O
submitted O
malware O
's O
functionality O
: O

All O
but O
one O
of O
the O
droppers O
incorporated O
anti-detection/analysis O
techniques O
to O
identify O
execution O
in O
VMware O
or O
the O
Cuckoo O
Sandbox O
. O

13 O
August O
2016 O
. O

Figure O
2 O
: O

Web O
. O

In O
our O
analysis O
we O
were O
not O
able O
to O
directly O
connect O
the O
malicious O
dll B-malware.backdoor
file O
to O
the O
X-Agent B-malware.backdoor
samples O
, O
but O
believe O
they O
are O
both O
part O
of O
a O
well-coordinated O
surgical O
attack O
powered O
by O
APT28 O
. O

Change O
the O
current O
work O
directory O
on O
the O
real O
file O
system O
N/A O
: O
the O
command O
is O
actually O
not O
implemented O
Installation O
or O
de­installation O
of O
Dino B-malware.backdoor
, O
in O
Windows O
registry O
and/or O
as O
a O
service O
Extracts O
a O
file O
stored O
in O
ramFS O
onto O
the O
machine O
Deletes O
a O
file O
stored O
on O
the O
machine O
Executes O
a O
file O
stored O
in O
ramFS O
Injects O
a O
file O
stored O
in O
ramFS O
into O
a O
running O
process O
Sleeps O
for O
a O
given O
amount O
of O
time O
Terminates O
a O
running O
process O
N/A O
: O
the O
command O
is O
actually O
not O
implemented O
In O
the O
case O
of O
Dino B-malware.backdoor
, O
ramFS O
serves O
as O
protected O
storage O
for O
one O
specific O
file O
containing O
the O
instructions O
to O
remove O
the O
malware O
from O
the O
machine O
. O

The O
attack O
this O
month O
on O
Taiwanese O
Far O
Eastern O
International O
Bank O
has O
some O
of O
the O
hallmarks O
of O
the O
Lazarus O
group O
: O
• O
Destination O
beneficiary O
accounts O
in O
Sri O
Lanka O
and O
Cambodia O
– O
both O
countries O
have O
been O
used O
previously O
as O
destinations O
for O
Lazarus O
' O
bank O
heist O
activity O
; O
• O
Use O
of O
malware O
previously O
seen O
in O
Lazarus O
' O
Poland O
and O
Mexico O
bank O
attacks O
. O

The O
techniques O
documented O
in O
this O
report O
indicate O
a O
level O
of O
sophistication O
that O
make O
reverse O
engineering O
more O
difficult O
and O
to O
obscure O
the O
intentions O
of O
the O
actor O
behind O
this O
malware O
. O

PCC_PROXY O
: O
:MainThread O
function O
consist O
an O
infinite O
loop O
that O
only O
terminates O
when O
the O

Previously O
, O
we O
were O
only O
able O
to O
cluster O
activity O
based O
on O
the O
infrastructure O
used O
and O
the O
associated O
malware O
, O
we O
now O
have O
a O
sufficient O
number O
of O
samples O
to O
cluster O
based O
on O
differences O
in O
implementation O
between O
the O
code O
used O
for O
ScanBox B-malware.infosteal
in O
each O
case O
. O

The O
domain O
tiger.gamma-international.de B-url.cncsvr
has O
the O
following O
Whois O
information O
: O
Domain O
: O
gamma-international.de B-url.cncsvr
Name O
: O
Martin O
Muench O
Organisation O
: O
Gamma O
International O
GmbH O
Address O
: O
Baierbrunner O
Str O
. O

C:\Windows\Temp\bitsran.exe B-malware.drop

Operation B-malware.infosteal
Daybreak I-malware.infosteal
appears O
to O
have O
been O
launched O
by O
unknown O
attackers O
to O
infect O
high O
profile O
targets O
through O
spear-phishing O
e-mails O
. O

While O
analyzing O
the O
download O
URL O
down.pzchao.com B-url.cncsvr
, O
we O
realized O
that O
it O
runs O
on O
a O
HTTP O
fi O
le O
server O
and O
we O
managed O
to O
obtain O
a O
list O
of O
all O
fi O
les O
hosted O
on O
it O
, O
including O
meta-information O
such O
as O
last O
modifi O
cation O
timestamps O
and O
number O
of O
downloads O
. O

But O
applying O
the O
decryption O
routine O
yields O
the O
following O
: O

The O
primary O
purpose O
of O
this O
file O
is O
to O
load O
and O
execute O
a O
main O
module O
, O
which O
is O
created O
separately O
. O

2016 O
. O

As O
a O
result O
, O
nations O
and O
organizations O
which O
without O
its O
own O
elite O
hacker O
groups O
and O
abundant O
capital O
can O
also O
launch O
some O
kind O
of O
APT O
attack O
via O
the O
attack O
pattern O
mentioned O
in O
this O
case O
. O

All O
modules O
with O
commands O
: O

The O
command O
and O
control O
( O
C2 O
) O
server O
is O
selected O
based O
on O
the O
string O
in O
the O
file O
' O
id O
' O
: O
al O
- O
> O
' O
185.43.209[.]182 B-ip.unknown
' O
gr O
- O
> O
' O
212.237.46[.]6 B-ip.unknown
' O
pz O
- O
> O
' O
87.98.146[.]34 B-ip.unknown
' O
mn O
- O
> O
' O
80.211.140[.]235 B-ip.unknown
' O
The O
connection O
to O
one O
of O
the O
hosts O
is O
then O
started O
over O
raw O
TCP O
on O
port O
9999 O
. O

Netsat.exe's O
data O
collection O
functionality O
suggested O
data O
destined O
for O
exfiltration O
might O
be O
collected O
by O
the O
' O
master O
' O
system O
. O

Yet O
Tajik O
was O
arrested O
and O
killed O
because O
the O
Iranian O
government O
feared O
that O
Tajik O
was O
not O
ideologically O
aligned O
and O
posed O
a O
betrayal O
and O
flight O
risk O
. O

CREDRIVER.dll O

While O
watering B-malware.backdoor
holes I-malware.backdoor
and O
poisoned O
installers O
are O
tactics O
that O
have O
been O
effectively O
used O
by O
other O
APT O
, O
we O
have O
never O
seen O
the O
same O
focus O
on O
cryptographic-enabled O
software O
. O

c O
: O
\windows\system32\en-US\netsvc.dll.mui O

Looking O
at O
passive O
DNS O
records O
for O
other O
domains O
pointing O
to O
the O
IP O
addresses O
used O
to O
host O
the O
C O
& O
C O
services O
turned O
up O
many O
other O
related O
domains O
. O

While O
the O
regex O
syntax O
may O
seem O
like O
gibberish O
, O
mastering O
it O
is O
not O
as O
difficult O
as O
it O
seems O
at O
first O
glance O
. O

Be O
wary O
of O
opening O
unsolicited O
attachments O
received O
via O
email O
, O
skype O
or O
any O
other O
communications O
mechanism O
. O

The O
spyware O
's O
infection O
vector O
involves O
social O
engineering O
using O
attractive O
, O
but O
fictitious O
Facebook O
profiles O
. O

While O
the O
code O
in O
the O
different O
families O
– O
Carbanak B-malware.infosteal
( O
Win32/Spy.Sekur O
) O
, O
Win32/Spy.Agent.ORM B-malware.infosteal
, O
and O
Win32/Wemosis B-malware.backdoor
– O
is O
different O
it O
does O
contain O
similar O
traits O
, O
including O
the O
same O
digital O
certificate O
. O

While O
initially O
developed O
for O
mainland O
Chinese O
users O
, O
the O
software O
is O
used O
in O
a O
number O
of O
other O
countries O
. O

This O
often O
leads O
to O
a O
false O
sense O
of O
security O
within O
the O
community O
and O
perpetuates O
the O
idea O
that O
public O
exposure O
makes O
us O
all O
safer O
. O

What O
we O
wanted O
to O
look O
at O
was O
the O
extent O
of O
the O
wiping O
on O
the O
partitions O
and O
whether O
the O
same O
techniques O
that O
were O
applied O
to O
a O
single O
partitioned O
drive O
would O
still O
apply O
on O
the O
multiple O
partitioned O
drive O
. O

973ff7eb7a5b720c5f6aafe4cd0469d5 O
Summary O
: O
SPLM B-malware.backdoor
is O
being O
carved O
up O
and O
delivered O
as O
memory-only O
chunks O
of O
compiled O
code O
. O

Cisco O
Cloud O
Web O
Security O
( O
CWS O
) O
or O
Web O
Security O
Appliance O
( O
WSA O
) O
web O
scanning O
prevents O
access O
to O
malicious O
websites O
and O
detects O
malware O
used O
in O
these O
attacks O
. O

As O
mentioned O
in O
the O
behavioral O
analysis O
section O
, O
the O
Cmstar B-malware.unknown
downloader O
gathers O
system-specific O
information O
to O
send O
to O
the O
C2 O
server O
. O

We O
were O
also O
able O
to O
observe O
links O
between O
Operation B-malware.ransom
Manul I-malware.ransom
and O
a O
malware O
campaign O
targeting O
the O
family O
of O
Mukhtar O
Ablyazov O
, O
co-founder O
of O
the O
Democratic O
Choice O
of O
Kazakhstan O
, O
a O
party O
opposed O
to O
the O
authoritarian O
rule O
of O
Kazakhstan O
's O
President O
Nursultan O
Nazarbayev.Ablyazov O
is O
currently O
fighting O
extradition O
from O
France O
, O
where O
he O
lives O
in O
exile O
, O
to O
Nazarbayev-allied O
Russia O
. O

This O
way O
the O
attackers O
actually O
know O
what O
applications O
and O
commands O
they O
can O
use O
without O
raising O
an O
alert O
to O
the O
network O
administrator O
during O
lateral O
movement O
and O
exfiltration O
. O

None O
, O
some O
or O
all O
domains O
in O
this O
list O
might O
be O
malicious O
as O
well O
. O

0x406ECA O
: O
72D8 O
JB O
0x406EA4 O

After O
every O
action O
is O
performed O
the O
malware O
sends O
a O
response O
to O
the O
control O
server O
indicating O
whether O
the O
action O
was O
successful O
. O

This O
is O
achieved O
by O
applying O
the O
detours O
technique O
, O
which O
implements O
trampoline O
functions O
to O
be O
invoked O
every O
time O
a O
hooked O
API O
is O
called.To O
achieve O
this O
, O
Babar B-malware.drop
rewrites O
the O
in-memory O
code O
for O
target O
APIs O
. O

If O
one O
of O
these O
products O
is O
installed O
, O
the O
malware O
will O
only O
run O
once O
without O
persistence O
. O

IEC O
60870-5-101 O
) O
, O
an O
international O
standard O
that O
describes O
a O
protocol O
for O
monitoring O
and O
controlling O
electric O
power O
systems O
The O
protocol O
is O
used O
for O
communication O
between O
industrial O
control O
systems O
and O
Remote O
Terminal O
Units O
( O
RTUs O
) O
The O
actual O
communication O
is O
transmitted O
through O
a O
serial O
connection O
The O
101 O
payload O
component O
partly O
implements O
the O
protocol O
described O
in O
the O
IEC O
101 O
standard O
and O
is O
able O
to O
communicate O
with O
an O
RTU O
or O
any O
other O
device O
with O
support O
for O
that O
protocol O
Once O
executed O
, O
the O
101 O
payload O
component O
parses O
the O
configuration O
stored O
in O
its O
INI O
file O
The O
configuration O
may O
contain O
several O
entries O
: O
process O
name O
, O
The O
name O
of O
the O
process O
specified O
in O
the O
configuration O
belongs O
to O
an O
application O
the O
attackers O
suspect O
is O
running O
on O
the O
victim O
machine O
It O
should O
be O
the O
application O
the O
victim O
machine O
uses O
to O
communicate O
through O
serial O
connection O
with O
the O
RTU O
The O
101 O
payload O
attempts O
to O
terminate O
the O
specified O
process O
and O
starts O
to O
communicate O
with O
the O
specified O
device O
, O
using O
the O
, O
and O
Windows O
API O
functions O
The O
first O
COM O
port O
from O
the O
configuration O
file O
is O
used O
for O
the O
actual O
communication O
and O
the O
two O
other O
COM O
ports O
are O
just O
opened O
to O
prevent O
other O
processes O
accessing O
them O
Thus O
, O
the O
101 O
payload O
component O
is O
able O
to O
take O
over O
and O
maintain O
control O
of O
the O
RTU O
device O
This O
component O
iterates O
through O
all O
IOAs O
in O
the O
defined O
IOA O
ranges O
For O
each O
such O
IOA O
it O
constructs O
two O
' O
select O
and O
execute O
' O
packets O
, O
one O
with O
a O
single O
command O
( O
) O
and O
one O
with O
a O
double O
command O
) O
and O
sends O
these O
to O
the O
RTU O
device O
The O
main O
goal O
of O
the O
component O
is O
to O
change O
the O
On/Off O
state O
of O
single O
command O
type O
IOA O
and O
double O
command O
type O
IOA O
Specifically O
, O
the O
101 O
payload O
has O
three O
stages O
: O
in O
the O
first O
stage O
this O
component O
attempts O
to O
switch O
IOAs O
to O
their O
Off O
state O
, O
in O
the O
second O
stage O
it O
attempts O
to O
invert O
IOA O
states O
to O
On O
, O
and O
in O
the O
final O
stage O
the O
component O
switches O
IOA O
states O
to O
Off O
again O
This O
payload O
DLL O
has O
the O
filename O
104 O
dll O
and O
is O
named O
after O
IEC O
104 O
( O
aka O

He O
fingerprinted O
the O
Bahrain O
server O
and O
looked O
at O
historical O
Internet O
scanning O
data O
to O
identify O
other O
servers O
around O
the O
world O
that O
responded O
to O
the O
same O
fingerprint O
. O

木马分析 O
( O
3 O
) O
activities.Victims O
include O
trade O
agencies O
and O
related O
organizations O
. O

Figure O
10 O
: O
Contents O
of O
VBS O
Script O

We O
explained O
that O
this O
case O
is O
linked O
to O
the O
Uroburos B-malware.backdoor
rootkit I-malware.backdoor
. O

Performs O
some O
copies O
and O
operations O
on O
this O
buffer O
to O
produce O
an O
intermediate O
buffer O
; O
3 O
. O

While O
it O
seems O
that O
different O
operators O
are O
responsible O
for O
these O
two O
campaigns O
, O
our O
research O
showed O
that O
these O
operators O
share O
a O
number O
of O
common O
tools O
, O
techniques O
and O
procedures O
( O
TTPs O
) O
. O

blogdns[.]com B-url.cncsvr
lcl918_NewCT O
46ac122183c32858 B-hash
581e95ef40bd31b3 I-hash
CT O
V2.1 O
81998ee8b8f8304d B-hash
038e3cb5ff10b4d2 I-hash
IntelAMTPP O
. O

This O
report O
focuses O
on O
the O
CopyKittens B-malware.backdoor
, O
a O
mid-level O
group O
. O

What O
we O
have O
presented O
here O
are O
forensically O
sound O
methods O
that O
are O
easily O
repeatable O
and O
least O
damaging O
to O
the O
evidence/image O
. O

It O
encodes O
every O
string O
that O
can O
be O
useful O
for O
quick O
analysis O
. O

Furthermore O
, O
the O
strings O
in O
the O
sample O
are O
obfuscated O
. O

The O
ZxShell B-malware.backdoor
driver O
starts O
by O
acquiring O
some O
kernel O
information O
and O
then O
hooking O
' O
ObReferenceObjectByHandle O
' O
API O
. O

It O
ensures O
this O
by O
checking O
if O
the O
return O
value O
from O

T O
he O
tool O
helps O
penetration O
testers O
to O
collect O
information O
on O
the O
subdomains O
of O
the O
domain O
they O
are O
researching O
. O

According O
to O
above O
information O
, O
we O
can O
not O
make O
sure O
this O
leading O
sample O
has O
relationship O
with O
this O
APT O
incident O
. O

& O
& O
set O
xmd=echo O
iex O
( O
ls O
env O
: O
tjdm O
) O
.value O
^ O
| O
powershell O
-noni O
-noex O
-execut O
bypass O
-nopro le O
-wind O
hidden O
– O
& O
& O
cmd O
/C O
% O
xmd O
% O
The O
extracted O
script O
is O
heavily O
disguised O
, O
using O
a O
combination O
of O
string-format O
operator O
obfuscation O
and O
other O
string-based O
obfuscation O
techniques O
. O

The O
attackers O
used O
this O
technique O
to O
delay O
, O
divert O
and O
confuse O
the O
manual O
analysis O
. O

The O
basic O
method O
in O
this O
case O
, O
an O
in-memory O
implant O
using O
PowerShell O
along O
with O
obfuscation O
to O
avoid O
detection O
, O
is O
a O
common O
and O
increasing O
popular O
 leless O
technique O
used O
in O
cyberattacks O
. O

5 O
Sept O
. O

The O
decoy O
documents O
and O
filenames O
used O
in O
the O
attacks O
suggest O
the O
intended O
targets O
include O
organisations O
with O
political O
interests O
or O
influence O
in O
Israel O
and O
Palestine O
. O

This O
time O
the O
marker O
string O
points O
to O
the O
beginning O
of O
the O
encrypted O
server O
service O
name O
. O

edc83f5b08d3d009e60f3700d6a273da B-hash
SHA-1 O
SHA-256 O
File O
Size O
8f338c7afb4346e8fe9f8db289b6fc6a03e68378 B-hash
d3c30cc8fb8f049ca6d448466f7440e175b53dcdf7d7e769c34693d43d858b06 B-hash
378 O
KB O

This O
backdoor O
program O
has O
several O
capabilities O
that O
are O
outlined O
below O
. O

The O
VBS O
code O
also O
creates O
a O
file O
in O
C O
: O
\Users\Public\Administrador\car.dat O
with O
random O
strings O
. O

In O
Q4 O
of O
2017 O
, O
a O
similar O
malspam O
campaign O
delivered O
the O
same O
banking O
Trojan O
by O
using O
an O
embedded O
JAR O
file O
attached O
in O
the O
email O
instead O
of O
an O
HTML O
attachment O
. O

Operation O
BugDrop O
is O
a O
well-organized O
operation O
that O
employs O
sophisticated O
malware O
and O
appears O
to O
be O
backed O
by O
an O
organization O
with O
substantial O
resources O
. O

5 O
2016년 O
11월부 O
터 O
공격을 O
시도한 O
것으로 O
보이며 O
, O
공격에 O
사용된 O
악성코드는 O
2016년 O
관사 O
관련 O
기관의 O
자료 O
유출에 O
사 O
용된 O
악성코드와 O
유사했다 O
. O

r/rr-xr-xr-x00 O
26395-128-5 O
C O
: O
/WINDOWS/Installer/ O
{ O
49FD463C-18F1-63C4-8F12-49F518F127 O
} O
/09e493e2-05f9-4899-b661-c52f3554c644 O

Cylance O
has O
observed O
the O
following O
ZIP O
files O
which O
contained O
a O
similarly O
named O
executable O
: O
) O
.zip O
• O
2016 O
A4 O
1025.zip O
• O
11 O

targattacks O

This O
POST O
request O
containing O
the O
password O
is O
sent O
to O
another O
server-side O
script O
, O
called O
/upload864 O
. O

13 O
. O

The O
targets O
While O
root9B O
's O
discovery O
began O
with O
servicing O
their O
own O
customers O
, O
their O
analysis O
has O
revealed O
an O
adversary O
pattern O
that O
has O
enabled O
the O
identification O
of O
previously O
unknown O
target O
vectors O
. O

In O
addition O
to O
the O
above O
behavior O
, O
EvilGrab B-malware.drop
also O
creates O
the O
following O
registry O
entry O
to O
enable O
its O
automatic O
execution O
at O
every O
system O
startup O
: O
The O
file O
is O
a O
copy O
of O
one O
of O
the O
malware O
components O
. O

We O
do O
not O
know O
what O
was O
the O
content O
in O
the O
final O
URL O
. O

isActiveChannel O
] O

There O
was O
one O
unique O
case O
we O
found O
where O
the O
initial O
dropper O
was O
a O
self­extracting O
archive O
that O
utilizes O
Visual O
Basic O
and O
batch O
scripts O
to O
download O
and O
install O
the O
DLL O
instead O
of O
extracting O
it O
from O
a O
resource O
. O

First O
, O
they O
register O
a O
special O
window O
for O
it O
: O
In O
the O
window O
procedure O
, O
they O
post O
WM_DDE_EXECUTE O
messages O
with O
commands O
: O

By O
phone O

PCC_CMD O
: O
:ReadWaitingData O
member O
function O
is O
responsible O
for O
transmitting O
any O
of O
the O
previously O
queued O
packets O
from O
PCC_CMD O
: O
:ProcessPacketEx O
. O

The O
deployment O
of O
anti-virus O
software O
, O
intrusion O
detection O
systems O
, O
firewalls O
and O
other O
malware O
detection O
or O
prevention O
technology O
has O
done O
much O
to O
defend O
against O
many O
attacks O
. O

An O
in-depth O
analysis O
of O
the O
FinSpy B-malware.backdoor
Mobile O
suite O
of O
backdoors O
was O
provided O
in O
an O
earlier O
blog O
post O
: O
The O
Smartphone O
Who O
Loved O
Me O
: O
FinFisher B-malware.backdoor
Goes O
Mobile O
? O

Over O
the O
course O
of O
their O
correspondence O
, O
suggested O
using O
WhatsApp O
to O
communicate O
. O

3.5.2 O
INVADING O
DESKTOP O
PROCESSES O

Varying O
the O
cloud O
service O
provider O
used O
adds O
a O
further O
degree O
of O
stealth O
. O

Trend O
Micro O
refers O
to O
activity O
corresponding O
to O
FireEye O
's O
APT28 B-malware.infosteal
as O
' O
Pawn O
Storm O
. O
' O

Some O
of O
the O
binaries O
are O
also O
self­signed O
: O
So O
what O
can O
this O
malware O
do O
? O

A O
more O
detailed O
explanation O
of O
this O
can O
be O
found O
here O
. O

Gallagher O
, O
Sean O
. O

These O
include O
Getpass.exe O
and O
Mail.exe O
, O
which O
are O
password O
and O
information O
stealers O
. O

Figure O
20 O
: O
Host O
Recon O
Data O
Sent O
to O
First O
C2 O
Server O

The O
Washington O
Post O
. O

2 O
. O

Monitor O
and O
remove O
any O
unauthorized O
code O
present O
in O
any O
www O
directories O
. O

If O
the O
system O
date O
was O
after O
the O
hard O
coded O
dates O
, O
the O
malware O
would O
delete O
itself O
and O
terminate O
. O

While O
AIS O
will O
not O
eliminate O
sophisticated O
cyber O
threats O
, O
it O
will O
allow O
companies O
and O
federal O
agencies O
to O
concentrate O
more O
on O
them O
by O
clearing O
away O
less O
sophisticated O
attacks O
. O

10 O
. O

Table O
1 O
highlights O
some O
recent O
examples O
of O
this O
activity O
. O

The O
Gmail O
address O
is O
connected O
to O
a O
Facebook O
account O
, O
probably O
of O
a O
fake O
identity O
- O
Montaser O
Ali O

One O
possible O
hit O
was O
triggered O
when O
we O
observed O
Mevade B-malware.unknown
, O
an O
unusual O
piece O
of O
malware O
that O
appeared O
late O
in O
2013 O
. O

Asruex B-malware.drop
executes O
commands O
that O
are O
received O
from O
a O
C O
& O
C O
server O
. O

SPLM B-malware.backdoor
did O
not O
change O
in O
substantial O
ways O
for O
several O
years O
, O
and O
now O
it O
is O
being O
split O
up O
and O
used O
for O
just O
functional O
modules O
. O

Storm O
, O
Sednit O
, O
Sofacy O
, O
it O
has O
least O
2007 O
and O
The O
group O
was O
involved O
also O
in O
the O
string O
of O
attacks O
that O
targeted O
2016 O
Presidential O
election O
. O

The O
malware O
persistence O
uses O
a O
registry O
key O
in O
order O
to O
be O
executed O
automatically O
in O
case O
the O
system O
is O
rebooted O
. O

Version O
3.20 O
uses O
the O
following O
CLSID O
in O
order O
to O
hijack O
COM O
object O
: O
B196B286-BAB4-101A-B69C-00AA00341D07 O
. O

45899 O
- O
VNPT-AS-VN O
VNPT O
Corp O

2/12 O

One O
of O
most O
notable O
changes O
on O
the O
new O
RATANKBA B-malware.backdoor
variant O
is O
that O
the O
new O
version O
was O
written O
in O
Powershell O
, O
whereas O
the O
original O
variant O
was O
in O
PE O
form O
. O

The O
VBS O
also O
adds O
a O
registry O
key O
: O

Once O
it O
became O
known O
Inception B-malware.backdoor
was O
using O
a O
single O
provider O
, O
any O
tra c O
to O
that O
provider O
may O
have O
attracted O
additional O
scrutiny O
. O

The O
main O
distribution O
of O
samples O
goes O
back O
to O
2005 O
with O
possible O
earlier O
outliers O
. O

Upon O
returning O
from O
the O
' O
_check O
' O
function O
, O
the O
dropper O
will O
perform O
a O
simple O
comparison O
and O
if O
an O
analysis O
machine O
has O
been O
detected O
, O
it O
will O
signal O
the O
attackers O
again O
using O
almost O
the O
same O
URL O
as O
it O
did O
before O
but O
replacing O
the O
name O
of O
the O
' O
.png O
' O
file O
to O
the O
letter O
' O
n O
' O
concatenated O
with O
the O
number O
of O
the O
artifact O
found O
by O
Pafish O
. O

Please O
see O
the O
Attacker O
's O
Arsenal O
section O
for O
detailed O
analysis O
of O
the O
tools O
. O

These O
operations O
present O
somewhat O
of O
a O
problem O
for O
older O
disassemblers O
such O
as O
the O
original O
Ollydbg O
, O
but O
are O
trivially O
patched O
. O

A O
global O
hook O
is O
installed O
by O
calling O
SetWindowsHookEx O
by O
passing O
the O
thread O
ID O
zero O
. O

3a9237deaf25851f2511e355f8c506d7 B-hash

This O
data O
block O
is O
confi O
gurable O
before O
the O
malware O
is O
deployed O
. O

WADA O
officials O
, O
citing O
evidence O
provided O
by O
law O
enforcement O
, O
stated O
that O
the O
threat O
activity O
originated O
in O
Russia O
, O
possibly O
in O
retaliation O
for O
WADA O
's O
exposure O
of O
Russia O
's O
expansive O
, O
state-run O
doping O
. O

In O
the O
space O
of O
just O
4 O
kilobytes O
, O
the O
Web B-malware.ransom
shell O
offers O
file O
and O
database O
management O
, O
code O
obfuscation O
, O
and O
more—all O
in O
an O
easy-to-use O
graphical O
user O
interface O
that O
even O
novices O
can O
use O
. O

In O
sum O
, O
we O
believe O
that O
these O
groups O
are O
from O
two O
distinct O
regions O
in O
China O
and O
possibly O
( O
1 O
) O
are O
collaborating O
, O
( O
2 O
) O
received O
the O
same O
training O
, O
( O
3 O
) O
have O
a O
common O
toolkit O
supply O
chain O
, O
or O
some O
combination O
of O
these O
three O
. O

The O
binary O
then O
spawns O
a O
new O
thread O
that O
contains O
the O
main O
server O
variant O
code O
in O
order O
to O
allow O
the O
DllEntryPoint O
routine O
to O
return O
to O
the O
calling O
function O
. O

다음 O
은 O
세 O
종류의 O
중앙관리 O
솔루션의 O
클라이언트 O
에이전트의 O
취약점을 O
이용해 O
파일을 O
전송한 O
사례다 O
. O

The O
first O
available O
visitor O
redirects O
from O
winrar[.]be B-url.normal
to O
ralrab[.]com B-url.normal
first O
appeared O
on O
May O
28th O
, O
2016 O
, O
from O
the O
dutch O
speaking O
version O
of O
the O
winrar.be B-url.normal
site O
. O

Its O
length O
is O
13 O
= O
0x0d O
, O
and O
the O
two O
random O
bytes O
are O
0xf3 O
and O
0x92 O
. O

Knowledge O
of O
DRAGONFISH O
's O
tactics O
, O
techniques O
, O
and O
procedures O
( O
TTPs O
) O
helps O
to O
better O
inform O
detection O
and O
response O
to O
attacks O
by O
this O
threat O
group O
. O

The O
document O
was O
created O
on O
December O
27 O
at O
15:52 O
by O
the O
author O
' O
John O
. O
' O

29 O
. O

One O
of O
its O
file O
stealers O
, O
swissknife2 B-malware.infosteal
, O
abuses O
a O
cloud O
storage O
service O
as O
a O
repository O
of O
exfiltrated O
files O
. O

It O
is O
worth O
noting O
that O
these O
samples O
were O
all O
compiled O
after O
the O
domain O
began O
being O
used O
alongside O
the O

iframe O

We O
also O
identified O
another O
document O
exploiting O
CVE-2012-0158 O
, O
but O
this O
time O
apparently O
targeting O
some O
Indian O
individuals O
. O

1 O
* O
http://news.grouptumbler.com/ O

14 O
. O

The O
response O
is O
then O
parsed O
and O
passed O
to O
the O
second O
thread O
that O
acts O
as O
the O
worker O
. O

Friday O
, O
July O
24 O
, O
2015 O
By O
choosing O
common O
VPN O
software O
there O
is O
a O
high O
chance O
that O
the O
chosen O
vendor O
's O
software O
may O
be O
in O
use O
within O
the O
intended O
victim O
's O
corporate O
environment O
. O

Figure O
4 O
: O
XYTvn O
static O
packet O
flag O
| O
Victim O
to O
controller O
login O
request O

The O
discoveries O
that O
we O
made O
while O
investigating O
the O
command O
and O
control O
infrastructure O
associated O
with O
this O
campaign O
suggest O
that O
these O
attackers O
are O
' O
hired O
guns O
' O
and O
have O
multiple O
operations O
against O
different O
targets O
going O
on O
at O
the O
same O
time O
. O

We O
do O
not O
believe O
this O
developer O
is O
part O
of O
the O
core O
group O
that O
has O
access O
to O
the O
original O
implementation O
, O
but O
is O
instead O
another O
actor O
, O
who O
is O
likely O
rebuilding O
ScanBox B-malware.infosteal
from O
samples O
they O
find O
online O
. O

Each O
list O
of O
characters O
consists O
of O
the O
set O
found O
within O
the O
API O
function O
name O
the O
payload O
seeks O
to O
add O
to O
its O
IAT O
, O
while O
the O
corresponding O
list O
of O
numbers O
specifies O
the O
offset O
in O
the O
function O
name O
where O
those O
characters O
should O
be O
placed O
. O

For O
example O
, O
we O
have O
observed O
the O
following O
: O

In O
order O
to O
retrieve O
the O
server O
IP O
address O
, O
the O
backdoor O
first O
creates O
a O
particular O
DNS O
query O
. O

We O
were O
able O
to O
access O
this O
backend O
, O
which O
provided O
us O
with O
valuable O
information O
about O
this O
attack O
and O
its O
victims O
. O

Curiously O
though O
, O
the O
regsvr32.exe O
process O
used O
to O
load O
the O
dropped O
implant O
remains O
running O
. O

00b61db083b07a64fb6072b42aa83dc1 B-hash
0136ab6d2e507d4e63990b196121d41c B-hash
017c03ad61f89ee6597ead40cc552aef B-hash
019cb1a6776f0e0d353814711e9e171b B-hash
02043566d027445374a1f7f0fc35d495 B-hash
025dc68c8e06d6488e338dcc55b295eb B-hash
026c1532db8125fbae0e6aa1f4033f42 B-hash
02c9a3c3efd52e43dbf53e0995a7a24e B-hash
051caf12c36662d946fd0146cd199db5 B-hash
05269f5236bd89b66f6f4694abef6222 B-hash
05c63c450d4d2aeb23053a6b6f8275b0 B-hash
05df8d890eb18614a7d206b41453d306 B-hash
086e91fa95136ad1d814cac327543bf9 B-hash
08ac41ce00bf436a3dc23c4639d5f5ed B-hash
0925fb0f4c06f8b2df86508745dbacb1 B-hash
09a6d5b54e8c48ed33189ebf80df750d B-hash
09c0f3a3099b6b38ec36d001361edd98 B-hash
0a98bfa4bef1eb755c9c154963b69dc8 B-hash
0aa4e635a61038a621d9264e33b4bc3f B-hash
0b33a683812124d99de45c8e84dc9013 B-hash
0b6755e61840378952d69630b5c23e41 B-hash
0c6f8665dd18d5e86124c7bfbf3207f0 B-hash
0cdfea216d117cc97845edb9becaa498 B-hash
0d335de3c082627cd0c5699aa6012b7d B-hash
0f1dd1bef76967a6b06a5e0432ca947b B-hash
0f4432d54b28aafc976b5950d5337a5f B-hash
1285ff3c3a4089b43c275220d0c54442 B-hash
1286c678b3a821dec8c8cc1125bd2bc0 B-hash
12c64a64ae32fd3dff75347dde2aafac B-hash
13eb87290affe1360834037d9d400b39 B-hash
1475f178b6a86d3922b3e2c6fc59512d B-hash
14d17aaa3016a618a3ede92511fdd339 B-hash
16710c96d5ee6554bae6b881d9e136bd B-hash
17173efe0062114d2f993c7584520c1a B-hash
18575542dc4e9aa5aa8eeda14c26e46a B-hash
18a3bf5d8336f075ba503622880b5025 B-hash
19bc509f31f33a8f473ef9d671c1828b B-hash
1b517ea2aae0ed0a71f6e74e34e860e1 B-hash
1bc363e4ad9fc3be4953dd3eaa2bdb76 B-hash
1d1e2c7bb5a9fa546a6b0ae3c308db61 B-hash
1d69504a3d3ac32275fa4df8af25d1f7 B-hash
1ee30f7ecaf25af38cf684ca56b75cf2 B-hash
1f9cf9f1b5738198674a58a378b0d7e1 B-hash
218bbd007898e6b6fc754fe5c76668fc B-hash
21ed762e867cdabbb194aba878530c88 B-hash
22e10cbe46f406f5f1be0d613db4c2c3 B-hash
241e8465fd4d99a3f446d7f75957522b B-hash
24be0dd53bb43bb6cd08044b21a6aaaa B-hash
2500494616f4e7e1fa14fb3a46f468a7 B-hash
255b1aaff69668ac19906219d36c607c B-hash
271dad1471efd9bfc1a9dc05d6c30a24 B-hash
27fb01f7b3137921126ba086da4e6a2c B-hash
280531bb85998ff3dc7eb8d057525ffe B-hash
2997ec540932ea6b1fe0cab555b939d8 B-hash
299ca1f787d2340d34407ef084845260 B-hash
2a3aca1b002c6894c5edcc5e25a8f970 B-hash
2b3faf2856c220aa8b87632ac8bbd1a5 B-hash
2c4cabb4ca19ddf87c7f11bad44bdf05 B-hash
2cf5b5a9333d159b664725811465d1a3 B-hash
2d0318507bc4c1958913b31009de37f8 B-hash
2dbbadc147f11f2a856a648cdc332c0e B-hash
2e7a8e7e9d8d62c94d011e86de9cb12a B-hash
2f37912e7cb6e5c478e6dc3d0e381a24 B-hash
2f6c8da1c5f397bea7b300d28b3ad4ba B-hash
2f7918548b0aa59f23a1c16aa98e058b B-hash
30e81a30471c8f63b4688533252b56fa B-hash
320b4bd876004c1f0455f6f48b07e164 B-hash
32e474b21555d3946970c73648d88b36 B-hash
33a03ca462cec85e33dba0a1dcb9aee0 B-hash
356e11813fed7623a77610e836bcab65 B-hash
3599a78c7e99b451c00d3490f17f842f B-hash
35ae79bbe9f560b9634ce28b6569bd0f B-hash
35ed31733fbd7eeb4bfcc29e28a8496f B-hash
36ca00585d13d6911f086f0d2d496f96 B-hash
370947e6c802d21a732ac0cc024c4fcf B-hash
37b1e5809dd5a92a1d73f0e36af6791e B-hash
399c41047abd99b6e86d04b7dd444509 B-hash
3b266b165468b810cd456cdf88ca8619 B-hash
3b6a1f6ad4b8141b1aed8644d789706f B-hash
3b8ada8eda04f204164449a0fec0c296 B-hash
3b9cc9e174ad19380efef2744b7ff046 B-hash
3c058ca758f97cd2ae56df8a08f6a5a3 B-hash
3c9aa6dc8c4501ffa2798f044df53438 B-hash
3ce55c6994101faec00b5b7c2fee494f B-hash
3d41375ee362f4265ea2e90b9a08f0dd B-hash
3f637c1477442d92962be4ed427bb1cd B-hash
3f9e63ee4ae254778c69369fedf0d999 B-hash
3fb6039a572369d8d23fb99987ea21a9 B-hash
3fc2aa493492e6d7560ac8a5d69d7cbd B-hash
3fecd601404abda8f793ff5cc7ecf973 B-hash
41998b32ab11e474b167edf9dbb59b12 B-hash
4248d33b4273a80d11d6b3b6297851eb B-hash
4287353240e4e473e940a9289a48a333 B-hash
42acd0ed699d94602a0494f65a328615 B-hash
431f635eb68b936182d73bf6db06fc97 B-hash
43e128cfd0080a644e4ce98f84e29e8e B-hash
43f3a0a82397400a181c080992d35a5b B-hash
4602735e4a8754ff7f5a8785f9fd336a B-hash
467b90773754e35e1535a164140be005 B-hash
46b3b305530fb68f7a88b8453e4866ea B-hash
4890bf4c2d68657969e1cd11e0ae2648 B-hash
4899aa64923115886dd7cff5fff5ea1c B-hash
491db327f479a1a34898229811fa8a5d B-hash
49cc5f649e9098530ceeb2ea45346a9d B-hash
4b03db464b22536f700c99c3bd36e9e2 B-hash
4c136f1fbd9d7010369ae5644a8af4b0 B-hash
4cd5a29a7fc904aaaccbca9e30e0a865 B-hash
4cdfb56105b07f463d046fb425567cb0 B-hash
4ce22cee6abcb37db757e3fd60970090 B-hash
4dc2bcad31fb36f0913e441deeda8121 B-hash
4e5ed120295d9937de106fc703e64732 B-hash
4f13bd1db43e54d2cd2427a87ddb8e22 B-hash
507fa8a735417219d6b881834f660cb2 B-hash
5084ddfb90791516015c02c68d58fe5d B-hash
5106b19a9a29f0228782e0cafcd1cc2e B-hash
516c2981f3506ede7608ef2f273c6aed B-hash
534b3650b350b503e0f0f3bb6dd7598c B-hash
53d1e354104d5fc028d83aa519c1d1c6 B-hash
551aa0ab2b40fa7d891664caf0da879b B-hash
5621ed9c3b844654141c1a5ea7ca8c0d B-hash
578dbadaa5086e24d576328b7d4fedba B-hash
57bc1531a12179c5794d5c99b8442eba B-hash
582207d1f939f80bacc36a7790f40dc8 B-hash
582e827a539b6243f1c90b720fc143a4 B-hash
5aea3a20553a07fa50c4e815cf9ba7ff B-hash
5afdb5db234a1a13f5449be25f114999 B-hash
5ba8c4ef080e61310943fcb3c68bf002 B-hash
5bdb1b2313541f4cdc967391a4d150f4 B-hash
5c43e4ac0a6ad74844b2a310f1abc1c7 B-hash
5ca21c7986db58d44306e94f1ea6ae5c B-hash
5d1d18c697eefb03e120d9ef3f53dd28 B-hash
5e8d1334238dfaf5f11d7f2186989095 B-hash
5fee0adbac53eee82626daa5c5f99aba B-hash
607b46c73adb9a8bf03f5cd038871347 B-hash
628e4933864d3f712670658a93d11113 B-hash
62ccc75782d657850b85456ab48f2277 B-hash
633d92d13c2e8330cb4a3bc5130ab84f B-hash
640a64136516298ca80490d75a365695 B-hash
640fbb5f8938ea45204de6496240f82a B-hash
6414217bafb6f4c058773b0134e56e99 B-hash
64b865afdc34091a9c02700adeea5853 B-hash
655d1322795ed9532390ccf2e8f726f8 B-hash
659300af2f7c9e76f55464b21784a7f6 B-hash
659fb07c70034571de7a1b4b5ac86b01 B-hash
66060b82f299c14e18b65d21d277a49e B-hash
668731574fa9ad7567fb4854805a3fb2 B-hash
66e4538702381035dc62247080d4593f B-hash
6757128a636e2c509861d4f75ff128f1 B-hash
67a8b964857fe499b62442308a767e94 B-hash
6827e494a230a1483e19c205c532df17 B-hash
685e10f1393eaee470224b7fe1359202 B-hash
688ba2b3739ad54dee4139a727e457cc B-hash
6981364b6f1142363c151b11da66cc98 B-hash
6993ed604acd3e17a7bafcfdc2b27898 B-hash
6a0280f169d233a0bdc81ee6a70ef817 B-hash
6b8585ffbdf90c9b120ac1a79fa4dc51 B-hash
6bc6bacbbbacf369fea145d9044bd863 B-hash
6c5b2712a66db42b960aef5b87590033 B-hash
6e67fc27a49769f5218824d405d8fce5 B-hash
6f1c70d77e2571fe8a402aa1a8b7e8cd B-hash
6fd6aa2a4038903ed6d8e5771689f7c1 B-hash
700941e4fa44941b18844c9bfb3474dc B-hash
70320b5c719c70c860a55cec7ef173e8 B-hash
709d6eff31854fad212f83a91a900920 B-hash
70fef3c8073e97980b60b4ad8388ab5d B-hash
716978305d76e1e458c480d80f24caca B-hash
718179479dd9bd93beae66665e452c87 B-hash
718fcf2a80348110f519a000854e9e0e B-hash
71de04a952f8c09243c15a7fa5371073 B-hash
71fd3ea6c3e7e2f1eba9d7e911b1cffe B-hash
7228ac8f341f6ecaff45c8163f421f14 B-hash
76000c77ea9a214f5b2ae8cc387809db B-hash
7715864443576c824cdc9f39ffacd9dc B-hash
7b81fa4334cf0e520269f5484fef9fca B-hash
7bcdd0e5996e849d1068fcffdec81371 B-hash
7bee4b7d948433a58b18d2189d480a29 B-hash
7cd15bb31ff889e81f370d0535e02493 B-hash
7d00ea1262125b2b0469dd639b810823 B-hash
7d101cc3b87ac51c0c1ca8a4371bc84a B-hash
7d21e2b1b293f4176ba1d8abc2460328 B-hash
7e75928b5ce3dd41c9b9b1e67cff16d6 B-hash
7f7cc1a8d7a6bbe6a52c94bb7f41f727 B-hash
7f90942ace185ca1ba5610f6eddf3376 B-hash
8027234685f88f3b74c45b245c841843 B-hash
802a3965e42e75cc3dcd5f5523929859 B-hash
80ba5a336a4044c1406774d56e130e7e B-hash
80c58de2dbd1571228b538c9556cd29d B-hash
824bee27f10d5c81879657c8a2af9f0c B-hash
82c598abdf848c6fef03c63f5cf7feaf B-hash
834a274599aed64959b3b2bfe931af4c B-hash
83cdbc9aa1907d55dda3e28149e897cc B-hash
83d45d80682afa9b2526029b2bc2fb33 B-hash
850ac92dfa39f2391addc2d888c62ef8 B-hash
8548dd501aaf132b134aa3849e15d2aa B-hash
85873c12599490a0f7db691b0c5179ae B-hash
860d5840c3b1a750d8c4e6bc68ecfbab B-hash
867d80bc1c369ca7ee429c727d2c5fea B-hash
875cb4844bc03f6da7a60553632c7678 B-hash
888eadff6982de01c60891ce185473b7 B-hash
88c0e5a4ca408ac12acaaf7a9ef9eb49 B-hash
894ef915af830f38499d498342fdd8db B-hash
8a413af90665ca7909bcdcf19cd566ed B-hash
8ac64b904c188ef6b73dbc5073cee1a9 B-hash
8b69f0a948c32288f3fab4ed2845cb1b B-hash
8ba366ef5ecd802c82289dcea22b2146 B-hash
8c148fe80ae705af284b92f1c283013a B-hash
8c3a791ce682e3c5da5bcfbce261eeaa B-hash
8c76de0a8ac79536b96619613960681c B-hash
8d3a6b78118b647a7f31f06a46c27fd4 B-hash
8dc7eb49fe1fbf490f90c153a71c60a5 B-hash
8e2e709c01ccb286c51ac9e592eea48a B-hash
8e53ad954f05d2c3f57b19b1ecb0fea0 B-hash
8f8e948a2f9afd7ece6dc6603cfbd56a B-hash
8fbbf38c053dbb0da3dd2fd6af4869d2 B-hash
905d5cd372fb22dd5f9804adb2d2787b B-hash
9157d078effa4b727180c40bedb74ef6 B-hash
920dffe40787f1f3fdb24548b4a210db B-hash
92785f445f366ed548388b1af6b01f9c B-hash
9327f1eefb18fde7f622fc2efbbbdb4b B-hash
939e07685fec28a15f88786b097bb14b B-hash
9400950fa381ba1750c914fa9e6fd85e B-hash
942b1ca8c3c64be1e4c40e26c9e39ad8 B-hash
962c52436706b5c226894de0436b860e B-hash
96ee5acbe155f37ff1604b4fd259e55f B-hash
96f31d6fda587b43887e846876e5c399 B-hash
975c718bf93ca5d0693bb0d4c7e42d1e B-hash
99b58e416c5e8e0bcdcd39ba417a08ed B-hash
9a58902740c5b73eb6a68a126ac6ac55 B-hash
9a847c1f54359ffd3c335e97600f6f5d B-hash
9aca099f7cd3b3b29551b67af48467d1 B-hash
9be590614e2407dc144ad6c100a2873a B-hash
9bf4683c09a2d60294ff79ce026f4e64 B-hash
9cc15358d6ce18150dbee6be3281151d B-hash
9cd1e3b67540bdc2fc4a3835e170bc65 B-hash
9e6b8b265f05302eca455ce8ea10a3aa B-hash
9fcb233ee18df6c19b1ad3922dd41a2a B-hash
9fd0e94fce1543b75b44414a61b252b0 B-hash
a01ea69e4c10721ec088676cef67d8bd B-hash
a19e68e72084d867a39776faaa6f5fce B-hash
a1fa946523928c16340cf40daa2ffb53 B-hash
a26a85c33ddf57d720040629931be174 B-hash
a4847e655c817e3c5112e888a2877f4d B-hash
a4d476fb7b084bd01a847ab7e0d839b5 B-hash
a55f6c8b795ccdc469b9b67b22ddc88b B-hash
a637ea307380ba21a355c3cffd37639a B-hash
a6cba31fcca49ff9ed6fd9894644de9e B-hash
a76f0fada1602e9c119cba24306442b4 B-hash
a98d2c90b9494fc885c7cd35d43666ea B-hash
a9c20499d43f9674cc37dbfa81381203 B-hash
a9d2caa6ebbfd5be071748e59e754cf4 B-hash
a9e0a604e5b8ed5f4f286c3355d7a0fb B-hash
aaa01f776acabdf9f07ea3eaff1695d6 B-hash
ac2b219ede57f9d14cdce38e987862aa B-hash
ac9e0b2af215821f7223b6eaeaea03db B-hash
ad95f613fc4b644bd5e3230eb0b5dbcc B-hash
adb97252b05a6e82697bf93c347bdf25 B-hash
aea5dc22e706c836d056f4ba1f13dea3 B-hash
af285fa9a141f422b8ccbfb4e9a00054 B-hash
b18cabead7248e8156230c71399b79c9 B-hash
b19ef1134f54b4021f99cc45ae1bc270 B-hash
b1c540b4b9c8a87a1e87a76ed289f18d B-hash
b2784e4dc6e602d9d6bf09325bba8c4e B-hash
b29556856203049b9e7b05e01f5ae73f B-hash
b3056919871fc01a1ed3294e2014e0c4 B-hash
b41c02eb41070e0a2e459abf2fc39b69 B-hash
b44cd1fa5d8beb08519bbe0c1d796b0f B-hash
b457372a87597b746ce69e05c4a7d3fa B-hash
b653012d2bfa4e3419d97eb9f2e5ed4a B-hash
b665ea35f8f7954657eed1e54517843d B-hash
b68eadb2a8069c7e88535e1ebfb4be0a B-hash
b8c83b3549ebb24b3e00dd23c2aa050a B-hash
b8f77674d292d205f8f5cf6c3f3c34df B-hash
b8fdf06f78341581870477574e2b08c3 B-hash
b921e0d11127af9613804c63cddd86ca B-hash
b9367aba4f267b82a838223df016bd6b B-hash
b96b79f4f1b4306ac2c63fc988305fb0 B-hash
ba700e3a83fec3cc984e1fb572aa0add B-hash
bbb4bdd1d7e8589d145163f1efd458f5 B-hash
bbbf285e8344f7df330f93c7c3baf27f B-hash
bbccf8643368c80dd083fb92d67d00be B-hash
bbdce1e1991f292d366097a743da3724 B-hash
bcc6addece28265390b2d535d65c49b8 B-hash
bd6481ed6dfe67ba9f2f8f26e2cee722 B-hash
bdf512d5eef853d07c0db345345e3db7 B-hash
be3799da210edb81143d609e66e5b7ff B-hash
be54e3660bf928b8b5f764f5cdfdc4da B-hash
bf18ef997b7d589f031f47799a33f27b B-hash
bf65727accaa53d65c31ed5b582053c5 B-hash
bf778439895829ff986207900bfcfe02 B-hash
c1438390098e4dc7bb8b52efcf1d2465 B-hash
c1919e6f2e05feb9dc9b6ab9f81dcb2f B-hash
c243a7c1cf23b91f73100bb9e947439e B-hash
c32696b255bac4b849fc249e56944a91 B-hash
c376aecf43bf021b6408ca99cd31da01 B-hash
c5062bbbb15911a63de77a66773874d9 B-hash
c63cc0a8b0b3a70f7b835a3fff9f02a5 B-hash
c8607553e37cc1fc870572670c1910f5 B-hash
c89d4d40e4b68a9952121b62b0dda920 B-hash
c9570396c897e02ec8aa195c6241f945 B-hash
c9a32616f89dc953486bd1b5d83359ec B-hash
c9b4c4d65298dc10be6784d0f0ad8519 B-hash
c9f19071bac9d4eb3b08b4017c0d9c4d B-hash
cac3bc3039cd73935051ad8df2e53d34 B-hash
cb40ff3b3ed8c1966defbe1dafdd1326 B-hash
cca75af9786d7364866f40b80dddcc5c B-hash
cd5f3dbea197dc5afb673e42f0e9c3fe B-hash
cdc0c4fdc649dec017ace0f2898068d0 B-hash
cec766518fa5b607157e92e9c24c0d03 B-hash
cf5356cdf42d264d5213cce4cd415f0b B-hash
cf96139290c09963a32506cd85825ed3 B-hash
d3174652816010a7f6d8f4523ee3a077 B-hash
d4036f03c760084cc677edf4ee6c4a39 B-hash
d46d261ec92daf703cd584f10037198c B-hash
d5027d35c8bd9e867113bd4a1edb931f B-hash
d58323fb222b9ff681c0982ba286a296 B-hash
d6b1989d9c271b8575326e4fca159ae8 B-hash
d6b198eda724e2b3367502a6a2232939 B-hash
d6b467c92256094f720e9fc75f149737 B-hash
d6d5aeb79899485f5734bf8847782266 B-hash
d6e98d062d7900c6fe9a6d7f0b1d7fec B-hash
d6ff4333eb1a2305d5b6cf4705213393 B-hash
d795292ea23217480ad92939daf6dd22 B-hash
d83055efe66377067ce99d99c706f19a B-hash
d8f7aaad3677fac1cde911c7362c2b69 B-hash
d910d21bd54b63ef61b3f250fe73dcc6 B-hash
da451674bb68804b390bd7413691c91e B-hash
dab17bcceae6f32eae5d800d0d3f9e46 B-hash
db6ae6da64f14168b3624e26191277cf B-hash
db7d3724e5f004168a1a56f6b9de3cd5 B-hash
dd5aad5d66bc96e5ac60cbe5d132c2ec B-hash
de5eeb9847a5fbc1a6cbb4cfb8bb6aa0 B-hash
df53ce3797932d9e62ceaa760a3f0e3e B-hash
dfaa6250dc947602d5dc200e503f23a5 B-hash
dff3a274e5fa35013601c7985bf13d56 B-hash
dff7ac111e48115e208c2649b94b1115 B-hash
e0b3a0fd042ff50e0de22725864775b8 B-hash
e1117ec1ea73b6da7f2c051464ad9197 B-hash
e2494eba419891c0c101af74eb8c029c B-hash
e2620e1cf89830e8de1e8c4530829a15 B-hash
e27f0975fd3278e7303102783767c508 B-hash
e2a557b39231ee91724c150e3ec4b493 B-hash
e2be37df12f7b98b2b73197d77773263 B-hash
e4255f51a871a95baa10b6b2c4ed2470 B-hash
e62bb947d72d12311890f2e07eb6ac8b B-hash
e6446d52e9f4b5c2c5a9ac850281cae8 B-hash
e649b8b9e541406446da47d8d0a91385 B-hash
e6ffb1c6e1508f474a69f091435454ce B-hash
e85863b1de035814b4b01a2b6c477dd1 B-hash
e90b037f1cbc79796fd8b1f6382c8483 B-hash
e93a4f4872bf6cd8c3f0eed6017a8d41 B-hash
ea823850b777993d636e4a565568f734 B-hash
ead35eab94820d5a34f185d0b26b7930 B-hash
ebe291e968eb5a86b4963d27352bc525 B-hash
eced29c71867e375aed0da408d6b07f4 B-hash
ed665cf8a48f08f8b4fed8bbf9d2d998 B-hash
ee998128e20971ca4296a8a73ed79f43 B-hash
eea7ae4eb726c3e05f187110090adb18 B-hash
ef10f4f11032d48f7e82c0a788c0f489 B-hash
efaadcfa4271c50927ab817e0c4a0bc3 B-hash
f0a00cfd891059b70af96b807e9f9ab8 B-hash
f15cff24d8a3a9ffce590cc8e69baec9 B-hash
f1c4b919fdf008a8400189562f5e2fba B-hash
f29cb80bde4af21c226596e9d125795d B-hash
f2f2cad79dcfb356db7b2485c7a27f03 B-hash
f643fa851203e9159c9dc50e4ab8d81e B-hash
f74ec871c77e4b5e5b2ae0917b1f0f21 B-hash
f7820d429d3185ad00e6758c343e29ce B-hash
f82d3b270b16780044817978f4f3fe1a B-hash
f9d2c3e8f81b9c44a1837478b2a98e5e B-hash
fb0b900de6d286321fd6d20c6c4f5679 B-hash
fbb0c14cacc60fdd393fb5889d5a0b57 B-hash
fc97b89541b149e0dd9937ba876b3ee1 B-hash
fd130b2bce93caf18bc23f1526daae99 B-hash
fd31f952637370a30d74c2a65ba8d2cd B-hash
fd9b5c35c042a6c462187067fb869aac B-hash
fde5e109bfab33964564f387f8940030 B-hash
fe568a370aa3d2c78125ab37c16484d1 B-hash
System O
based O
indications O
of O
possible O
compromise O
by O
the O
comment O
crew O
attackers O
. O

The O
samples O
appear O
as O
different O
payloads O
but O
further O
basic O
static O
analysis O
allowed O
us O
to O
discover O
that O
they O
are O
the O
same O
malware O
sample O
: O
The O
first O
two O
samples O
are O
identical O
, O
with O
the O
unique O
difference O
that O
the O
second O
one O
is O
packed O
using O
the O
UPX O
tool O
. O

The O
database O
management O
functionality O
is O
impressive O
and O
helpful O
to O
the O
first-time O
user O
. O

In O
this O
case O
, O
the O
encrypted O
configuration O
file O
will O
begin O
with O
a O
4-byte O
value O
specifying O
the O
length O
of O
the O
included O
RC4 O
key O
. O

OMPARISON O
OF O
ODULE O
............................................................................................................................... O
8 O

Finally O
, O
the O
CozyDuke B-malware.drop
toolset O
includes O
tools O
and O
scripts O
– O
some O
custom-written O
, O
others O
based O
on O
openly O
available O
tools O
– O
that O
are O
used O
for O
purposes O
such O
as O
gathering O
further O
information O
from O
infected O
hosts O
or O
for O
infecting O
additional O
hosts O
in O
the O
same O
target O
organization O
. O

At O
least O
, O
I O
hope O
not O
. O

We O
observed O
the O
DragonOK B-malware.infosteal
attacker O
employ O
this O
tool O
against O
targets O
in O
Japan O
and O
Taiwan O
( O
e.g. O
57e3d002542e07f2eb09fd2b1b0ee-ab2 B-hash
) O
, O
as O
also O
noted O
by O
Secureworks O
. O

Typically O
, O
the O
final O
payload O
consists O
of O
shellcode O
that O
provides O
backdoor O
functionality O
to O
the O
system O
or O
stages O
additional O
tools O
. O

case O
' O
v O
' O
: O

Figure O
15 O
: O
The O
content O
of O
the O
file O
seems O
relatively O
benign O
, O
especially O
if O
with O
a O
safe-sounding O
word O
like O
' O
Security O
' O
as O
the O
shell O
password O

About O
the O
Author O

The O
SFX B-malware.drop
dropper O
contained O
multiple O
custom O
executable O
files O
, O
as O
well O
as O
legitimate O
Microsoft O
Visual O
C++ O
Runtime O
Library O
files O
, O
which O
are O
part O
of O
the O
codebase O
used O
to O
develop O
and O
required O
to O
execute O
the O
backdoor O
code O
. O

Analysis O
of O
the O
file O
with O
MD5 O
Hash O
: O
75D3D1F23628122A64A2F1B7EF33F5CF B-hash

' O
Due O
to O
the O
high O
volatility O
of O
the O
ruble O
exchange O
rate O
the O
Bank O
of O
Russia O
sends O
rules O
of O
trading O
on O
the O
currency O
market O
. O

Malicious O
link O

• O
Code O
compiled O
during O
the O
normal O
working O
day O
in O
the O
Moscow O
time O
zone O
and O
within O
a O
Russian O
language O
build O
environment O
. O

Complicated O
defenses O
require O
more O
versatile O
tools O
As O
many O
traditional O
banking O
and O
financial O
institutions O
have O
improved O
their O
security O
practices O
, O
perhaps O
attackers O
have O
had O
a O
much O
more O
difficult O
time O
developing O
automation O
in O
their O
Trojans B-malware.backdoor
to O
cover O
all O
variations O
of O
these O
defenses O
; O
as O
such O
, O
RATs B-malware.backdoor
provide O
more O
versatility O
and O
effectiveness O
, O
at O
the O
expense O
of O
scalability O
. O

Cylance O
found O
that O
the O
following O
three O
full O
file O
paths O
were O
commonly O
used O
by O
this O
particular O
backdoor O
: O
• O
% O
AppData%\Reader.exe O
• O
% O
AppData%\Notron.exe O
• O
% O
AppData%\SCSI_Initiarot.exe O
Cylance O
also O
identified O
an O
earlier O
sample O
, O
which O
took O
advantage O
of O
a O
self-extracting O
RAR O
and O
a O
side O
loading O
vulnerability O
in O
the O
legitimate O
Microsoft O
Resource O
Compiler O
, O
' O
RC.exe O
. O
' O

Software O
Community O
Vulnerability O
Reports O
Additional O
Resources O
Microsoft O
to O
SID O
Mapping O
Archive O
Shared O
Object O
Rule O
Generator O
IP O
Blacklist O
Download O
AWBO O
Exercises O
About O
Talos O
Join O
Our O
Team O
Contact O
Blog O

The O
infection O
ID O
, O
if O
present O
, O
must O
be O
decoded O
by O
XOR'ing O
each O
byte O
of O
the O
string O
with O
a O
static O
byte O
value O
( O
typically O

It O
's O
also O
worth O
noting O
that O
the O
standard O
list O
includes O
quite O
a O
lot O
of O
software O
which O
is O
less O
relevant O
to O
security O
( O
examples O
include O
WinRAR O
, O
iTunes O
and O
WinZip O
) O
. O

Hopefully O
, O
simpler O
verification O
systems O
than O
the O
current O
batch O
of O
PGP O
and O
SSL O
applications O
will O
arise O
to O
be O
adopted O
in O
larger O
numbers O
. O

return O
= O
127 O
; O
! O

Recently O
, O
we O
have O
detected O
malware O
used O
by O
the O
Carbanak B-malware.infosteal
group O
in O
the O
following O
countries O
, O
among O
others O
: O
United O
States O
of O
America O
Germany O
United O
Arab O
Emirates O
As O
described O
in O
this O
blog O
post O
, O
the O
gang O
does O
n't O
use O
just O
one O
malware O
family O
to O
carry O
out O
its O
operations O
but O
several O
. O

These O
2 O
values O
, O

The O
C2 O
domain O
qhavcloud[.]com B-url.cncsvr
and O
the O
hard O
coded O
IP O
address O
91[.]205[.]173[.]3 B-ip.unknown
were O
also O
found O
to O
be O
associated O
with O
another O
attack O
campaign O
which O
targeted O
the O
senior O
army O
officers O
. O

The O
connection O
between O
those O
pieces O
of O
malware O
and O
the O
group O
described O
in O
CSE O
slides O
has O
been O
convincingly O
established O
, O
for O
example O
by O
Paul O
Rascagnères O
( O
G O
Data O
) O
. O

The O
format O
of O
this O
configuration O
is O
straightforward O
to O
reverse O
. O

noteworthy O
that O
in O
most O
of O
the O
cases O
the O
same O
submitters O
uploaded O
samples O
belonging O
to O
different O
APT B-malware.unknown
campaigns O
. O

TRITON B-malware.infosteal
trilog.exe O
Main O
executable O
leveraging O
libraries.zip O
library.zip O
Custom O
communication O
library O
for O
interaction O
with O
Triconex B-malware.unknown
controllers O
. O

Where O
possible O
Symantec O
has O
provided O
details O
on O
the O
C O
& O
C O
accounts O
used O
by O
Inception B-malware.backdoor
to O
the O
affected O
cloud O
providers O
. O

Controversially O
, O
Ginbot O
7 O
was O
designated O
a O
terrorist O
group O
by O
the O
Ethiopian O
Government O
in O
2011 O
. O

In O
this O
case O
, O
however O
, O
the O
source O
was O
modified O
– O
the O
process O
injection O
to O
svchost.exe O
was O
added O
to O
its O
functionality O
. O

The O
Uranio O
Cluster O

fraud O

You O
should O
not O
act O
upon O
the O
information O
contained O
in O
this O
email O
without O
obtaining O
specific O
professional O
advice O
. O

This O
conclusion O
is O
derived O
from O
the O
file O
names O
and O
file O
contents O
that O
are O
written O
in O
Vietnamese O
, O
as O
shown O
in O
the O
examples O
below O
: O

Regards O
, O
Diosdado O
Procurement O
Officer O
Mobile O
: O
+966 O
54 O
073 O
5573 O
Tel O
. O

So O
while O
potentially O
making O
us O
safer O
in O
the O
short-term O
, O
exposure O
often O
forces O
a O
Darwinian O
evolution O
in O
malware O
. O

Installer O
resources O
named O
for O
french O
and O
dutch O
versions O
, O
along O
with O
32-bit O
versus O
64-bit O
compiled O
executables O
were O
provided O
over O
the O
summer O
: O
hxxp://www.ralrab[.]com/rar/winrar-x64-531.exe O
hxxp://www.ralrab[.]com/rar/winrar-x64-531fr.exe O
hxxp://www.ralrab[.]com/rar/winrar-x64-531nl.exe O
hxxp://www.ralrab[.]com/rar/wrar531.exe O
hxxp://www.ralrab[.]com/rar/wrar531fr.exe O
hxxp://www.ralrab[.]com/rar/wrar531nl.exe O
hxxp://ralrab[.]com/rar/winrar-x64-531.exe O
hxxp://ralrab[.]com/rar/winrar-x64-531nl.exe O
hxxp://ralrab[.]com/rar/wrar531fr.exe O
hxxp://ralrab[.]com/rar/wrar531nl.exe O
hxxp://ralrab[.]com/rar/wrar53b5.exe O

' O
Pending O
' O
, O
if O
the O
command O
string O
matches O
with O
string O
' O
Pending O
' O
then O
the O
extracted O
filename O
( O
in O
this O
case O
the O
extracted O
filename O
is O
' O
testfile O
' O
) O
from O
the O
C2 O
response O
is O
concatenated O
with O
' O
.exe O
' O
as O
shown O
below O
. O

The O
file O
on O
the O
hard O
drive O
is O
encrypted O
; O
specifically O
, O
the O
data O
is O
XORed O
with O
the O
key O
0x66 O
. O

If O
you O
have O
received O
this O
communication O
in O
error O
, O
please O
notify O
the O
Western O
Union O
sender O
immediately O
by O
replying O
to O
this O
message O
and O
delete O
the O
original O
message O

Data O
exfiltration O
is O
assumed O
to O
be O
time O
triggered O
. O

9a2e510de8a515c9b73efdf3b141f6c2 B-hash
a6b862f636f625af2abcf5d2edb8aca2 B-hash
0327859be30fe6a559f28af0f4f603fe B-hash

The O
potential O
victim O
in O
this O
attack O
first O
receives O
a O
message O
from O
an O
unknown O
source O
, O
in O
this O
case O
, O
a O
Gmail O
account O
with O
a O
nondescript O
name O
. O

Which O
corresponds O
to O
ordering O
an O
HTTP O
flood O
, O
a O
UDP O
flood O
, O
and O
a O
TCP O
flood O
, O
respectively O
, O
against O
target O

jIRCii O
Scriptable O
Internet O
Relay O
Chat O
client O
for O
Windows O
, O
MacOS O
X O
, O
and O
Linux O
. O

This O
malware O
is O
particularly O
interesting O
for O
us O
because O
it O
contacts O
a O
command O
and O
control O
with O
the O
name O
' O
marina-info.net B-url.unknown
' O
a O
clear O
reference O
to O
the O
Italian O
Military O
corp O
, O
Marina O
Militare O
. O

Cyber O
Resilience O
Review O
( O
CRR O
) O
is O
a O
no-cost O
, O
voluntary O
assessment O
to O
evaluate O
and O
enhance O
cybersecurity O
within O
critical O
infrastructure O
sectors O
, O
as O
well O
as O
state O
, O
local O
, O
tribal O
, O
and O
territorial O
governments O
. O

Agent.RUI O

We O
would O
like O
to O
point O
them O
towards O
the O
example O
established O
by O
Green O
Simurgh O
, O
who O
promptly O
posted O
a O
multilingual O
warning O
to O
their O
website O
when O
a O
malicious O
repackaging O
of O
their O
tool O
was O
found O
to O
be O
targeting O
Syrian O
users O
. O

iafbsnl.doc O

YouTube O
. O

What O
the O
analysts O
eventually O
had O
was O
a O
very O
detailed O
view O
of O
the O
specific O
tactics O
employed O
by O
this O
adversary O
; O
and O
a O
window O
into O
a O
plan O
for O
a O
hack O
that O
was O
even O
larger O
than O
originally O
believed O
, O
much O
larger O
. O

Grey O
Lambert O
attackers O
inserted O
false O
flag O
and O
reduced O
SPLM B-malware.backdoor
modules O
3. O
a O
new O
and O
unrecognized O
, O
full O
variant O
of O
SPLM B-malware.backdoor
attempted O
to O
inject O
module O
code O
into O
memory O
and O
deleted O
itself O
4. O
an O
unknown O
new O
powershell O
script O
or O
legitimate O
but O
vulnerable O
web O
app O
was O
exploited O
to O
load O
and O
execute O
this O
unusual O
SPLM B-malware.backdoor
code O
In O
all O
likelihood O
, O
the O
last O
option O
is O
accurate O
. O

These O
attacks O
are O
likely O
performed O
by O
the O
same O
attacker O
, O
as O
the O
malware O
in O
question O
communicate O
with O
the O
same O
command- O
and O
control O
structures O
, O
and O
in O
many O
cases O
are O
signed O
using O
the O
same O
digital O
certificate O
. O

Next O
, O
call O
len O
function O
: O
if O
found O
to O
be O
BSTR O
type O
, O
vbscript O
will O
assume O
that O
the O
forward O
4 O
bytes O
( O
0x11223344 O
) O
is O
the O
address O
memory O
to O
store O
the O
length O
. O

There O
were O
only O
four O
possible O
IP O
addresses O
that O
the O
sample O
analyzed O
could O
connect O
to O
There O
were O
only O
four O
possible O
IP O
addresses O
that O
the O
sample O
analyzed O
could O
connect O
to O
based O
on O
the O
strings O
found O
in O
the O
file O
' O
id O
' O
. O

With O
this O
understanding O
, O
GReAT O
researchers O
were O
able O
to O
recognize O
similarities O
in O
obfuscation O
and O
development O
traits O
leading O
back O
to O
widely­reported O
but O
little O
understood O
variants O
on O
a O
sample O
in O
2015 O
, O
which O
searched O
for O
prominent O
leaders O
and O
secret O
documents O
involving O
them O
. O

Strings O
are O
well O
organized O
and O
concise O
. O

The O
VBS O
code O
unzips O
the O
archive O
, O
changes O
the O
extension O
of O
the O
legitimate O
Windows O
tool O
from O
.png O
to O
.exe O
, O
and O
renames O
the O
malicious O
DLL O
as O
cryptui.dll O
. O

So O
at O
this O
point O
, O
we O
know O
that O
the O
decryption O
key O
is O
composed O
of O
the O
prefix O
# O
KCMDDC42F O
# O
concatenated O
with O
the O
suffix O
, O
yielding O
# O
KCMDDC42F O
# O
-890 O
. O

This O
level O
of O
engagement O
and O
interaction O
, O
particularly O
in O
light O
of O
the O
reduction O
of O
sanctions O
, O
and O
the O
thawing O
of O
relations O
between O
Iran O
and O
the O
West O
following O
the O
2015 O
JCPOA O
, O
was O
expected O
between O
academia O
. O

In O
this O
case O
the O
attackers O
used O
the O
TextBox O
within O
the O
UserForm O
to O
store O
the O
malicious O
executable O
content O
. O

The O
main O
function O
of O
the O
dropper O

The O
shortened O
link O
statistics O
page O
enables O
us O
to O
learn O
about O
the O
scope O
and O
the O
targeting O
of O
this O
threat O
actor O
. O

case O
' O
k O
' O
: O

This O
research O
was O
facilitated O
by O
the O
PassiveTotal O
for O
threat O
infrastructure O
analysis O
. O

This O
section O
focuses O
on O
different O
functionalities O
of O
the O
malware O
Malware O
triggers O
the O
download O
functionality O
by O
connecting O
to O
the O
C2 O
server O
and O
making O
a O
request O
to O
either O

Malware O
referenced O
in O
relation O
to O
these O
domains O
is O
for O
example O
: O
md5 O
: O
6f9f2e57eb06c5385f7e9370a71aa34b B-hash
. O

Below O
is O
a O
screen O
shot O
of O
the O
malicious O
code O
references O
found O
pre-pended O
to O
a O
JavaScript O
file O
on O
the O
website O
named O

Reply-To O
X-Originating-Ip O
Message O
body O
Sarah O
Alexander O
< O
mthomas3@mybluelight[.]com O
> O
Invitation O
Sun O
, O
4 O
May O
2014 O
08:44:53 O
GMT O
Invitation.jar B-malware.infosteal
marvinflames@gmail.com O
87.117.232[.]203 B-ip.unknown

After O
deobfuscation O
, O
we O
can O
see O
that O
the O
payload O
is O
written O
in O
the O
Perl O
programming O
language O
. O

The O
discovery O
of O
the O
hacker O
's O
single O
mistake O
in O
tradecraft O
was O
indeed O
a O
powerful O
catalyst O
, O
and O
lead O
to O
the O
discovery O
of O
a O
treasure O
trove O
of O
new O
indicators O
. O

The O
user O
logged O
on O
on O
workdays O
, O
occasionally O
on O
Saturdays O
, O
but O
never O
on O
Sundays O
. O

The O
agent O
starts O
by O
selecting O
a O
C O
& O
C O
server O
from O
a O
hardcoded O
list O
, O
then O
sends O
a O
hello O
message O
and O
starts O
two O
main O
communications O
threads O
: O
One O
for O
receiving O
commands O
from O
the O
C O
& O
C O
server O
, O
in O
an O
infinite O
GET O
loop O
. O

generateUrlQuestion O
: O
] O

OceanLotus O
was O
responsible O
for O
launching O
targeted O
attacks O
against O
human O
rights O
organizations O
, O
media O
organizations O
, O
research O
institutes O
, O
and O
maritime O
construction O
firms O
. O

' O
Private O
Security O
Group O
Says O
Russia O
was O
Behind O
John O
Podesta O
's O
Email O
Hack O
. O
' O

Decryption O
key O
is O
calculated O
based O
on O
the O
destination O
URL O
and O
the O
encoding O
key O
of O
the O
configuration O
information O
. O

We O
deployed O
our O
IR O
team O
and O
technology O
and O
immediately O
identified O
two O
sophisticated O
adversaries O
on O
the O
network O
– O
COZY O
BEAR O
and O
FANCY O
BEAR O
. O

What O
does O
the O
Poseidon B-malware.infosteal
Group O
do O
? O

Influence O
operations O
, O
also O
frequently O
called O
' O
information O
operations O
, O
' O
have O
a O
long O
history O
of O
inclusion O
in O
Russian O
strategic O
doctrine O
, O
and O
have O
been O
intentionally O
developed O
, O
deployed O
, O
and O
modernized O
with O
the O
advent O
of O
the O
internet O
. O

( O
MMS O
) O
If O
the O
expected O
answer O
is O
received O
, O
it O
continues O
, O
sending O
an O
MMS O
request O
Thereby O
, O
the O
component O
compiles O
a O
list O
of O
object O
names O
in O
a O
Virtual O
Manufacturing O
Device O
( O
VMD O
) O
Next O
, O
this O
component O
enumerates O
the O
objects O
discovered O
in O
the O
previous O
step O
and O
sends O
the O
device O
domain-specific O
requests O
with O
each O
object O
name O
This O
enumerates O
named O
variables O
in O
a O
specific O
domain O
Afterwards O
, O
the O
61850 O
payload O
parses O
data O
received O
in O
response O
to O
these O
requests O
, O
searching O
for O
variables O
that O
contain O
following O
combinations O
of O
strings O
: O

This O
spear O
phish B-malware.infosteal
contained O
a O
malicious O
Word O
document O
that O
exploited O
CVE-2012-0158 B-malware.backdoor
. O

Its O
behavior O
is O
very O
similar O
to O
the O
versions O
detected O
in O
attacks O
associated O
with O
the O
Iron O
Tiger O
APT O
group O
. O

kb681234.exe O

Should O
an O
installed O
product O
be O
found O
, O
it O
will O
be O
compared O
to O
a O
predetermined O
list O
of O
product O
names O
. O

Decoy O
Document O
Title O
: O

It O
does O
not O
take O
long O
to O
come O
across O
the O
following O
routine O
, O
which O
we O
will O
label O
ComputeKeySuffix_sub_48F52C O
( O
) O
: O

Following O
big O
announcements O
and O
public O
exposures O
of O
targeted O
attack O
operations O
, O
APT O
groups O
behave O
in O
a O
predictable O
manner O
. O

공격자는 O
공격 O
대상인 O
기관 O
또는 O
기업에서 O
사용하는 O
중앙관리 O
솔루션을 O
파악한 O
후 O
이를 O
분석하여 O
취약점을 O
찾아 O
공격에 O
이용한다 O
. O

SWIFT O
network O
also O
generates O
confirmation O
messages O
, O
and O
these O
messages O
are O
sent O
by O
the O
software O
for O
printing O
. O

Author O
: O

Table O
A-4 O
: O
The O
listed O
process O
names O
are O
running O
. O

hxxp://www.cnbv.gob[.]mx/Prensa/Paginas/Sanciones.aspx B-url.unknown

This O
allows O
the O
client O
to O
specify O
which O
specific O
tunnel O
data O
is O
transmitted O
to O
as O
well O
as O
telling O
the O
client O
which O
tunnel O
is O
returning O
data O
. O

hosted O
a O
malware O
file O
called O
program_stream_film_for_watch.exe B-malware.unknown
. O

The O
DDE O
object O
simply O
executes O
Microsoft O
calc O
in O
the O
detected O
sample O
. O

2016 O
. O

< O
> O
30 O
. O

We O
identified O
a O
MacOS O
backdoor O
( O
detected O
by O
Trend O
Micro O
as O
OSX_OCEANLOTUS.D O
) O
that O
we O
believe O
is O
the O
latest O
version O
of O
a O
threat O
used O
by O
OceanLotus O
( O
a.k.a. O
APT O
32 O
, O
APT-C-00 O
, O
SeaLotus O
, O
and O
Cobalt O
Kitty O
) O
. O

Be O
sure O
to O
put O
a O
valid O
SID O
in O
before O
implementing O
and O
test O
the O
signature O
for O
performance O
. O

Besides O
being O
encrypted O
, O
this O
protocol O
is O
somewhat O
unusual O
in O
that O
the O
C O
& O
C O
sends O
the O
first O
payload O
; O
it O
is O
much O
more O
common O
for O
the O
bot O
to O
send O
the O
first O
payload O
. O

Once O
a O
user O
has O
lost O
physical O
access O
to O
their O
phone O
, O
it O
's O
really O
a O
case O
of O
the O
attacker O
having O
a O
much O
easier O
playing O
field O
for O
malicious O
activity O
. O

Of O
note O
, O
these O
phishing O
emails O
were O
sent O
to O
users O
at O
two O
separate B-malware.backdoor
and O
unrelated O
organizations O
. O

The O
first O
place O
from O
where O
the O
executable O
looks O
to O
load O
the O
DLL O
is O
its O
own O
directory O
. O

It O
appear O
as O
if O
downloading O
the O
module O
requires O
manual O
approval O
, O
indicating O
the O
need O
for O
a O
human O
analyst O
or O
handler O
in O
the O
loop O
. O

Here O
is O
the O
PDB O
of O
the O
sample O
: O

Here O
, O
the O
cipher O
uses O
a O
modolo O
pointer O
arithmetic O
along O
with O
a O
decryption O
key O
per O
blob O
. O

The O
Fidelis O
team O
updated O
Fidelis O
XPS O
advanced O
threat O
defense O
system O
with O
additional O
rules O
to O
reflect O
current O
analysis O
findings O
associated O
with O
this O
malware O
. O

Over O
80 O
payloads O
and O
numerous O
domains O
were O
observed O
in O
this O
operation O
– O
all O
of O
which O
were O
undetected O
by O
traditional O
security O
products O
deployed O
in O
the O
company O
's O
environment O
at O
the O
time O
of O
the O
attack O
. O

The O
following O
is O
a O
screenshot O
of O
the O
Unrecom B-malware.backdoor
RAT B-malware.backdoor
v.2.0 O
( O
Version O
in O
Spanish O
) O
: O
Over O
time O
, O
various O
reports O
in O
the O
community O
have O
documented O
the O
evolution O
of O
this O
tool O
. O

Once O
a O
system O
has O
been O
compromised O
, O
the O
attacker O
may O
install O
one O
or O
more O
backdoors O
. O

We O
did O
a O
quick O
analysis O
of O
the O
malware O
and O
it O
immediately O
stood O
out O
because O
of O
certain O
unusual O
things O
that O
are O
not O
very O
common O
in O
the O
APT O
world O
. O

The O
third O
hash O
( O
93ebc337c5fe4794d33df155986a284d B-hash
) O
is O
a O
DroidJack B-malware.backdoor
, O
a O
malicious O
attacking O
platform O
, O
targeting O
android O
smartphones O
. O

Invalid O
digital O
signature O
on O
malware O
samples O

This O
function O
is O
the O
entry O
point O
of O
the O
service O
. O

The O
startup O
routine O
of O
the O
Babar O
implant O
will O
create O
a O
registry O
key O
under O
' O
[ O
HKU O
] O
\..\CurrentVersion\Run O
' O
to O
assure O
persistence O
. O

The O
domain O
is O
resolved O
in O
the O
IP O
' O
191.101.31.250 B-ip.unknown
' O
which O
is O
located O
in O
Holland O
: O

In O
May O
2018 O
, O
we O
found O
a O
new O
sample O
( O
Detected O
as O
W2KM_DLOADR.UHAOEEN O
) O
that O
may O
be O
related O
to O
this O
campaign O
. O

* O

9 O

Below O
screen O
shots O
show O
the O
registry O
entry O
added O
by O
the O
malware O
. O

Fig O
9 O
. O

At O
the O
very O
bottom O
of O
the O
page O
, O
there O
are O
a O
couple O
of O
links O
to O
the O
poisoned O
installers O
: O
hxxp://www.true-crypt[.]com/download/TrueCrypt-Setup-7.1a.exe O
hxxp://true-crypt[.]com/files/TrueCrypt-7.2.exe O
Referrers O
include O
these O
localized O
software O
aggregates O
and O
sharers O
: O
gezginler[.]net/indir/truecrypt.html B-url.normal
tamindir[.]com/truecrypt/indir B-url.normal
It O
's O
interesting O
that O
Ksn O
recorded O
appearance O
of O
the O
the O
file O
on O
two O
unique O
systems O
in O
December O
2015 O
, O
a O
third O
in O
January O
2016 O
, O
all O
in O
Turkey O
, O
and O
then O
nothing O
until O
May O
2016 O
. O

Upon O
deobfuscating O
the O
payloads O
, O
we O
found O
32-bit O
DLLs O
built O
in O
part O
on O
the O
Destover B-malware.backdoor
malware O
( O
Intel O
Card O
) O
code O
. O

APT28 B-malware.infosteal
uses O
stolen O
credentials O
to O
access O
mailbox O
and O
read O
email O
. O

techto-earth[.]com B-url.cncsvr
domain O
now O
resolved O
to O
the O
IP O
address O
81.4.125.90 B-ip.unknown
, O
similarly O
belonging O
to O
the O
Dutch O
provider O
RouteLabel O
. O

Two O
of O
them O
appear O
to O
test O
the O
functionality O
of O
the O
device O
, O
one O
steals O
SMS O
message O
contents O
, O
and O
the O
remaining O
two O
report O
the O
location O
of O
the O
device O
and O
can O
exfiltrate O
various O
data O
. O

Follow O
us O

Hence O
, O
ramFS O
serves O
as O
a O
protected O
container O
for O
files O
to O
be O
executed O
on O
the O
machine O
, O
offering O
a O
disposable O
execution O
environment O
to O
the O
operators O
and O
leaving O
very O
few O
traces O
on O
the O
system O
. O

Figure O
5 O
: O
C O
& O
C O
Commands O
What O
is O
interesting O
is O
that O
each O
key O
in O
this O
configuration O
file O
represents O
a O
different O
module O
in O
the O
executable O
, O
and O
when O
the O
key O
is O
marked O
as O
true O
the O
executable O
will O
run O
the O
relevant O
module O
's O
content O
. O

Word O
document O
contained O
in O
EXE O
file O
FC17F3B2E2C7F5F24D35899D95B8C4A6 B-hash

The O
targeted O
group O
were O
members O
of O
the O
Syrian O
opposition O
in O
a O
private O
social O
media O
group O
. O

2.2.2 O
. O

This O
decodes O
to O
: O

Last O
Seen O

The O
same O
three O
sites O
targeted O
with O
the O
0-day O
used O
in O
the O
Forbes O
attack O
were O
also O
observed O
distributing O
malware O
via O
googlecaches[.]com B-url.unknown
- O
we O
therefore O
believe O
it O
's O
likely O
that O
the O
group O
we O
previously O
described O
as O
' O
Cluster O
1 O
' O
was O
behind O
the O
Forbes O
compromise O
. O

The O
malware O
calls O
ZwQuerySystemInformation O
to O
get O
ProcessInformation O
and O
ModuleInformation O
. O

The O
SWF O
stages O
log O
data O
to O
the O
URL O
identified O
as O
' O
stabUrl O
' O
, O
which O
is O
on O
the O
same O
command-and-control O
server O
. O

Blog O
français O
de O
Kaspersky O
Lab O
: O
http://blog.kaspersky.fr/ B-url.normal

It O
then O
appends O
a O
key O
and O
a O
DATA_TOKEN O
xor-ed O

We O
have O
found O
what O
may O
be O
an O
early O
data-gathering O
stage O
for O
future O
possible O
heists O
from O
financial O
organizations O
in O
Turkey O
( O
and O
possibly O
other O
countries O
) O
. O

Emails O
published O
by O
Kazaword O
and O
analyzed O
by O
Mediapart O
allege O
that O
Arcanum O
employed O
Bernard O
Squarcini O
, O
head O
of O
France O
's O
domestic O
intelligence O
agency O
, O
the O
Direction O
centrale O
du O
renseignement O
intérieur O
( O
DCRI O
) O
from O
2007 O
to O
2012 O
, O
to O
inform O
the O
Kazakh O
authorities O
of O
the O
progress O
of O
the O
legal O
proceedings O
against O
Ablyazov O
and O
to O
lobby O
certain O
figures O
in O
France O
. O

To O
achieve O
this O
it O
spawns O
a O
dedicated O
process O
with O
the O
command O
line O
' O
' O
regsvr32.exe O
' O
/s O
/n O
/i O
' O
% O
APPDATA O
% O
\ O
% O
DLLNAME O
% O
' O
' O
. O

We O
provide O
strategic O
consulting O
, O
threat O
intelligence O
, O
solutions O
and O
services O
– O
all O
in O
the O
cyber O
domain O
. O

Optionally O
the O
user O
can O
just O
hit O
' O
cancel O
' O
to O
use O
the O
currently O
logged O
on O
USER O
's O
authentication O
token O
. O

This O
request O
has O
the O
following O
HTTP O
body O
: O

Rifdoor는 B-malware.backdoor
PDB에 O
' O
E O
: O
\Data\My O
Projects\Troy O
Source O
Code\tcp1st\rifle\Release\rifle.pdb'라는 O
문자열을 O
포 O
함하고 O
있는 O
특징을 O
보인다 O
. O

Exactly O
64 O
bytes O
transmitted O
Detecting O
Derusbi B-malware.backdoor
server O
variants O
on O
disk O
is O
possible O
using O
the O
following O
YARA O
signature O
: O

However O
, O
the O
attackers O
that O
represent O
the O
threat O
will O
not O
be O
deterred O
, O
and O
variants O
of O
the O
attack O
are O
nearly O
assured O
. O

The O
victim O
is O
likely O
to O
uninstall O
the O
application O
at O
this O
point O
. O

16bXkdeQ15nXldeq O
16bXkdeQ15k= O
15TXldeT16LXldeq O

C1EC435E97A4A4C5585392D738B5879F B-hash
monagameel.chickenkiller.com B-url.cncsvr

또한 O
주기적인 O
로그 O
확인 O
을 O
통해 O
비정상적인 O
파일이 O
관리 O
서버를 O
통해 O
배포되지 O
않았는지 O
확인해야 O
한다 O
. O

Malicious O
URLs O
related O
to O
this O
malware O
are O
also O
blocked O
by O
FortiGuard O
Web O
Filtering O
Service O
. O

Operation O
BugDrop O
uses O
a O
free O
web O
hosting O
site O
to O
store O
the O
core O
malware O
module O
that O
gets O
downloaded O
to O
infected O
victims O
. O

Outside O
of O
the O
May O
WannaCry B-malware.ransom
attack O
, O
the O
majority O
of O
North O
Korean O
cryptocurrency O
operations O
have O
targeted O
South O
Korean O
users O
and O
exchanges O
, O
but O
we O
expect O
this O
trend O
to O
change O
in O
2018 O
. O

Below O
is O
a O
table O
that O
shows O
the O
mathematical O
logic O
in O
how O
the O
above O
is O
decoded O
into O
the O
actual O
C2 O
domain O
: O
Obfuscated O
String O
1st O
XOR O
Key O
Result O
2nd O
XOR O
Key O
C2 O
Hex O
C2 O
ASCII O
0x70 O
0x79 O
And O
this O
is O
the O
portion O
of O
the O
code O
responsible O
for O
this O
process O
: O
Figure O
11 O
- O
Assembly O
Code O
Instructions O
for O
the O
Double O
XOR O
Routine O
Next O
, O
the O
malware O
implant O
uses O
more O
than O
one O
layer O
to O
obfuscate O
its O
network O
Command O
and O
Control O
( O
C2 O
) O
communications O
. O

Figure O
5 O
depicts O
an O
HTTP O
GET O
request O
generated O
by O
the O
payload O
, O
with O
minimal O
HTTP O
headers O
. O

Hardcoded O
RSA256 O
key O
showing O
the O
first O
20 O
characters O

Little O
information O
is O
available O
at O
present O
about O
when O
or O
how O
the O
attackers O
compromised O
the O
bank O
, O
but O
it O
is O
likely O
more O
details O
will O
emerge O
in O
the O
coming O
weeks O
. O

Perhaps O
the O
most O
interesting O
of O
these O
, O
and O
the O
one O
we O
've O
chosen O
to O
key O
on O
from O
a O
detection O
perspective O
, O
is O
the O
following O
bit O
of O
assembly O
which O
was O
the O
final O
component O
in O
decoding O
a O
large O
encoded O
block O
of O
code O
: O
lea O
edx O
, O
[ O
esi+edi O
] O
mov O
edi O
, O
[ O
ebp+var_4 O
] O
mov O
cl O
, O
[ O
ecx+edx O
] O
xor O
cl O
, O
[ O
eax+edi O
] O
inc O
eax O
mov O
edi O
, O
[ O
ebp+arg_8 O
] O
mov O
[ O
edx O
] O
, O
cl O
mov O
ecx O
, O
[ O
ebp+arg_0 O
] O
cmp O
eax O
, O
ebx O
This O
snippet O
in O
the O
analyzed O
samples O
used O
a O
fixed O
size O
XOR O
key O
usually O
0x66 O
bytes O
long O
but O
would O
sequentially O
XOR O
every O
byte O
by O
each O
value O
of O
the O
key O
. O

The O
initial O
installers O
of O
this O
campaign O
were O
discovered O
due O
to O
behavior O
similarities O
with O
previous O
Hangover-related O
malware O
. O

Upon O
execution O
these O
files O
install O
a O
multi-featured O
trojan O
on O
the O
victim O
's O
computer O
. O

In O
this O
campaign O
, O
contact O
with O
targets O
was O
initiated O
through O
phishing O
e-mails O
, O
chat O
messages O
and O
Facebook O
posts O
. O

26 O
, O
2018 O
) O
used O
a O
macro-based O
document O
that O
dropped O
a O
VBS O
file O
and O
an O
INI O
file O
. O

The O
set O
of O
Trojans B-malware.backdoor
is O
powerful O
, O
with O
keyboard O
recording O
, O
voice O
recording O
, O
screen O
capture O
, O
file O
capture O
and O
U O
disk O
operation O
functions O
, O
etc O
. O

MD5 O
b3e1c2e40be54fbc0f7921ea8ce807e2 B-hash
SHA1 O
3f6436420e84ac96d9a3c93045c07cdadda8ec81 B-hash
SHA256 O
3712907740045871eef218fea7292c9c017e64cbb56b193b93f1a1b80afe599d B-hash
MD5 O
8eda7dfa4ec4ac975bb12d2a3186bbeb B-hash
SHA1 O
b5c49bbbf7499a30110adc94480b3edbc8d6e92b B-hash
SHA256 O
829e137279f691e493c211108b62c8e15b079bd619ba19ad388450878e0585d0 B-hash
It O
failed O
to O
execute O
with O
.NET O
4.0 O
on O
Windows O
XP O
. O

This O
third O
element O
is O
XOR O
ed O
against O
the O
current O
( O
k O

rastlsc.exe O
( O
SHA1 O
: O
2616da1697f7c764ee7fb558887a6a3279861fac B-hash
, O
copy O
of O
legitimate O
Symantec O
Network O
Access O
Control O
application O
, O
dot1xtra.exe O
) O

1st O
Portuguese­speaking O
group O
# O
ThePoseidonAPT B-malware.infosteal
attacks O
companies O
globally O
# O
TheSAS2016 O
Our O
research O
team O
was O
able O
to O
put O
together O
the O
disparate O
pieces O
of O
this O
puzzle O
by O
diligently O
tracing O
the O
evolution O
of O
Poseidon B-malware.infosteal
's O
toolkit O
in O
pursuit O
of O
an O
overarching O
understanding O
of O
how O
the O
actor O
thinks O
and O
the O
specific O
practices O
involved O
in O
infecting O
and O
extorting O
its O
victims O
. O

The O
following O
is O
a O
screenshot O
of O
the O
email O
: O
The O
' O
Invitation.jar B-malware.infosteal
' O
malware O
beaconed O
to O
' O
magnumbiz.no-ip[.]biz B-malware.infosteal
' O
over O
port O
' O
1505 O
' O
. O

Once O
matched O
, O
it O
will O
automatically O
replace O
it O
with O
the O
attacker O
's O
wallet O
address O
so O
the O
victim O
would O
unknowingly O
transfer O
money O
to O
the O
attacker O
's O
account O
: O

We O
'd O
previously O
missed O
the O
link O
between O
Cluster O
4 O
– O
and O
malware O
widely O
known O
as O
' O
EvilGrab B-malware.infosteal
' O
or O
' O
Vidgrab B-malware.backdoor
' O
. O

This O
includes O
following O
links O
sent O
in O
email O
. O

ZxShell B-malware.backdoor
employs O
a O
strange O
method O
for O
communication O
: O
it O
hooks O
the O
NtWriteFile O
API O
and O
recognizes O
5 O
different O
special O
handle O
values O
as O
commands O
: O
0x111111111 O
-- O
Hide O
' O
Loveusd O
' O
driver O
from O
the O
system O
kernel O
driver O
list O
0x22222222 O
-- O
Securely O
delete O
an O
in-use O
or O
no-access O
target O
file-name O
0x44444444 O
-- O
Unhook O
the O
ZwWriteFile O
API O
and O
hook O
KiFastCallEntry O
0x55555555 O
-- O
Remove O
the O
ZxShell B-malware.backdoor
Image O
Load O
Notify O
routine O
0x88888888 O
-- O
Set O
a O
special O
value O
called O
' O
type O
' O
in O
Windows O
registry O
key O
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverMain O
The O
second O
Loveusd O
system O
thread O
does O
a O
lot O
of O
things O
. O

The O
initial O
dropper O
is O
likely O
to O
be O
packed O
( O
UPX O
, O
etc O
) O
. O

The O
CONTEXT O
structure O
is O
shown O
in O
the O
following O
figure O
, O
and O
the O
offset O
of O
EIP O
and O
ESP O
in O
CONTEXT O
can O
be O
calculated O
. O

Failing O
this O
, O
the O
determines O
if O
the O
victim O
's O
machine O
is O
running O
the O
360 O
antivirus O
product O
by O
looking O
for O
a O
process O
with O
the O
name O
ZhuDongFangYu.exe O
. O

It O
is O
an O
attempt O
to O
trick O
any O
users O
who O
are O
using O
Protected O
Mode O
on O
their O
systems O
. O

APT B-malware.unknown
CAMPAIGN I-malware.unknown

Some O
attacks O
have O
focused O
on O
the O
sorts O
of O
targets O
that O
seem O
likely O
to O
be O
of O
interest O
to O
Russian O
intelligence O
services O
. O

Throughout O
the O
years O
, O
as O
evidenced O
in O
countless O
media O
reports O
, O
world O
superpowers O
have O
recognized O
and O
utilized O
the O
Internet O
as O
a O
powerful O
source O
for O
intelligence O
collection O
, O
and O
on O
occasion O
we O
have O
been O
offered O
glimpses O
as O
to O
how O
they O
are O
leveraging O
cyber O
espionage O
in O
support O
of O
their O
national O
diplomatic O
, O
military O
or O
economic O
objectives O
. O

Exploit O
Document O
MD5 O
: O

In O
our O
opinion O
, O
the O
answer O
would O
have O
to O
be O
' O
no O
' O
. O

We O
believe O
that O
this O
campaign O
targeted—at O
least O
in O
part—high-profile O
members O
of O
the O
Syrian O
opposition O
. O

Cyber O
espionage O
groups O
will O
continue O
targeting O
defense O
sectors O
and O
defense O
equipment O
manufacturers O
for O
the O
following O
reasons O
: O

The O
operation O
seeks O
to O
capture O
a O
range O
of O
sensitive O
information O
from O
its O
targets O
including O
audio O
recordings O
of O
conversations O
, O
screen O
shots O
, O
documents O
and O
passwords O
. O

When O
the O
user O
opens O
the O
document O
, O
text O
in O
Korean O
tells O
the O
victim O
to O
enable O
content O
to O
allow O
the O
document O
to O
be O
opened O
in O
their O
version O
of O
Word O
. O

We O
believe O
this O
exfiltration O
of O
files O
to O
be O
Dino B-malware.backdoor
's O
end O
goal O
. O

Scrambling O
Class O
Parser O
has O
several O
methods O
, O
one O
for O
each O
variable O
type O
– O
Parser O
: O
:inBytes O
, O
Parser O
: O
:inByte O
, O

Here O
is O
an O
overview O
of O
this O
activity O
: O
A O
public O
blog O
published O
by O
the O
Electronic O
Frontier O
Foundation O
indicated O
that O
journalists O
, O
activists O
, O
dissidents O
, O
and O
bloggers O
were O
targeted O
in O
2013 O
by O
malware O
and O
tactics O
consistent O
with O
APT32 B-malware.infosteal
operations O
. O

2016 O
. O

While O
examining O
the O
ATD O
website O
, O
Volexity B-malware.backdoor
also O
observed O
that O
the O
site O
had O
a O
password O
protected O
backdoor O
webshell O
placed O
on O
it O
. O

The O
DLL O
has O
the O
following O
properties O
: O
MD5 O
Hash O
: O
Compile O
Time O
: O
Export O
Function O
: O
The O
malware O
performs O
the O
following O
set O
of O
actions O
: O
Starts O
iexplore.exe O
( O
Internet O
Explorer O
) O
in O
a O
suspended O
state O
Injects O
NavShExt.dll O
into O
the O
iexplore.exe O
process O
and O
calls O
the O
DLL O
export O
Setting O
function O
The O
iexplore.exe O
process O
continues O
to O
run O
in O
the O
background O
Creates O
a O
mutex O
named O
donotbotherme O
( O
see O
Exhibit O
3 O
) O
to O
avoid O
having O
duplicated O
executions O
Creates O
a O
file O
named O
thumbcache_1CD60.db O
in O
AppData\Local\Microsoft\Windows\Explorer\ O
where O
the O
harvested O
data O
is O
stored O
Sends O
data O
to O
and O
downloads O
files O
and O
commands O
from O
the O
designated O
C2 O
server O
Harvests O
extensive O
system O
information O
from O
the O
machine O
, O
such O
as O
the O
following O
: O
LAN O
and O
WAN O
IP O
addresses O
( O
for O
the O
latter O
, O
it O
uses O
the O
free O
IP O
address O
service O
ipaddress.com O
) O
Installed O
software O
list O
Proxy O
information O
Process O
enumeration O
via O
tasklist O
List O
of O
all O
the O
files O
on O
the O
user O
's O
desktop O
: O
Mutex O
Creation O
Based O
on O
the O
currently O
available O
intelligence O
we O
also O
believe O
the O
malware O
is O
capable O
of O
providing O
the O
attacker O
with O
a O
remote O
shell O
on O
the O
host O
and O
can O
completely O
uninstall O
itself O
. O

6/10 O

Leverage O
initial O
compromise O
to O
access O
other O
systems O
and O
move O
deeper O
into O
the O
victim O
network O
. O

Romance O
in O
cyberespionage B-malware.backdoor

The O
DUBNIUM B-malware.drop
samples O
are O
distributed O
in O
various O
ways O
, O
one O
instance O
was O
using O
a O
zero-day O
exploit O
that O
targets O
Adobe O
Flash O
, O
in O
December O
2015 O
. O

For O
example O
, O
the O
submitted O
netui3.dll B-malware.backdoor
sample O
may O
not O
match O
the O
submitted O
netsat.exe B-malware.infosteal
sample O
in O
terms O
of O
versioning O
. O

Function O
PreProcess_sub_44C1C0 O
( O
) O

A O
host O
firewall O
will O
recognize O
the O
outgoing O
connection O
as O
originated O
by O
the O
browser O
instead O
of O
the O
ZxShell B-malware.backdoor
service O
host O
process O
. O

Grammatical O
mistakes O
indicate O
the O
attackers O
are O
not O
native O
to O
both O
languages O
: O
The O
post O
linked O
to O
a O
malicious O
website O
hosted O
in O
yolasite.com B-url.unknown
( O
which O
is O
a O
legitimate O
website O
building O
and O
hosting O
platform O
) O
: O
yolasite[.]com B-url.unknown
The O
button O
– O
' O
another O
website O
: O
ומחשב O
טלפון O
להורדה O
' O
( O
literal O
translation O
– O
' O
To O
download O
phone O
and O
computer O
' O
) O
linked O
to O
a O
zip O
file O
in O

Figure O
10 O
. O

cmd O
: O
Executes O
shell O
commands O

Written O
in O
Delphi O
, O
the O
code O
of O
XtremeRAT B-malware.backdoor
is O
shared O
amongst O
several O
other O
Delphi O
RAT O
projects O
including O
SpyNet O
, O
CyberGate O
, O
and O
Cerberus O
. O

Malware O
analysis O
by O
Morgan O
Marquis-Boire O
and O
Bill O
Marczak O
. O

The O
two O
files O
also O
have O
an O
identical O
compilation O
time O
, O
which O
suggests O
the O
backdoor O
is O
probably O
not O
recompiled O
very O
often O
and O
instead O
the O
attacker O
simply O
updates O
the O
callback O
configuration O
information O
. O

V0.9.6Y­SN1­ O
< O
hostname O
> O
­ O
< O
IP O
address O
> O
Aug O
28th O
2012 O
igfxtray.exe O
681a014e9d221c1003c54a2a9a1d9df8 B-hash
winsups.dll O
mqe45tex13fw14op0 O
http.4pu.com:80 B-url.cncsvr
V0.7­SN0­ O
< O
hostname O
> O
h O
; O
­ O
< O
IP O
address O
> O
Aug O
28th O
2012 O
6aac76fc8309e29ea8a7afea48ae9b29 B-hash
msdsp.dll O
654234576804d O
oracledata.ns01.us:80 B-url.cncsvr
V0.9.6X­SN1­ O
< O
hostname O
> O
­ O
< O
IP O
address O
> O
Aug O
12th O
2012 O
ctfmon.exe O
d5640ae049779bbb068eff08616adb95 B-hash
winsups.dll O
mqe45tex13fw14op0 O
mydns.dns2.us:443 B-url.cncsvr
V0.7­SN0­ O
< O
hostname O
> O
­ O
< O
IP O
address O
> O
Aug O
2nd O
2010 O
igfxtray.exe O
681a014e9d221c1003c54a2a9a1d9df8 B-hash
winsups.dll O
mqe45tex13fw14op0 O
http.4pu.com:80 B-url.cncsvr
V0.7­SN0­ O
< O
hostname O
> O
­ O
< O
IP O
address O
> O
Aug O
2nd O
2010 O
igfxpers.exe O

Posted O
on O
October O
9 O
, O
2014 O
by O
Steven O
Adair O
Over O
the O
last O
few O
months O
, O
Volexity B-malware.backdoor
has O
been O
tracking O
a O
particularly O
remarkable O
advanced O
persistent O
threat O
( O
APT B-malware.unknown
) O
operation O
involving O
strategic O
web O
compromises O
of O
websites O
in O
Hong O
Kong O
and O
Japan O
. O

Copying O
or O
further O
distribution O
beyond O
the O
original O
recipient O
may O
be O
unlawful O
. O

recID O
: O
11173­01­PRS O
WIDESTR O

Sofacy O
, O
also O
known O
as O
APT28 O
, O
Fancy O
Bear O
, O
and O
Tsar O
Team O
, O
is O
a O
highly O
active O
and O
prolific O
APT O
. O

The O
victim O
is O
then O
shown O
either O
a O
YouTube O
video O
featuring O
Sheikh O
Adnan O
al-Arour O
, O
or O
a O
story O
on O
http://www.alkalimaonline.com O
, O
a O
Lebanese O
news O
site O
. O

To O
our O
analysts O
, O
this O
was O
a O
rare O
opportunity O
. O

Hotwire O
pour O
Kaspersky O
Lab O

Figure O
13 O
. O

The O
ransomware O
then O
enumerates O
both O
local O
and O
network O
resources O
, O
and O
encrypts O
files O
using O
2,048-bit O
RSA O
algorithm O
. O

GetString O
( O
System O
. O

Example/Explanation O

A O
handful O
of O
visits O
to O
a O
specific O
url O
on O
the O
server O
from O
five O
systems O
based O
in O
the O
following O
locations O
were O
recorded O
on O
the O
8th O
and O
9th O
. O

Aurora B-malware.infosteal
coverage O
in O
McAfee O
point O
products O
: O
Exploit-Comele O
Trojan O

We O
see O
that O
there O
are O
two O
locations O
where O
DecryptCommandBuffer_sub_44C628 O
( O
) O
is O
called O
, O
and O
one O
of O
those O
locations O
, O
EncryptData_sub_49D9EC O
( O
) O
, O
has O
a O
hard-coded O
string O
with O
an O
uncanny O
resemblance O
to O
a O
decryption O
key O
: O

Fidelis O
researchers O
surmised O
there O
might O
be O
a O
means O
of O
recovering O
file O
data O
from O
targeted O
systems O
from O
a O
forensic O
and O
investigative O
analysis O
point O
of O
view O
. O

According O
to O
our O
analysis O
, O
jmidebs.sys O
is O
the O
connecting O
link O
between O
mrxcls.sys O
and O
the O
drivers O
later O
used O
in O
Duqu B-malware.infosteal
. O

Their O
malware O
's O
resemblance O
to O
that O
of O
Patchwork O
's O
is O
also O
notable O
. O

Detailed O
behaviour O
observed O
in O
each O
phase O
will O
be O
explained O
in O
the O
next O
section O
. O

The O
flyer O
also O
reveals O
the O
price O
of O
the O
malware O
: O
The O
basic O
binary O
costs O
$ O
320 O
and O
each O
plugin O
must O
be O
paid O
for O
separately O
, O
for O
example O
$ O
50 O
for O
the O
file O
stealer O
, O
$ O
60 O
for O
the O
ad-clicker O
and O
up O
to O
$ O
350 O
for O
a O
configurable O
form O
grabber O
. O

Russia O
accounted O
for O
the O
largest O
number O
of O
attacks O
between O
2015 O
and O
2017 O
, O
followed O
by O
Ukraine O
, O
Moldova O
, O
Belgium O
, O
Iran O
, O
and O
France O
. O

Morgan O
Marquis-Boire O
is O
a O
Technical O
Advisor O
at O
the O
Citizen O
Lab O
, O
Munk O
School O
of O
Global O
Affairs O
, O
University O
of O
Toronto O
. O

The O
HTTP O
File O
Server O

Packet O
capture O
on O
port O
1321/tcp O
: O

Thu O
Jun O
14 O
2012 O
12:55:12 O
285691 O
mac O
. O

Malware O
sandboxes O
are O
automated O
dynamic O
analysis O
systems O
that O
execute O
programs O
in O
a O
controlled O
environment O
. O

www[.]nasnnones[.]com O
trems[.]rvenee[.]com O
contacts[.]rvenee[.]com O
91[.]207[.]7[.]91 O
89[.]18[.]27[.]159 O
89[.]37[.]226[.]108 O
185[.]25[.]51[.]116 O
185[.]81[.]113[.]95 O
185[.]144[.]83[.]82 O
185[.]153[.]198[.]58 O
185[.]159[.]129[.]226 O

Evidence O
suggests O
that O
these O
groups O
include O
those O
behind O
the O
recent O
Forbes O
and O
Anthem O
attacks O
. O

It O
should O
be O
noticed O
that O
ramFS O
is O
also O
present O
in O
other O
Animal O
Farm O
binaries O
( O
see O
attribution O
paragraph O
below O
) O
, O
but O
since O
we O
are O
unaware O
of O
previous O
analysis O
of O
ramFS O
, O
we O
are O
describing O
our O
findings O
here O
. O

The O
malware O
is O
also O
very O
sneaky O
and O
sensitive O
to O
dynamic O
analysis O
. O

system O
( O
' O
mkdir O
-p O
/Users/Shared/.local/ O
& O
> O
/dev/null O
' O
) O
; O
system O
( O
' O
mkdir O
-p O
~/Library/LaunchAgents/ O
& O
> O
/dev/null O
' O
) O
; O
off_10001B4F0 O
( O
v5 O
, O
& O
off_10001B4F0 O
, O
CFSTR O
( O
' O
/Users/Shared/.local/kextd O
' O
) O
, O
1LL O
) O
; O
off_10001B4F0 O
( O
v6 O
, O
& O
off_10001B4F0 O
, O
CFSTR O
( O
' O
/Users/Shared/com.apple.updates.plist O
' O
) O
, O
1LL O
) O
; O
off_10001B4F0 O
( O
v7 O
, O
& O
off_10001B4F0 O
, O
CFSTR O
( O
' O
/Users/Shared/start.sh O
' O
) O
, O
1LL O
) O
; O
system O
( O
' O
cp O
/Users/Shared/com.apple.updates.plist O
$ O
HOME/Library/LaunchAgents/ O
& O
> O
/dev/null O
' O
) O
; O
remove O
( O
' O
/Users/Shared/com.apple.updates.plist O
' O
) O
; O
system O
( O
' O
chmod O
755 O
/Users/Shared/.local/kextd O
' O
) O
; O
system O
( O
' O
chmod O
755 O
/Users/Shared/start.sh O
' O
) O
; O

[ O
그림 O
11 O
] O
Ghostrat의 B-malware.backdoor
특징적인 O
문자열 O
[ O
그림 O
12 O
] O
는 O
안다리엘 O
그룹이 O
한글화하여 O
사용한 O
중국 O
공격 O
도구들이다 O
. O

return O
re O
sult O
; O
23 O
} O
! O

# O
getdrivelist O
? O

WhiteBear O
code O
and O
strings O

All O
rights O
reserved O
. O

RATANKBA B-malware.backdoor
is O
delivered O
to O
its O
victims O
using O
a O
variety O
of O
lure O
documents O
, O
including O
Microsoft O
Office O
documents O
, O
malicious O
CHM O
files O
, O
and O
different O
script O
downloaders O
. O

1B7D8D3BBF14C6B619480C265C2F4664F9DCB878EA7DFC6F2637 O

A O
zero-day O
vulnerability O
is O
a O
vulnerability O
for O
which O
there O
exists O
no O
patch O
, O
whereas O
an O
' O
N-Day B-malware.unknown
' O
vulnerability O
is O
an O
attack O
that O
takes O
place O
' O
N O
' O
days O
after O
the O
patch O
is O
available O
. O

The O
document O
opens O
and O
appears O
as O
such O
: O

During O
our O
investigation O
we O
found O
that O
the O
majority O
of O
XtremeRAT B-malware.backdoor
activity O
is O
associated O
with O
spam O
campaigns O
that O
typically O
distribute O
Zeus B-malware.infosteal
variants I-malware.infosteal
and O
other O
banking-focused O
malware O
. O

These O
exploits O
are O
at O
the O
core O
payload O
of O
any O
advanced O
malware O
, O
and O
are O
virtually O
unstoppable O
until O
vendors O
release O
a O
patch O
or O
anti-virus O
providers O
come O
up O
with O
a O
signature O
definition O
. O

Filename O
: O
main.dll O

These O
include O
Trend O
Micro O
endpoint O
solutions O
such O
as O
Trend O
MicroTM O
Smart O
Protection O
Suites O
and O
Worry-FreeTM O
Business O
Security O
, O
which O
can O
protect O
users O
and O
businesses O
from O
these O
threats O
by O
detecting O
malicious O
files O
, O
well O
as O
blocking O
all O
related O
malicious O
URLs O
. O

Interesting O
again O
, O
same O
as O
during O
infection O
, O
the O
regsvr32.exe O
process O
remains O
running O
even O
after O
Babar B-malware.drop
is O
readily O
set O
up O
. O

Graphic O
used O
by O
the O
malicious O
document O

The O
downloader O
may O
contain O
an O
encoded O
executable O
file O
of O
Process O
Hacker O
( O
a O
multi-function O
task O
manager O
) O
, O
and O
it O
may O
execute O
the O
Process O
Hacker O
if O
an O
anti-virus O
software O
is O
detected O
. O

Determined O
the O
system O
architecture O
to O
select O
the O
correct O
path O
for O
PowerShell O
2 O
. O

OceanLotus O
continues O
its O
activity O
particularly O
targeting O
company O
and O
government O
networks O
in O
East-Asian O
countries O
. O

darkcomet.py B-malware.backdoor
Crypto O
Module O

For O
example O
, O
the O
string O
at O
the O
relative O
virtual O
address O
( O
RVA O
) O
0x10001630 O
is O
loaded O
and O
then O
XOR O
'd O
with O
key O
0x0d O
to O
reveal O
the O
following O
User-agent O
string O
in O
Unicode O
format O
: O
Similar O
activity O
also O
occurs O
at O
RVA O
0x10000179F O
where O
the O
string O
is O
XOR O
'd O
with O
key O
0x14 O
to O
reveal O
the O
following O
static O
string O
observed O
in O
the O
beacon O
to O
the O
C2 O
: O
1a53b0cp32e46g0qio9 O
The O
code O
for O
that O
procedure O
is O
below O
: O
While O
this O
string O
stacking O
technique O
is O
very O
common O
within O
shellcode O
, O
it O
is O
less O
frequently O
used O
with O
Unicode O
strings O
because O
Unicode O
strings O
are O
two O
bytes O
in O
length O
for O
every O
character O
, O
as O
compared O
to O
one-byte O
length O
for O
ASCII O
characters O
. O

This O
time O
, O
a O
loop O
is O
implemented O
with O
a O
call O
to O
sleep O
for O
a O
short O
time O
. O

Our O
findings O
highlight O
the O
increasing O
dissonance O
between O
Gamma O
's O
public O
claims O
that O
FinSpy B-malware.backdoor
is O
used O
exclusively O
to O
track O
' O
bad O
guys O
' O
and O
the O
growing O
body O
of O
evidence O
suggesting O
that O
the O
tool O
has O
and O
continues O
to O
be O
used O
against O
opposition O
groups O
and O
human O
rights O
activists O
. O

Additionally O
, O
the O
domains O
adobeair.net B-url.unknown
and O
bikefanclub.info B-url.unknown
both O
resided O
on O
50.63.202.94 B-ip.unknown
from O
2014-04-24 O
to O
2014-04-25 O
. O

These O
belong O
to O
various O
DynDNS O
services O
, O
and O
at O
the O
time O
of O
writing O
resolve O
to O
IP O
addresses O
located O
with O
hosting O
services O
in O
the O
US O
. O

The O
threat O
actors O
are O
not O
likely O
native O
English O
speakers O
since O
multiple O
typos O
were O
found O
in O
their O
payloads O
. O

573ef0b7ff1dab2c3f785ee46c51a54f B-hash
SHA-1 O
d58d4f6ad3235610bafba677b762f3872b0f67cb B-hash
SHA-256 O
363172a2f2b228c7b00b614178e4ffa00a3a124200ceef4e6d7edb25a4696345 B-hash

The O
implementation O
is O
not O
exactly O
the O
same O
nor O
is O
the O
log O
of O
media O
infection O
; O
Version O
1.5 O
creates O
a O
new O
event O
: O
' O
wowmgr_is_load O
' O
. O

This O
could O
allow O
an O
attacker O
to O
alter O
a O
controlled O
process O
unbeknownst O
to O
process O
operators O
. O

Malware O
also O
supports O
second O
type O
of O
download O
functionality O
, O
instead O
of O
extracting O
the O
URL O
from O
the O
C2 O
response O
and O
downloading O
the O
executable O
, O
it O
gets O
executable O
content O
from O
the O
networks O
stream O
from O
a O
hard O
coded O
IP O
address O
and O
then O
writes O
it O
to O
the O
disk O
and O
executes O
it O
. O

Summary O
of O
the O
changes O
between O
each O
version O
of O
ANEL B-malware.backdoor

% O
localappdata%\Temp\chrome.crx O

Yet O
I O
recently O
uncovered O
evidence O
that O
suggests O
it O
was O
the O
work O
of O
a O
well-known O
Chinese O
threat O
group O
. O

The O
main O
downloader O
is O
extracted O
from O
the O
decoy O
document O
via O
a O
malicious O
VB O
script O
that O
runs O
it O
from O
the O
temp O
folder O
. O

77.69.181.162 B-ip.unknown
Batelco O
ADSL O
Service O
Australia O
Bahrain O
180.211.xxx.xxx B-ip.unknown
Telegraph O
& O
Telephone O
Board O
Bangladesh O
168.144.xxx.xxx B-ip.unknown
Softcom O
, O
Inc O
. O

CTU O
researchers O
identified O
the O
owners O
of O
three O
of O
these O
accounts O
; O
two O
belonged O
to O
the O
DNC O
's O
secretary O
emeritus O
, O
and O
one O
belonged O
to O
the O
communications O
director O
. O

AV O
detection O

The O
latter O
was O
redirecting O
to O
journey-in-israel[.]com O
and O
iec-co-il[.]com O
in O
May O
and O
July O
2016 O
, O
according O
to O
PassiveTotal O
: O
Sample O
24befa319fd96dea587f82eb945f5d2a B-hash
, O
potentially O
only O
a O
test O
file O
, O
is O
a O
self-extracting O
archive O
( O
SFX O
) O
that O
contains O
two O
files O
: O
a O
legitimate O
Putty O
installation O
and O
link.html O
: O

Operation B-malware.backdoor
Erebus I-malware.backdoor
leverages O
another O
Flash O
Player O
exploit O
( O
CVE-2016-4117 O
) O
through O
the O
use O
of O
watering B-malware.backdoor
hole I-malware.backdoor
attacks O
. O

In O
addition O
to O
installing O
the O
legitimate O
version O
of O
WinRAR O
, O
the O
dropper O
installed O
the O
following O
StrongPity O
components O
: O
% O
temp%\procexp.exe O
% O
temp O
% O
\sega\ O
nvvscv.exe O
prst.cab O
prst.dll O
wndplyr.exe O
wrlck.cab O
wrlck.dll O
Of O
these O
files O
, O
two O
are O
configurable O
and O
encrypted O
with O
the O
same O
keyless O
cipher O
, O
' O
wrlck.cab O
' O
and O
' O
prst.cab O
' O
. O

The O
table O
below O
lists O
its O
possible O
commands O
: O

Instead O
of O
showing O
information O
interesting O
for O
an O
Israeli O
audience O
, O
the O
video O
contains O
a O
music O
piece O
critical O
of O
Mahmoud O
Abbas O
, O
claiming O
that O
he O
is O
not O
working O
for O
the O
good O
of O
the O
Palestinian O
people O
. O

Furthermore O
, O
this O
domain O
is O
not O
a O
publicly O
available O
dynamic O
DNS O
provider O
and O
the O
email O
address O
used O
to O
register O
this O
domain O
is O
. O

The O
port O
number O
is O
sent O
to O
the O
driver O
( O
via O
IOCTL O
0x220200 O
) O
in O
order O
to O
inform O
the O
driver O
where O
to O
redirect O
incoming O
traffic O
. O

The O
spoofed O
source O
of O
this O
email O
suggests O
the O
message O
is O
legitimate O
and O
increases O
the O
chances O
that O
victims O
will O
treat O
it O
as O
such O
. O

Cisco O
analyzes O
a O
massive O
amount O
of O
telemetry O
data O
and O
is O
able O
to O
 ag O
malware O
as O
malicious O
based O
on O
multiple O
factors O
. O

South O
Korea O
is O
more O
at O
risk O
now O
than O
before O
the O
attack O
, O
as O
now O
adversaries O
less O
capable O
than O
advanced O
persistent O
threats O
realize O
they O
could O
also O
successfully O
perform O
damaging O
attacks O
. O

The O
copy O
of O
Freegate B-malware.infosteal
launched O
is O
listed O
as O
' O
Freegate B-malware.infosteal
7.35 O
Professional O
Edition O
. O
' O

Additional O
reverse O
engineering O
and O
analysis O
is O
on-­‐going O
at O
this O
time O
. O

We O
do O
not O
believe O
either O
Moafee B-malware.infosteal
or O
DragonOK B-malware.infosteal
have O
controlled O
the O
domain O
' O
ct.datangcun[.] O

HKCR\mscfile\shell\open\command O
. O

The O
dwPktType O
field O
correlates O
to O
the O
module O
ID O
which O
allows O
the O
server O
variant O
to O
route O
the O
datagram O
to O
the O
appropriate O
module O
without O
further O
inspection O
of O
the O
payload O
data O
. O

**Nobody O
paid O
so O
they O
decreased O
ransom O
to O
0.05 O
BTC O

NALYSIS O
ON O
MODULE O
3 O
............................................................................................................................................. O
6 O

The O
backdoors O
were O
also O
similarly O
signed O
using O
the O
same O
stolen O
code-signing O
certificate O
from O
' O
HT O
Srl O
. O
' O

Even O
after O
it O
has O
reportedly O
stolen O
hundreds O
of O
millions O
of O
dollars O
, O
the O
infamous O
Carbanak B-malware.infosteal
APT O
group O
is O
n't O
resting O
on O
its O
laurels O
. O

Exploit O
: O

There O
was O
overlap O
between O
this O
large O
cluster O
and O
the O
second O
largest O
one O
which O
used O
the O
password O
' O
123456 O
' O
( O
12 O
samples O
) O
. O

Figure O
1 O
is O
a O
screenshot O
of O
a O
packet O
capture O
showing O
one O
of O
the O
RTF O
files O
reaching O
out O
to O
hxxp://tk-in-f156.2bunny[.]com/Agreement.doc B-url.unknown
. O

Obfuscated O
control O
servers O
. O

This O
is O
normally O
located O
in O
the O
folder O
. O

We O
've O
seen O
file O
exfiltration O
, O
remote O
command O
execution O
capability O
and O
anti-vm O
techniques O
added O
throughout O
the O
life O
of O
GravityRAT B-malware.drop
. O

The O
fi O
rst O
stage O
payload O
– O
' O
UP O
' O

The O
latest O
CozyDuke B-malware.drop
main O
component O
we O
observed O
was O
compiled O
on O
the O
26 O
of O
February O
, O
2015 O
. O

Earlier O
attempts O
used O
EXE O
's O
disguised O
with O
Microsoft O
Word O
document O
icons O
and O
DOCX O
files O
within O
a O
similarly O
named O
ZIP O
file O
as O
documented O
by O
JPCERT O
. O

.SYSTEM\CurrentControlSet\Services\360rp O

Also O
, O
Trojan.PonyDOS B-malware.unknown
does O
not O
go O
to O
the O
trouble O
of O
converting O
its O
encrypted O
data O
payloads O
into O
ASCII O
representations O
as O
DarkComet B-malware.backdoor
does O
. O

Figure O
4 O

When O
the O
victim O
opens O
the O
excel O
file O
and O
enables O
the O
macro O
content O
, O
The O
malicious O
macro O
code O
within O
the O
excel O
file O
is O
executed O
. O

In O
tweets O
to O
international O
journalists O
and O
Twitter O
accounts O
that O
disseminate O
hacktivist O
and O
information O
security O
news O
, O
' O
Fancy O
Bears O
' O
Hack O
Team O
' O
claims O
to O
have O
' O
proof O
of O
American O
athletes O
taking O
doping O
. O
' O

It O
is O
not O
a O
secret O
that O
anti-malware O
systems O
trigger O
on O
special O
system O
functions O
that O
are O
called O
in O
the O
context O
of O
potential O
vulnerable O
applications O
to O
make O
a O
deeper O
analysis O
of O
API O
calls O
such O
as O
CreateProcess O
, O
WinExec O
or O
ShellExecute O
. O

Long-term O
access O
to O
email O
accounts O
of O
senior O
campaign O
advisors O
, O
who O
may O
be O
appointed O
to O
staff O
positions O
in O
a O
Clinton O
administration O
, O
could O
provide O
TG-4127 B-malware.infosteal
and O
the O
Russian O
government O
with O
access O
to O
those O
individual O
's O
accounts O
. O

By O
late O
December O
2014 O
, O
the O
total O
number O
of O
Russian O
forces O
in O
the O
region O
was O
approximately O
10,000 O
troops O
. O

[ O
그림 O
5 O
] O
다운로드된 O
파일 O
( O
위 O
) O
과 O
5바이트 O
복구된 O
파일 O
( O
아래 O
) O
일정 O
규모 O
이상의 O
기관 O
및 O
기업에서는 O
대부분 O
PC O
등 O
조직 O
내 O
다수의 O
시스템을 O
중앙관리 O
솔루션에 O
연결하 O
여 O
관리한다 O
. O

The O
code O
was O
largely O
trivial O
to O
reverse O
engineer O
, O
which O
meant O
static O
analysis O
was O
an O
easy O
option O
for O
this O
piece O
of O
malware O
. O

The O
above O
PowerShell O
command O
downloads O
a O
file O
from O
the O
specified O
URL O
, O
and O
it O
is O
saved O
as O
a O
batch O
file O
to O
be O
executed O
. O

Even O
though O
the O
MD5s O
are O
useful O
, O
this O
is O
a O
text-based O
payload O
that O
can O
be O
easily O
changed O
, O
resulting O
in O
a O
new O
MD5 O
hash O
. O

theme0.xml O
is O
a O
Mach-O O
32-bit O
executable O
with O
a O
0xFEEDFACE O
signature O
that O
is O
also O
the O
dropper O
of O
the O
backdoor O
, O
which O
is O
the O
final O
payload O
. O

At O
points O
E. O
and O
F. O
you O
can O
see O
the O
malware O
checking O
in O
with O
the O
command O
and O
control O
server O
. O

These O
three O
files O
work O
together O
using O
a O
common O
technique O
call O
DLL O
Side-Loading O
or O
DLL O
Hijacking B-ip.unknown
. O

Before O
that O
date O
, O
the O
IP O
was O
200.63.46.33 O

? O
1 O
? O
0 O
8d O
44 O
24 O
? O
c O
66 O
8b O
10 O
66 O
3b O
11 O
75 O
1e O
66 O
85 O
d2 O
74 O
15 O
66 O
8b O
50 O
02 O
66 O
3b O
51 O
02 O
75 O
0f O
83 O
c0 O
04 O
83 O
c1 O
04 O
66 O
85 O
d2 O
75 O
de O
33 O
c0 O
eb O
05 O
1b O
c0 O
83 O
d8 O
ff O
85 O
c0 O
0f O
84 O
? O
? O

Compared O
to O
incidents O
like O
Uroburos B-malware.backdoor
, O
the O
Kraken B-malware.ransom
malware O
is O
not O
good O
enough O
to O
' O
catch O
the O
big O
fish O
' O
if O
we O
want O
to O
stick O
with O
to O
the O
metaphor O
. O

iconfig.exe O
bbs.winupdate[.]net B-url.cncsvr
| O
Port O
8080 O
Dynamic O

However O
, O
there O
may O
be O
some O
other O
versions O
with O
different O
functions O
. O

lstrcmpA O
( O
& O
> O
command O
, O
' O
pwd O
' O
) O
) O

The O
table O
also O
includes O
the O
md5sum O
of O
the O
malware O
payloads O
. O

For O
Telegram O
: O

Someone O
using O
the O
language O
code O
as O
a O
false O
flag O
would O
have O
likely O
kept O
the O
strategy O
going O
. O

Interestingly O
, O
the O
Babar B-malware.drop
dropper O
as O
well O
as O
the O
implant O
show O
a O
similar O
method O
of O
API O
name O
obfuscation O
as O
the O
Bunny B-malware.unknown
malware O
and O
samples O
from O
the O
NBOT B-malware.unknown
family O
. O

Some O
targets O
are O
spearphished O
repeatedly O
with O
much O
the O
same O
social-engineering O
schemes O
. O

0x406EA8 O
: O
FF150C10AF01 O
CALL O
DWORD O
PTR O
[ O
0x1AF100C O
] O

Out O
of O
scope O
for O
prior O
versions O
. O

domain O
domain O
domain O
domain O
sender O
sender O
sender O

Interestingly O
, O
the O
configuration O
file O
also O
specifies O
a O
Vietnamese O
phone O
number O
used O
for O
SMS O
based O
command O
and O
control O
: O
Section O
Type O
: O
TlvTypeConfigSMSPhoneNumber O
Section O
Data O
: O
' O
+841257725403 O
' O
The O
command O
and O
control O
server O
is O
in O
a O
range O
provided O
by O
the O
CMC O
Telecom O
Infrastructure O
Company O
in O
Hanoi O
: O
IP O
Address O
: O
183.91.2.199 O
inetnum O
: O
183.91.0.0 O
– O
183.91.9.255 O
netname O
: O
FTTX-NET O
country O
: O
Vietnam O
address O
: O
CMC O
Telecom O
Infrastructure O
Company O
address O
: O
Tang O
3 O
, O
16 O
Lieu O
Giai O
str O
, O
Ba O
Dinh O
, O
Ha O
Noi O
This O
server O
was O
active O
until O
very O
recently O
and O
matched O
our O
signatures O
for O
a O
FinSpy B-malware.backdoor
command O
and O
control O
server O
. O

Obfuscating O
code O
and O
signaling O
to O
the O
C2 O
that O
the O
file O
has O
been O
executed O
Launching O
the O
loader O
and O
using O
it O
to O
execute O
functions O
. O

In O
this O
scenario O
, O
accevent.exe O
is O
the O
primary O
executable O
, O
which O
is O
usually O
legitimate O
. O

One O
is O
a O
malicious O
installer O
of O
the O
circumvention O
tool O
Freegate B-malware.infosteal
. O

The O
timing O
is O
interesting O
because O
the O
NCTC O
was O
in O
the O
process O
of O
conducting O
physical O
antiterror O
drills O
in O
the O
region O
in O
preparation O
for O
the O
Olympic O
Games O
. O

Once O
it O
is O
decrypted O
, O
we O
are O
able O
to O
extract O
the O
plaintext O
configuration O
information O
including O
the O
domain O
of O
the O
command O
and O
control O
server O
and O
port O
number O
( O
Fig O
8 O
) O
. O

Trend O
Micro O
OfficeScan O
Antivirus O
real-time O
scan O
monitor O
Trend O
Micro O
OfficeScan O
NT O
Listener O
Trend O
Micro O
OfficeScan O
NT O
Firewall O
Next O
, O
the O
process O
attempts O
to O
find O
an O
embedded O
' O
IMAGE O
' O
resource O
with O
offset O
# O
110 O
. O

In O
most O
cases O
, O
they O
logged O
on O
to O
the O
server O
at O
roughly O
the O
same O
time O
of O
day O
, O
probably O
in O
the O
morning O
hours O
: O

In O
2015 O
we O
noticed O
another O
wave O
of O
attacks O
which O
took O
advantage O
of O
a O
new O
release O
of O
the O
AZZY B-malware.backdoor
implant O
, O
largely O
undetected O
by O
antivirus O
products O
. O

Upon O
execution O
malware O
makes O
a O
connection O
to O
the O
c2 O
server O
on O
port O
5555 O
and O
sends O
the O
system O
& O
operating O
system O
information O
along O
with O
some O
base64 O
encoded O
strings O
to O
the O
attacker O
as O
shown O
below O
. O

In O
this O
way O
, O
individual O
threat O
actors O
can O
be O
tracked O
with O
Digital O
DNATM O
. O

zxMain O
is O
obtained O
with O
GetProcAddress O
. O

The O

Where O
the O
site O
was O
referenced O
via O
phishing O
as O
opposed O
to O
' O
Watering O
Hole O
' O
based O
activity O
, O
it O
has O
been O
excluded O
from O
the O
following O
table O
. O

Therefore O
, O
the O
array O
can O
be O
read O
and O
written O
at O
any O
address O
. O

- O
exact O
functionality O
unknown O
appears O
to O
force O
another O
request O
to O
the O
C2 O
page O
check.asp O

We O
have O
the O
impression O
that O
a O
cybersurveillance O
operation O
is O
underway O
( O
and O
is O
probably O
still O
ongoing O
- O
most O
recent O
sample O
created O
Oct O
. O

Since O
the O
RAT B-malware.backdoor
library O
was O
built O
to O
run O
from O
the O
memory O
of O
a O
host O
process O
, O
it O
relies O
on O
the O
loader O
to O
survive O
system O
restart O
. O

As O
previously O
noted O
, O
root9B O
is O
in O
the O
process O
of O
further O
documenting O
and O
reporting O
probable O
fictitious O
personas O
to O
the O
authorities O
. O

Both O
the O
command O
& O
control O
server O
IP O
and O
the O
phone O
number O
used O
for O
text-message O
exfiltration O
are O
in O
Vietnam O
which O
indicates O
a O
domestic O
campaign O
. O

Figure O
4 O
. O

Aug O
27th O
2012 O

Taking O
into O
account O
the O
profiles O
of O
the O
targeted O
organizations O
-- O
South O
Korean O
universities O
that O
conduct O
researches O
on O
international O
affairs O
, O
produce O
defense O
policies O
for O
government O
, O
national O
shipping O
company O
, O
supporting O
groups O
for O
Korean O
unification O
-- O
one O
might O
easily O
suspect O
that O
the O
attackers O
might O
be O
from O
North O
Korea O
. O

However O
, O
the O
constant O
addition O
and O
changing O
of O
features O
and O
attack O
vectors O
indicate O
that O
the O
attackers O
behind O
the O
campaign O
are O
unlikely O
to O
stop O
and O
are O
constantly O
looking O
to O
evolve O
their O
tools O
and O
tactics O
. O

With O
a O
group O
like O
Sofacy O
, O
once O
their O
attention O
is O
detected O
on O
a O
network O
, O
it O
is O
important O
to O
review O
logins O
and O
unusual O
administrator O
access O
on O
systems O
, O
thoroughly O
scan O
and O
sandbox O
incoming O
attachments O
, O
and O
maintain O
two O
factor O
authentication O
for O
services O
like O
email O
and O
vpn O
access O
. O

NextSendReceive O
: O
5CC33097FB72D001 O
BYTES O
000064F7­72E4­3F7D­C817­474D­A9BDBDF7 O
STR O

Again O
, O
this O
behavior O
and O
characteristics O
of O
the O
malware O
is O
very O
similar O
to O
JSocket B-malware.backdoor
and O
AlienSpy B-malware.backdoor
Android O
RATs O
. O

It O
re-copies O
the O
DLL O
from O
the O
new O
buffer O
to O
the O
original O
one O
using O
the O
memcpy O
function O
. O

